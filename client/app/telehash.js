!function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);throw new Error("Cannot find module '"+g+"'")}var j=c[g]={exports:{}};b[g][0].call(j.exports,function(a){var c=b[g][1][a];return e(c?c:a)},j,j.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a){"use strict";angular.module("dtmsgApp").factory("Telehash",function(){return a("telehash")})},{telehash:2}],2:[function(a,b,c){var d=a("telehash-js");c.debug=d.debug,c.info=d.info,c.init=function(b,c){function e(){return a("telehash-seeds").install(f,b),f.online(function(a){c(a,f)}),f}b||(b={});var f=new d.switch;if(a("telehash-cs1a").install(f,b),b.cs2a&&a("telehash-cs2a").install(f,b),a("telehash-http").install(f,b),a("telehash-webrtc").install(f,b),a("telehash-stream").install(f,b),a("telehash-telesocket").install(f,b),a("telehash-thtp").install(f,b),a("telehash-token").install(f,b),b.id&&("string"==typeof b.id&&localStorage&&localStorage.getItem(b.id)&&(b.id=JSON.parse(localStorage.getItem(b.id))),"object"==typeof b.id)){var g;return(g=f.load(b.id))?c("error loading id, "+g+": "+JSON.stringify(b.id)):e()}return f.make(function(a,d){return a?c("error creating id, "+a):("string"==typeof b.id&&localStorage&&localStorage.setItem(b.id,JSON.stringify(d)),b.id=d,f.load(d),e())}),f}},{"telehash-cs1a":3,"telehash-cs2a":10,"telehash-http":18,"telehash-js":20,"telehash-seeds":21,"telehash-stream":23,"telehash-telesocket":24,"telehash-thtp":25,"telehash-token":26,"telehash-webrtc":27}],3:[function(a,b,c){(function(b){var d=(a("crypto"),a("./cs1a.js")),e=a("ecc-jsbn");a("./forge.min.js"),d.crypt(e,function(a,c,d,e){var f=a?forge.aes.createEncryptionCipher(c.toString("binary"),"CTR"):forge.aes.createDecryptionCipher(c.toString("binary"),"CTR");return f.start(d.toString("binary")),f.update(forge.util.createBuffer(e.toString("binary"))),f.finish(),new b(f.output.getBytes(),"binary")}),Object.keys(d).forEach(function(a){c[a]=d[a]})}).call(this,a("buffer").Buffer)},{"./cs1a.js":4,"./forge.min.js":5,buffer:29,crypto:35,"ecc-jsbn":6}],4:[function(a,b,c){(function(b){function d(a,b){if(!a||b.length%2)return b;var c=b.slice(0,b.length/2);for(i=0;i<c.length;i++)c[i]=c[i]^b[i+c.length];return d(a-1,c)}var e,f=a("crypto");c.install=function(a){e=a,a.CSets["1a"]=c},c.crypt=function(a,b){f.ecc=a,f.aes=b},c.genkey=function(a,b){var c=new f.ecc.ECKey(f.ecc.ECCurves.secp160r1);a["1a"]=c.PublicKey.slice(1).toString("base64"),a["1a_secret"]=c.PrivateKey.toString("base64"),b()},c.loadkey=function(a,c,d){if("string"==typeof c&&(c=new b(c,"base64")),!b.isBuffer(c)||40!=c.length)return"invalid public key";if(a.key=c,a.public=new f.ecc.ECKey(f.ecc.ECCurves.secp160r1,b.concat([new b("04","hex"),a.key]),!0),!a.public)return"public key load failed";if(d){if("string"==typeof d&&(d=new b(d,"base64")),!b.isBuffer(d)||20!=d.length)return"invalid private key";if(a.private=new f.ecc.ECKey(f.ecc.ECCurves.secp160r1,d),!a.private)return"private key load failed"}return!1},c.openize=function(a,c,g){c.ecc||(c.ecc=new f.ecc.ECKey(f.ecc.ECCurves.secp160r1));var h=c.ecc.PublicKey.slice(1),i=c.ecc.deriveSharedSecret(c.public),j=d(1,f.createHash("sha256").update(i).digest()),k=new b("00000000000000000000000000000001","hex"),l=b.isBuffer(g)?g:e.pencode(g,a.cs["1a"].key),m=f.aes(!0,j,k,l),i=a.cs["1a"].private.deriveSharedSecret(c.public),n=b.concat([h,m]),o=d(3,f.createHmac("sha256",i).update(n).digest()),l=b.concat([o,n]);return e.pencode(26,l)},c.deopenize=function(a,c){var g={verify:!1};if(!c.body)return g;var h=c.body.slice(0,4).toString("hex"),i=c.body.slice(4,44),j=c.body.slice(44);try{g.linepub=new f.ecc.ECKey(f.ecc.ECCurves.secp160r1,b.concat([new b("04","hex"),i]),!0)}catch(k){console.log("ecc err",k)}if(!g.linepub)return g;var l=a.cs["1a"].private.deriveSharedSecret(g.linepub),m=d(1,f.createHash("sha256").update(l).digest()),n=new b("00000000000000000000000000000001","hex"),o=f.aes(!1,m,n,j),p=e.pdecode(o);if(!p)return g;g.inner=p;var q;if(c.from)q=c.from.public;else{if(q=new f.ecc.ECKey(f.ecc.ECCurves.secp160r1,b.concat([new b("04","hex"),p.body]),!0),!q)return g;g.key=p.body}var l=a.cs["1a"].private.deriveSharedSecret(q),r=d(3,f.createHmac("sha256",l).update(c.body.slice(4)).digest()).toString("hex");return r!=h?g:(g.verify=!0,g.js=p.js,g)},c.openline=function(a,c){a.lineIV=f.randomBytes(4).readUInt32LE(0),a.lineInB=new b(a.lineIn,"hex");var e=a.ecc.deriveSharedSecret(c.linepub);return a.encKey=d(1,f.createHash("sha256").update(e).update(new b(a.lineOut,"hex")).update(a.lineInB).digest()),a.decKey=d(1,f.createHash("sha256").update(e).update(a.lineInB).update(new b(a.lineOut,"hex")).digest()),!0},c.lineize=function(a,c){var g=new b(16);g.fill(0),g.writeUInt32LE(a.lineIV++,12);var h=f.aes(!0,a.encKey,g,e.pencode(c.js,c.body)),i=d(3,f.createHmac("sha256",a.encKey).update(b.concat([g.slice(12),h])).digest()),j=b.concat([a.lineInB,i,g.slice(12),h]);return e.pencode(null,j)},c.delineize=function(a,c){if(!c.body)return"no body";c.body=c.body.slice(16);var g=c.body.slice(0,4).toString("hex"),h=d(3,f.createHmac("sha256",a.decKey).update(c.body.slice(4)).digest()).toString("hex");if(g!=h)return"invalid hmac";var i=c.body.slice(4,8),j=new b(12);j.fill(0);var k=c.body.slice(8),l=e.pdecode(f.aes(!1,a.decKey,b.concat([j,i]),k));return l?(c.js=l.js,c.body=l.body,!1):"invalid decrypted packet"}}).call(this,a("buffer").Buffer)},{buffer:29,crypto:35}],5:[function(a,b){(function(a){!function(){var c,d,e;!function(a){function b(a,b){return u.call(a,b)}function f(a,c){var d,e,f,g,h,i,j,k,l,m,n,o=c&&c.split("/"),p=s.map,q=/\.js$/,r=p&&p["*"]||{};if(a&&"."===a.charAt(0))if(c){for(o=o.slice(0,o.length-1),a=a.split("/"),h=a.length-1,s.pkgs&&b(s.pkgs,o[0])&&q.test(a[h])&&(a[h]=a[h].replace(q,"")),a=o.concat(a),l=0;l<a.length;l+=1)if(n=a[l],"."===n)a.splice(l,1),l-=1;else if(".."===n){if(1===l&&(".."===a[2]||".."===a[0]))break;l>0&&(a.splice(l-1,2),l-=2)}a=a.join("/")}else 0===a.indexOf("./")&&(a=a.substring(2));if((o||r)&&p){for(d=a.split("/"),l=d.length;l>0;l-=1){if(e=d.slice(0,l).join("/"),o)for(m=o.length;m>0;m-=1)if(f=p[o.slice(0,m).join("/")],f&&(f=f[e])){g=f,i=l;break}if(g)break;!j&&r&&r[e]&&(j=r[e],k=l)}!g&&j&&(g=j,i=k),g&&(d.splice(0,i,g),a=d.join("/"))}return a}function g(b,c){return function(){return n.apply(a,v.call(arguments,0).concat([b,c]))}}function h(a){return function(b){return f(b,a)}}function i(a){return function(b){q[a]=b}}function j(c){if(b(r,c)){var d=r[c];delete r[c],t[c]=!0,m.apply(a,d)}if(!b(q,c)&&!b(t,c))throw new Error("No "+c);return q[c]}function k(a){var b,c=a?a.indexOf("!"):-1;return c>-1&&(b=a.substring(0,c),a=a.substring(c+1,a.length)),[b,a]}function l(a){return function(){return s&&s.config&&s.config[a]||{}}}var m,n,o,p,q={},r={},s={},t={},u=Object.prototype.hasOwnProperty,v=[].slice;o=function(a,b){var c,d=k(a),e=d[0];return a=d[1],e&&(e=f(e,b),c=j(e)),e?a=c&&c.normalize?c.normalize(a,h(b)):f(a,b):(a=f(a,b),d=k(a),e=d[0],a=d[1],e&&(c=j(e))),{f:e?e+"!"+a:a,n:a,pr:e,p:c}},p={require:function(a){return g(a)},exports:function(a){var b=q[a];return"undefined"!=typeof b?b:q[a]={}},module:function(a){return{id:a,uri:"",exports:q[a],config:l(a)}}},m=function(c,d,e,f){var h,k,l,m,n,s,u=[],v=typeof e;if(f=f||c,"undefined"===v||"function"===v){for(d=!d.length&&e.length?["require","exports","module"]:d,n=0;n<d.length;n+=1)if(m=o(d[n],f),k=m.f,"require"===k)u[n]=p.require(c);else if("exports"===k)u[n]=p.exports(c),s=!0;else if("module"===k)h=u[n]=p.module(c);else if(b(q,k)||b(r,k)||b(t,k))u[n]=j(k);else{if(!m.p)throw new Error(c+" missing "+k);m.p.load(m.n,g(f,!0),i(k),{}),u[n]=q[k]}l=e?e.apply(q[c],u):void 0,c&&(h&&h.exports!==a&&h.exports!==q[c]?q[c]=h.exports:l===a&&s||(q[c]=l))}else c&&(q[c]=e)},c=d=n=function(b,c,d,e,f){var g,h;if("string"==typeof b)return p[b]?p[b](c):j(o(b,c).f);if(!b.splice){if(s=b,s.deps&&n(s.deps,s.callback),h=s.packages,s.packages)for(s.pkgs={},g=0;g<h.length;g++)s.pkgs[h[g].name||h[g]]=!0;if(!c)return;c.splice?(b=c,c=d,d=null):b=a}return c=c||function(){},"function"==typeof d&&(d=e,e=f),e?m(a,b,c,d):setTimeout(function(){m(a,b,c,d)},4),n},n.config=function(a){return n(a)},c._defined=q,e=function(a,c,d){c.splice||(d=c,c=[]),!b(q,a)&&!b(r,a)&&(r[a]=[a,c,d])},e.amd={jQuery:!0}}(),e("node_modules/almond/almond",function(){}),function(){function c(b){var c=b.util=b.util||{};"undefined"!=typeof a&&a.nextTick?(c.nextTick=a.nextTick,c.setImmediate="function"==typeof setImmediate?setImmediate:c.nextTick):"function"==typeof setImmediate?(c.setImmediate=setImmediate,c.nextTick=function(a){return setImmediate(a)}):(c.setImmediate=function(a){setTimeout(a,0)},c.nextTick=c.setImmediate),c.isArray=Array.isArray||function(a){return"[object Array]"===Object.prototype.toString.call(a)},c.isArrayBuffer=function(a){return"undefined"!=typeof ArrayBuffer&&a instanceof ArrayBuffer};var d=[];"undefined"!=typeof Int8Array&&d.push(Int8Array),"undefined"!=typeof Uint8Array&&d.push(Uint8Array),"undefined"!=typeof Uint8ClampedArray&&d.push(Uint8ClampedArray),"undefined"!=typeof Int16Array&&d.push(Int16Array),"undefined"!=typeof Uint16Array&&d.push(Uint16Array),"undefined"!=typeof Int32Array&&d.push(Int32Array),"undefined"!=typeof Uint32Array&&d.push(Uint32Array),"undefined"!=typeof Float32Array&&d.push(Float32Array),"undefined"!=typeof Float64Array&&d.push(Float64Array),c.isArrayBufferView=function(a){for(var b=0;b<d.length;++b)if(a instanceof d[b])return!0;return!1},c.ByteBuffer=function(a){if(this.data="",this.read=0,"string"==typeof a)this.data=a;else if(c.isArrayBuffer(a)||c.isArrayBufferView(a)){var b=new Uint8Array(a);try{this.data=String.fromCharCode.apply(null,b)}catch(d){for(var e=0;e<b.length;++e)this.putByte(b[e])}}},c.ByteBuffer.prototype.length=function(){return this.data.length-this.read},c.ByteBuffer.prototype.isEmpty=function(){return this.length()<=0},c.ByteBuffer.prototype.putByte=function(a){return this.data+=String.fromCharCode(a),this},c.ByteBuffer.prototype.fillWithByte=function(a,b){a=String.fromCharCode(a);for(var c=this.data;b>0;)1&b&&(c+=a),b>>>=1,b>0&&(a+=a);return this.data=c,this},c.ByteBuffer.prototype.putBytes=function(a){return this.data+=a,this},c.ByteBuffer.prototype.putString=function(a){return this.data+=c.encodeUtf8(a),this},c.ByteBuffer.prototype.putInt16=function(a){return this.data+=String.fromCharCode(a>>8&255)+String.fromCharCode(255&a),this},c.ByteBuffer.prototype.putInt24=function(a){return this.data+=String.fromCharCode(a>>16&255)+String.fromCharCode(a>>8&255)+String.fromCharCode(255&a),this},c.ByteBuffer.prototype.putInt32=function(a){return this.data+=String.fromCharCode(a>>24&255)+String.fromCharCode(a>>16&255)+String.fromCharCode(a>>8&255)+String.fromCharCode(255&a),this},c.ByteBuffer.prototype.putInt16Le=function(a){return this.data+=String.fromCharCode(255&a)+String.fromCharCode(a>>8&255),this},c.ByteBuffer.prototype.putInt24Le=function(a){return this.data+=String.fromCharCode(255&a)+String.fromCharCode(a>>8&255)+String.fromCharCode(a>>16&255),this},c.ByteBuffer.prototype.putInt32Le=function(a){return this.data+=String.fromCharCode(255&a)+String.fromCharCode(a>>8&255)+String.fromCharCode(a>>16&255)+String.fromCharCode(a>>24&255),this},c.ByteBuffer.prototype.putInt=function(a,b){do b-=8,this.data+=String.fromCharCode(a>>b&255);while(b>0);return this},c.ByteBuffer.prototype.putSignedInt=function(a,b){return 0>a&&(a+=2<<b-1),this.putInt(a,b)},c.ByteBuffer.prototype.putBuffer=function(a){return this.data+=a.getBytes(),this},c.ByteBuffer.prototype.getByte=function(){return this.data.charCodeAt(this.read++)},c.ByteBuffer.prototype.getInt16=function(){var a=this.data.charCodeAt(this.read)<<8^this.data.charCodeAt(this.read+1);return this.read+=2,a},c.ByteBuffer.prototype.getInt24=function(){var a=this.data.charCodeAt(this.read)<<16^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2);return this.read+=3,a},c.ByteBuffer.prototype.getInt32=function(){var a=this.data.charCodeAt(this.read)<<24^this.data.charCodeAt(this.read+1)<<16^this.data.charCodeAt(this.read+2)<<8^this.data.charCodeAt(this.read+3);return this.read+=4,a},c.ByteBuffer.prototype.getInt16Le=function(){var a=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8;return this.read+=2,a},c.ByteBuffer.prototype.getInt24Le=function(){var a=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16;return this.read+=3,a},c.ByteBuffer.prototype.getInt32Le=function(){var a=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16^this.data.charCodeAt(this.read+3)<<24;return this.read+=4,a},c.ByteBuffer.prototype.getInt=function(a){var b=0;do b=(b<<8)+this.data.charCodeAt(this.read++),a-=8;while(a>0);return b},c.ByteBuffer.prototype.getSignedInt=function(a){var b=this.getInt(a),c=2<<a-2;return b>=c&&(b-=c<<1),b},c.ByteBuffer.prototype.getBytes=function(a){var b;return a?(a=Math.min(this.length(),a),b=this.data.slice(this.read,this.read+a),this.read+=a):0===a?b="":(b=0===this.read?this.data:this.data.slice(this.read),this.clear()),b},c.ByteBuffer.prototype.bytes=function(a){return"undefined"==typeof a?this.data.slice(this.read):this.data.slice(this.read,this.read+a)},c.ByteBuffer.prototype.at=function(a){return this.data.charCodeAt(this.read+a)},c.ByteBuffer.prototype.setAt=function(a,b){return this.data=this.data.substr(0,this.read+a)+String.fromCharCode(b)+this.data.substr(this.read+a+1),this},c.ByteBuffer.prototype.last=function(){return this.data.charCodeAt(this.data.length-1)},c.ByteBuffer.prototype.copy=function(){var a=c.createBuffer(this.data);return a.read=this.read,a},c.ByteBuffer.prototype.compact=function(){return this.read>0&&(this.data=this.data.slice(this.read),this.read=0),this},c.ByteBuffer.prototype.clear=function(){return this.data="",this.read=0,this},c.ByteBuffer.prototype.truncate=function(a){var b=Math.max(0,this.length()-a);return this.data=this.data.substr(this.read,b),this.read=0,this},c.ByteBuffer.prototype.toHex=function(){for(var a="",b=this.read;b<this.data.length;++b){var c=this.data.charCodeAt(b);16>c&&(a+="0"),a+=c.toString(16)}return a},c.ByteBuffer.prototype.toString=function(){return c.decodeUtf8(this.bytes())},c.createBuffer=function(a,b){return b=b||"raw",void 0!==a&&"utf8"===b&&(a=c.encodeUtf8(a)),new c.ByteBuffer(a)},c.fillString=function(a,b){for(var c="";b>0;)1&b&&(c+=a),b>>>=1,b>0&&(a+=a);return c},c.xorBytes=function(a,b,c){for(var d="",e="",f="",g=0,h=0;c>0;--c,++g)e=a.charCodeAt(g)^b.charCodeAt(g),h>=10&&(d+=f,f="",h=0),f+=String.fromCharCode(e),++h;return d+=f},c.hexToBytes=function(a){var b="",c=0;for(a.length&!0&&(c=1,b+=String.fromCharCode(parseInt(a[0],16)));c<a.length;c+=2)b+=String.fromCharCode(parseInt(a.substr(c,2),16));return b},c.bytesToHex=function(a){return c.createBuffer(a).toHex()},c.int32ToBytes=function(a){return String.fromCharCode(a>>24&255)+String.fromCharCode(a>>16&255)+String.fromCharCode(a>>8&255)+String.fromCharCode(255&a)};var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",f=[62,-1,-1,-1,63,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,64,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,-1,-1,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51];c.encode64=function(a,b){for(var c,d,f,g="",h="",i=0;i<a.length;)c=a.charCodeAt(i++),d=a.charCodeAt(i++),f=a.charCodeAt(i++),g+=e.charAt(c>>2),g+=e.charAt((3&c)<<4|d>>4),isNaN(d)?g+="==":(g+=e.charAt((15&d)<<2|f>>6),g+=isNaN(f)?"=":e.charAt(63&f)),b&&g.length>b&&(h+=g.substr(0,b)+"\r\n",g=g.substr(b));return h+=g},c.decode64=function(a){a=a.replace(/[^A-Za-z0-9\+\/\=]/g,"");for(var b,c,d,e,g="",h=0;h<a.length;)b=f[a.charCodeAt(h++)-43],c=f[a.charCodeAt(h++)-43],d=f[a.charCodeAt(h++)-43],e=f[a.charCodeAt(h++)-43],g+=String.fromCharCode(b<<2|c>>4),64!==d&&(g+=String.fromCharCode((15&c)<<4|d>>2),64!==e&&(g+=String.fromCharCode((3&d)<<6|e)));return g},c.encodeUtf8=function(a){return unescape(encodeURIComponent(a))},c.decodeUtf8=function(a){return decodeURIComponent(escape(a))},c.deflate=function(a,b,d){if(b=c.decode64(a.deflate(c.encode64(b)).rval),d){var e=2,f=b.charCodeAt(1);32&f&&(e=6),b=b.substring(e,b.length-4)}return b},c.inflate=function(a,b){var d=a.inflate(c.encode64(b)).rval;return null===d?null:c.decode64(d)};var g=function(a,b,d){if(!a)throw{message:"WebStorage not available."};var e;if(null===d?e=a.removeItem(b):(d=c.encode64(JSON.stringify(d)),e=a.setItem(b,d)),"undefined"!=typeof e&&e.rval!==!0)throw e.error},h=function(a,b){if(!a)throw{message:"WebStorage not available."};var d=a.getItem(b);if(a.init)if(null===d.rval){if(d.error)throw d.error;d=null}else d=d.rval;return null!==d&&(d=JSON.parse(c.decode64(d))),d},i=function(a,b,c,d){var e=h(a,b);null===e&&(e={}),e[c]=d,g(a,b,e)},j=function(a,b,c){var d=h(a,b);return null!==d&&(d=c in d?d[c]:null),d},k=function(a,b,c){var d=h(a,b);if(null!==d&&c in d){delete d[c];var e=!0;for(var f in d){e=!1;break}e&&(d=null),g(a,b,d)}},l=function(a,b){g(a,b,null)},m=function(a,b,c){var d=null;"undefined"==typeof c&&(c=["web","flash"]);var e,f=!1,g=null;for(var h in c){e=c[h];try{if("flash"===e||"both"===e){if(null===b[0])throw{message:"Flash local storage not available."};d=a.apply(this,b),f="flash"===e}("web"===e||"both"===e)&&(b[0]=localStorage,d=a.apply(this,b),f=!0)}catch(i){g=i}if(f)break}if(!f)throw g;return d};c.setItem=function(a,b,c,d,e){m(i,arguments,e)},c.getItem=function(a,b,c,d){return m(j,arguments,d)},c.removeItem=function(a,b,c,d){m(k,arguments,d)},c.clearItems=function(a,b,c){m(l,arguments,c)},c.parseUrl=function(a){var b=/^(https?):\/\/([^:&^\/]*):?(\d*)(.*)$/g;b.lastIndex=0;var c=b.exec(a),d=null===c?null:{full:a,scheme:c[1],host:c[2],port:c[3],path:c[4]};return d&&(d.fullHost=d.host,d.port?80!==d.port&&"http"===d.scheme?d.fullHost+=":"+d.port:443!==d.port&&"https"===d.scheme&&(d.fullHost+=":"+d.port):"http"===d.scheme?d.port=80:"https"===d.scheme&&(d.port=443),d.full=d.scheme+"://"+d.fullHost),d};var n=null;c.getQueryVariables=function(a){var b,c=function(a){for(var b={},c=a.split("&"),d=0;d<c.length;d++){var e,f,g=c[d].indexOf("=");g>0?(e=c[d].substring(0,g),f=c[d].substring(g+1)):(e=c[d],f=null),e in b||(b[e]=[]),!(e in Object.prototype)&&null!==f&&b[e].push(unescape(f))}return b};return"undefined"==typeof a?(null===n&&(n="undefined"==typeof window?{}:c(window.location.search.substring(1))),b=n):b=c(a),b},c.parseFragment=function(a){var b=a,d="",e=a.indexOf("?");e>0&&(b=a.substring(0,e),d=a.substring(e+1));var f=b.split("/");f.length>0&&""===f[0]&&f.shift();var g=""===d?{}:c.getQueryVariables(d);return{pathString:b,queryString:d,path:f,query:g}},c.makeRequest=function(a){var b=c.parseFragment(a),d={path:b.pathString,query:b.queryString,getPath:function(a){return"undefined"==typeof a?b.path:b.path[a]},getQuery:function(a,c){var d;return"undefined"==typeof a?d=b.query:(d=b.query[a],d&&"undefined"!=typeof c&&(d=d[c])),d},getQueryLast:function(a,b){var c,e=d.getQuery(a);return c=e?e[e.length-1]:b}};return d},c.makeLink=function(a,b,c){a=jQuery.isArray(a)?a.join("/"):a;var d=jQuery.param(b||{});return c=c||"",a+(d.length>0?"?"+d:"")+(c.length>0?"#"+c:"")},c.setPath=function(a,b,c){if("object"==typeof a&&null!==a)for(var d=0,e=b.length;e>d;){var f=b[d++];if(d==e)a[f]=c;else{var g=f in a;(!g||g&&"object"!=typeof a[f]||g&&null===a[f])&&(a[f]={}),a=a[f]}}},c.getPath=function(a,b,c){for(var d=0,e=b.length,f=!0;f&&e>d&&"object"==typeof a&&null!==a;){var g=b[d++];f=g in a,f&&(a=a[g])}return f?a:c},c.deletePath=function(a,b){if("object"==typeof a&&null!==a)for(var c=0,d=b.length;d>c;){var e=b[c++];if(c==d)delete a[e];else{if(!(e in a&&"object"==typeof a[e]&&null!==a[e]))break;a=a[e]}}},c.isEmpty=function(a){for(var b in a)if(a.hasOwnProperty(b))return!1;return!0},c.format=function(a){for(var b,c,d=/%./g,e=0,f=[],g=0;b=d.exec(a);){c=a.substring(g,d.lastIndex-2),c.length>0&&f.push(c),g=d.lastIndex;var h=b[0][1];switch(h){case"s":case"o":f.push(e<arguments.length?arguments[e++ +1]:"<?>");break;case"%":f.push("%");break;default:f.push("<%"+h+"?>")}}return f.push(a.substring(g)),f.join("")},c.formatNumber=function(a,b,c,d){var e=a,f=isNaN(b=Math.abs(b))?2:b,g=void 0===c?",":c,h=void 0===d?".":d,i=0>e?"-":"",j=parseInt(e=Math.abs(+e||0).toFixed(f),10)+"",k=j.length>3?j.length%3:0;return i+(k?j.substr(0,k)+h:"")+j.substr(k).replace(/(\d{3})(?=\d)/g,"$1"+h)+(f?g+Math.abs(e-j).toFixed(f).slice(2):"")},c.formatSize=function(a){return a=a>=1073741824?c.formatNumber(a/1073741824,2,".","")+" GiB":a>=1048576?c.formatNumber(a/1048576,2,".","")+" MiB":a>=1024?c.formatNumber(a/1024,0)+" KiB":c.formatNumber(a,0)+" bytes"},c.bytesFromIP=function(a){return-1!==a.indexOf(".")?c.bytesFromIPv4(a):-1!==a.indexOf(":")?c.bytesFromIPv6(a):null},c.bytesFromIPv4=function(a){if(a=a.split("."),4!==a.length)return null;for(var b=c.createBuffer(),d=0;d<a.length;++d){var e=parseInt(a[d],10);if(isNaN(e))return null;b.putByte(e)}return b.getBytes()},c.bytesFromIPv6=function(a){var b=0;a=a.split(":").filter(function(a){return 0===a.length&&++b,!0});for(var d=2*(8-a.length+b),e=c.createBuffer(),f=0;8>f;++f)if(a[f]&&0!==a[f].length){var g=c.hexToBytes(a[f]);g.length<2&&e.putByte(0),e.putBytes(g)}else e.fillWithByte(0,d),d=0;return e.getBytes()},c.bytesToIP=function(a){return 4===a.length?c.bytesToIPv4(a):16===a.length?c.bytesToIPv6(a):null},c.bytesToIPv4=function(a){if(4!==a.length)return null;for(var b=[],c=0;c<a.length;++c)b.push(a.charCodeAt(c));return b.join(".")},c.bytesToIPv6=function(a){if(16!==a.length)return null;for(var b=[],d=[],e=0,f=0;f<a.length;f+=2){for(var g=c.bytesToHex(a[f]+a[f+1]);"0"===g[0]&&"0"!==g;)g=g.substr(1);if("0"===g){var h=d[d.length-1],i=b.length;h&&i===h.end+1?(h.end=i,h.end-h.start>d[e].end-d[e].start&&(e=d.length-1)):d.push({start:i,end:i})}b.push(g)}if(d.length>0){var j=d[e];j.end-j.start>0&&(b.splice(j.start,j.end-j.start+1,""),0===j.start&&b.unshift(""),7===j.end&&b.push(""))}return b.join(":")}}var f="util";if("function"!=typeof e){if("object"!=typeof b||!b.exports)return"undefined"==typeof forge&&(forge={}),c(forge);var g=!0;e=function(a,c){c(d,b)}}var h,i=function(a,b){b.exports=function(b){var d=h.map(function(b){return a(b)}).concat(c);if(b=b||{},b.defined=b.defined||{},b.defined[f])return b[f];b.defined[f]=!0;for(var e=0;e<d.length;++e)d[e](b);return b[f]}},j=e;(e=function(a,b){return h="string"==typeof a?b.slice(2):a.slice(2),g?(delete e,j.apply(null,Array.prototype.slice.call(arguments,0))):(e=j,e.apply(null,Array.prototype.slice.call(arguments,0)))})("js/util",["require","module"],function(){i.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function a(a){var b,c,d,e,f,g=!1,h=4,i=function(){g=!0,d=[0,1,2,4,8,16,32,64,128,27,54];for(var a=new Array(256),h=0;128>h;++h)a[h]=h<<1,a[h+128]=h+128<<1^283;b=new Array(256),c=new Array(256),e=new Array(4),f=new Array(4);for(var h=0;4>h;++h)e[h]=new Array(256),f[h]=new Array(256);for(var i,j,k,l,m,n,o,p=0,q=0,h=0;256>h;++h){l=q^q<<1^q<<2^q<<3^q<<4,l=l>>8^255&l^99,b[p]=l,c[l]=p,m=a[l],i=a[p],j=a[i],k=a[j],n=m<<24^l<<16^l<<8^(l^m),o=(i^j^k)<<24^(p^k)<<16^(p^j^k)<<8^(p^i^k);for(var r=0;4>r;++r)e[r][p]=n,f[r][l]=o,n=n<<24|n>>>8,o=o<<24|o>>>8;0===p?p=q=1:(p=i^a[a[a[i^k]]],q^=a[a[q]])}},j=function(a,c){for(var e,g=a.slice(0),i=1,j=g.length,k=j+6+1,l=h*k,m=j;l>m;++m)e=g[m-1],m%j===0?(e=b[e>>>16&255]<<24^b[e>>>8&255]<<16^b[255&e]<<8^b[e>>>24]^d[i]<<24,i++):j>6&&m%j===4&&(e=b[e>>>24]<<24^b[e>>>16&255]<<16^b[e>>>8&255]<<8^b[255&e]),g[m]=g[m-j]^e;if(c){for(var n,o=f[0],p=f[1],q=f[2],r=f[3],s=g.slice(0),l=g.length,m=0,t=l-h;l>m;m+=h,t-=h)if(0===m||m===l-h)s[m]=g[t],s[m+1]=g[t+3],s[m+2]=g[t+2],s[m+3]=g[t+1];else for(var u=0;h>u;++u)n=g[t+u],s[m+(3&-u)]=o[b[n>>>24]]^p[b[n>>>16&255]]^q[b[n>>>8&255]]^r[b[255&n]];g=s}return g},k=function(a,d,g,h){var i,j,k,l,m,n=a.length/4-1;h?(i=f[0],j=f[1],k=f[2],l=f[3],m=c):(i=e[0],j=e[1],k=e[2],l=e[3],m=b);var o,p,q,r,s,t,u;o=d[0]^a[0],p=d[h?3:1]^a[1],q=d[2]^a[2],r=d[h?1:3]^a[3];for(var v=3,w=1;n>w;++w)s=i[o>>>24]^j[p>>>16&255]^k[q>>>8&255]^l[255&r]^a[++v],t=i[p>>>24]^j[q>>>16&255]^k[r>>>8&255]^l[255&o]^a[++v],u=i[q>>>24]^j[r>>>16&255]^k[o>>>8&255]^l[255&p]^a[++v],r=i[r>>>24]^j[o>>>16&255]^k[p>>>8&255]^l[255&q]^a[++v],o=s,p=t,q=u;g[0]=m[o>>>24]<<24^m[p>>>16&255]<<16^m[q>>>8&255]<<8^m[255&r]^a[++v],g[h?3:1]=m[p>>>24]<<24^m[q>>>16&255]<<16^m[r>>>8&255]<<8^m[255&o]^a[++v],g[2]=m[q>>>24]<<24^m[r>>>16&255]<<16^m[o>>>8&255]<<8^m[255&p]^a[++v],g[h?1:3]=m[r>>>24]<<24^m[o>>>16&255]<<16^m[p>>>8&255]<<8^m[255&q]^a[++v]},l=function(b,c,d,e,f){function l(){if(e)for(var a=0;h>a;++a)v[a]=t.getInt32();else for(var a=0;h>a;++a)v[a]=x[a]^t.getInt32();if(k(C,v,w,e),e){for(var a=0;h>a;++a)u.putInt32(x[a]^w[a]);x=v.slice(0)}else{for(var a=0;h>a;++a)u.putInt32(w[a]);x=w}}function m(){k(C,v,w,!1);for(var a=0;h>a;++a)v[a]=t.getInt32();for(var a=0;h>a;++a){var b=v[a]^w[a];e||(v[a]=b),u.putInt32(b)}}function n(){k(C,v,w,!1);for(var a=0;h>a;++a)v[a]=t.getInt32();for(var a=0;h>a;++a)u.putInt32(v[a]^w[a]),v[a]=w[a]}function o(){k(C,v,w,!1);for(var a=h-1;a>=0;--a){if(4294967295!==v[a]){++v[a];break}v[a]=0}for(var a=0;h>a;++a)u.putInt32(t.getInt32()^w[a])}var p=null;if(g||i(),f=(f||"CBC").toUpperCase(),"string"!=typeof b||16!==b.length&&24!==b.length&&32!==b.length){if(a.util.isArray(b)&&(16===b.length||24===b.length||32===b.length))for(var q=b,b=a.util.createBuffer(),r=0;r<q.length;++r)b.putByte(q[r])}else b=a.util.createBuffer(b);if(!a.util.isArray(b)){var q=b;b=[];var s=q.length();if(16===s||24===s||32===s){s>>>=2;for(var r=0;s>r;++r)b.push(q.getInt32())}}if(!a.util.isArray(b)||4!==b.length&&6!==b.length&&8!==b.length)return p;var t,u,v,w,x,y,z,A=-1!==["CFB","OFB","CTR"].indexOf(f),B="CBC"===f,C=j(b,e&&!A),D=h<<2;if(p={output:null},"CBC"===f)z=l;else if("CFB"===f)z=m;else if("OFB"===f)z=n;else{if("CTR"!==f)throw{message:'Unsupported block cipher mode of operation: "'+f+'"'};z=o}return p.update=function(a){for(y||t.putBuffer(a);t.length()>=D||t.length()>0&&y;)z()},p.finish=function(a){var b=!0,c=t.length()%D;if(!e)if(a)b=a(D,t,e);else if(B){var d=t.length()===D?D:D-t.length();t.fillWithByte(d,d)}if(b&&(y=!0,p.update()),e&&(B&&(b=0===c),b))if(a)b=a(D,u,e);else if(B){var f=u.length(),g=u.at(f-1);g>h<<2?b=!1:u.truncate(g)}return!B&&!a&&c>0&&u.truncate(D-c),b},p.start=function(b,c){if(null===b&&(b=x.slice(0)),"string"==typeof b&&16===b.length)b=a.util.createBuffer(b);else if(a.util.isArray(b)&&16===b.length)for(var d=b,b=a.util.createBuffer(),e=0;16>e;++e)b.putByte(d[e]);if(!a.util.isArray(b)){var d=b;b=new Array(4),b[0]=d.getInt32(),b[1]=d.getInt32(),b[2]=d.getInt32(),b[3]=d.getInt32()}if(t=a.util.createBuffer(),u=c||a.util.createBuffer(),x=b.slice(0),v=new Array(h),w=new Array(h),y=!1,p.output=u,-1!==["CFB","OFB","CTR"].indexOf(f)){for(var e=0;h>e;++e)v[e]=x[e];x=null}},null!==c&&p.start(c,d),p};a.aes=a.aes||{},a.aes.startEncrypting=function(a,b,c,d){return l(a,b,c,!1,d)},a.aes.createEncryptionCipher=function(a,b){return l(a,null,null,!1,b)},a.aes.startDecrypting=function(a,b,c,d){return l(a,b,c,!0,d)},a.aes.createDecryptionCipher=function(a,b){return l(a,null,null,!0,b)},a.aes._expandKey=function(a,b){return g||i(),j(a,b)},a.aes._updateBlock=k}var c="aes";if("function"!=typeof e){if("object"!=typeof b||!b.exports)return"undefined"==typeof forge&&(forge={}),a(forge);var f=!0;e=function(a,c){c(d,b)}}var g,h=function(b,d){d.exports=function(d){var e=g.map(function(a){return b(a)}).concat(a);if(d=d||{},d.defined=d.defined||{},d.defined[c])return d[c];d.defined[c]=!0;for(var f=0;f<e.length;++f)e[f](d);return d[c]}},i=e;(e=function(a,b){return g="string"==typeof a?b.slice(2):a.slice(2),f?(delete e,i.apply(null,Array.prototype.slice.call(arguments,0))):(e=i,e.apply(null,Array.prototype.slice.call(arguments,0)))})("js/aes",["require","module","./util"],function(){h.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function a(a){a.pki=a.pki||{};var b=a.pki.oids=a.oids=a.oids||{};b["1.2.840.113549.1.1.1"]="rsaEncryption",b.rsaEncryption="1.2.840.113549.1.1.1",b["1.2.840.113549.1.1.4"]="md5WithRSAEncryption",b.md5WithRSAEncryption="1.2.840.113549.1.1.4",b["1.2.840.113549.1.1.5"]="sha1WithRSAEncryption",b.sha1WithRSAEncryption="1.2.840.113549.1.1.5",b["1.2.840.113549.1.1.7"]="RSAES-OAEP",b["RSAES-OAEP"]="1.2.840.113549.1.1.7",b["1.2.840.113549.1.1.8"]="mgf1",b.mgf1="1.2.840.113549.1.1.8",b["1.2.840.113549.1.1.9"]="pSpecified",b.pSpecified="1.2.840.113549.1.1.9",b["1.2.840.113549.1.1.10"]="RSASSA-PSS",b["RSASSA-PSS"]="1.2.840.113549.1.1.10",b["1.2.840.113549.1.1.11"]="sha256WithRSAEncryption",b.sha256WithRSAEncryption="1.2.840.113549.1.1.11",b["1.2.840.113549.1.1.12"]="sha384WithRSAEncryption",b.sha384WithRSAEncryption="1.2.840.113549.1.1.12",b["1.2.840.113549.1.1.13"]="sha512WithRSAEncryption",b.sha512WithRSAEncryption="1.2.840.113549.1.1.13",b["1.3.14.3.2.7"]="desCBC",b.desCBC="1.3.14.3.2.7",b["1.3.14.3.2.26"]="sha1",b.sha1="1.3.14.3.2.26",b["2.16.840.1.101.3.4.2.1"]="sha256",b.sha256="2.16.840.1.101.3.4.2.1",b["2.16.840.1.101.3.4.2.2"]="sha384",b.sha384="2.16.840.1.101.3.4.2.2",b["2.16.840.1.101.3.4.2.3"]="sha512",b.sha512="2.16.840.1.101.3.4.2.3",b["1.2.840.113549.2.5"]="md5",b.md5="1.2.840.113549.2.5",b["1.2.840.113549.1.7.1"]="data",b.data="1.2.840.113549.1.7.1",b["1.2.840.113549.1.7.2"]="signedData",b.signedData="1.2.840.113549.1.7.2",b["1.2.840.113549.1.7.3"]="envelopedData",b.envelopedData="1.2.840.113549.1.7.3",b["1.2.840.113549.1.7.4"]="signedAndEnvelopedData",b.signedAndEnvelopedData="1.2.840.113549.1.7.4",b["1.2.840.113549.1.7.5"]="digestedData",b.digestedData="1.2.840.113549.1.7.5",b["1.2.840.113549.1.7.6"]="encryptedData",b.encryptedData="1.2.840.113549.1.7.6",b["1.2.840.113549.1.9.1"]="emailAddress",b.emailAddress="1.2.840.113549.1.9.1",b["1.2.840.113549.1.9.2"]="unstructuredName",b.unstructuredName="1.2.840.113549.1.9.2",b["1.2.840.113549.1.9.3"]="contentType",b.contentType="1.2.840.113549.1.9.3",b["1.2.840.113549.1.9.4"]="messageDigest",b.messageDigest="1.2.840.113549.1.9.4",b["1.2.840.113549.1.9.5"]="signingTime",b.signingTime="1.2.840.113549.1.9.5",b["1.2.840.113549.1.9.6"]="counterSignature",b.counterSignature="1.2.840.113549.1.9.6",b["1.2.840.113549.1.9.7"]="challengePassword",b.challengePassword="1.2.840.113549.1.9.7",b["1.2.840.113549.1.9.8"]="unstructuredAddress",b.unstructuredAddress="1.2.840.113549.1.9.8",b["1.2.840.113549.1.9.20"]="friendlyName",b.friendlyName="1.2.840.113549.1.9.20",b["1.2.840.113549.1.9.21"]="localKeyId",b.localKeyId="1.2.840.113549.1.9.21",b["1.2.840.113549.1.9.22.1"]="x509Certificate",b.x509Certificate="1.2.840.113549.1.9.22.1",b["1.2.840.113549.1.12.10.1.1"]="keyBag",b.keyBag="1.2.840.113549.1.12.10.1.1",b["1.2.840.113549.1.12.10.1.2"]="pkcs8ShroudedKeyBag",b.pkcs8ShroudedKeyBag="1.2.840.113549.1.12.10.1.2",b["1.2.840.113549.1.12.10.1.3"]="certBag",b.certBag="1.2.840.113549.1.12.10.1.3",b["1.2.840.113549.1.12.10.1.4"]="crlBag",b.crlBag="1.2.840.113549.1.12.10.1.4",b["1.2.840.113549.1.12.10.1.5"]="secretBag",b.secretBag="1.2.840.113549.1.12.10.1.5",b["1.2.840.113549.1.12.10.1.6"]="safeContentsBag",b.safeContentsBag="1.2.840.113549.1.12.10.1.6",b["1.2.840.113549.1.5.13"]="pkcs5PBES2",b.pkcs5PBES2="1.2.840.113549.1.5.13",b["1.2.840.113549.1.5.12"]="pkcs5PBKDF2",b.pkcs5PBKDF2="1.2.840.113549.1.5.12",b["1.2.840.113549.1.12.1.1"]="pbeWithSHAAnd128BitRC4",b.pbeWithSHAAnd128BitRC4="1.2.840.113549.1.12.1.1",b["1.2.840.113549.1.12.1.2"]="pbeWithSHAAnd40BitRC4",b.pbeWithSHAAnd40BitRC4="1.2.840.113549.1.12.1.2",b["1.2.840.113549.1.12.1.3"]="pbeWithSHAAnd3-KeyTripleDES-CBC",b["pbeWithSHAAnd3-KeyTripleDES-CBC"]="1.2.840.113549.1.12.1.3",b["1.2.840.113549.1.12.1.4"]="pbeWithSHAAnd2-KeyTripleDES-CBC",b["pbeWithSHAAnd2-KeyTripleDES-CBC"]="1.2.840.113549.1.12.1.4",b["1.2.840.113549.1.12.1.5"]="pbeWithSHAAnd128BitRC2-CBC",b["pbeWithSHAAnd128BitRC2-CBC"]="1.2.840.113549.1.12.1.5",b["1.2.840.113549.1.12.1.6"]="pbewithSHAAnd40BitRC2-CBC",b["pbewithSHAAnd40BitRC2-CBC"]="1.2.840.113549.1.12.1.6",b["1.2.840.113549.3.7"]="des-EDE3-CBC",b["des-EDE3-CBC"]="1.2.840.113549.3.7",b["2.16.840.1.101.3.4.1.2"]="aes128-CBC",b["aes128-CBC"]="2.16.840.1.101.3.4.1.2",b["2.16.840.1.101.3.4.1.22"]="aes192-CBC",b["aes192-CBC"]="2.16.840.1.101.3.4.1.22",b["2.16.840.1.101.3.4.1.42"]="aes256-CBC",b["aes256-CBC"]="2.16.840.1.101.3.4.1.42",b["2.5.4.3"]="commonName",b.commonName="2.5.4.3",b["2.5.4.5"]="serialName",b.serialName="2.5.4.5",b["2.5.4.6"]="countryName",b.countryName="2.5.4.6",b["2.5.4.7"]="localityName",b.localityName="2.5.4.7",b["2.5.4.8"]="stateOrProvinceName",b.stateOrProvinceName="2.5.4.8",b["2.5.4.10"]="organizationName",b.organizationName="2.5.4.10",b["2.5.4.11"]="organizationalUnitName",b.organizationalUnitName="2.5.4.11",b["2.16.840.1.113730.1.1"]="nsCertType",b.nsCertType="2.16.840.1.113730.1.1",b["2.5.29.1"]="authorityKeyIdentifier",b["2.5.29.2"]="keyAttributes",b["2.5.29.3"]="certificatePolicies",b["2.5.29.4"]="keyUsageRestriction",b["2.5.29.5"]="policyMapping",b["2.5.29.6"]="subtreesConstraint",b["2.5.29.7"]="subjectAltName",b["2.5.29.8"]="issuerAltName",b["2.5.29.9"]="subjectDirectoryAttributes",b["2.5.29.10"]="basicConstraints",b["2.5.29.11"]="nameConstraints",b["2.5.29.12"]="policyConstraints",b["2.5.29.13"]="basicConstraints",b["2.5.29.14"]="subjectKeyIdentifier",b.subjectKeyIdentifier="2.5.29.14",b["2.5.29.15"]="keyUsage",b.keyUsage="2.5.29.15",b["2.5.29.16"]="privateKeyUsagePeriod",b["2.5.29.17"]="subjectAltName",b.subjectAltName="2.5.29.17",b["2.5.29.18"]="issuerAltName",b.issuerAltName="2.5.29.18",b["2.5.29.19"]="basicConstraints",b.basicConstraints="2.5.29.19",b["2.5.29.20"]="cRLNumber",b["2.5.29.21"]="cRLReason",b["2.5.29.22"]="expirationDate",b["2.5.29.23"]="instructionCode",b["2.5.29.24"]="invalidityDate",b["2.5.29.25"]="cRLDistributionPoints",b["2.5.29.26"]="issuingDistributionPoint",b["2.5.29.27"]="deltaCRLIndicator",b["2.5.29.28"]="issuingDistributionPoint",b["2.5.29.29"]="certificateIssuer",b["2.5.29.30"]="nameConstraints",b["2.5.29.31"]="cRLDistributionPoints",b["2.5.29.32"]="certificatePolicies",b["2.5.29.33"]="policyMappings",b["2.5.29.34"]="policyConstraints",b["2.5.29.35"]="authorityKeyIdentifier",b["2.5.29.36"]="policyConstraints",b["2.5.29.37"]="extKeyUsage",b.extKeyUsage="2.5.29.37",b["2.5.29.46"]="freshestCRL",b["2.5.29.54"]="inhibitAnyPolicy",b["1.3.6.1.5.5.7.3.1"]="serverAuth",b.serverAuth="1.3.6.1.5.5.7.3.1",b["1.3.6.1.5.5.7.3.2"]="clientAuth",b.clientAuth="1.3.6.1.5.5.7.3.2",b["1.3.6.1.5.5.7.3.3"]="codeSigning",b.codeSigning="1.3.6.1.5.5.7.3.3",b["1.3.6.1.5.5.7.3.4"]="emailProtection",b.emailProtection="1.3.6.1.5.5.7.3.4",b["1.3.6.1.5.5.7.3.8"]="timeStamping",b.timeStamping="1.3.6.1.5.5.7.3.8"
}var c="oids";if("function"!=typeof e){if("object"!=typeof b||!b.exports)return"undefined"==typeof forge&&(forge={}),a(forge);var f=!0;e=function(a,c){c(d,b)}}var g,h=function(b,d){d.exports=function(d){var e=g.map(function(a){return b(a)}).concat(a);if(d=d||{},d.defined=d.defined||{},d.defined[c])return d[c];d.defined[c]=!0;for(var f=0;f<e.length;++f)e[f](d);return d[c]}},i=e;(e=function(a,b){return g="string"==typeof a?b.slice(2):a.slice(2),f?(delete e,i.apply(null,Array.prototype.slice.call(arguments,0))):(e=i,e.apply(null,Array.prototype.slice.call(arguments,0)))})("js/oids",["require","module"],function(){h.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function a(a){var b=a.asn1=a.asn1||{};b.Class={UNIVERSAL:0,APPLICATION:64,CONTEXT_SPECIFIC:128,PRIVATE:192},b.Type={NONE:0,BOOLEAN:1,INTEGER:2,BITSTRING:3,OCTETSTRING:4,NULL:5,OID:6,ODESC:7,EXTERNAL:8,REAL:9,ENUMERATED:10,EMBEDDED:11,UTF8:12,ROID:13,SEQUENCE:16,SET:17,PRINTABLESTRING:19,IA5STRING:22,UTCTIME:23,GENERALIZEDTIME:24,BMPSTRING:30},b.create=function(b,c,d,e){if(a.util.isArray(e)){for(var f=[],g=0;g<e.length;++g)void 0!==e[g]&&f.push(e[g]);e=f}return{tagClass:b,type:c,constructed:d,composed:d||a.util.isArray(e),value:e}};var c=function(a){var b=a.getByte();if(128===b)return void 0;var c,d=128&b;return c=d?a.getInt((127&b)<<3):b};b.fromDer=function(d,e){if(void 0===e&&(e=!0),"string"==typeof d&&(d=a.util.createBuffer(d)),d.length()<2)throw{message:"Too few bytes to parse DER.",bytes:d.length()};var f=d.getByte(),g=192&f,h=31&f,i=c(d);if(d.length()<i){if(e)throw{message:"Too few bytes to read ASN.1 value.",detail:d.length()+" < "+i};i=d.length()}var j,k=32===(32&f),l=k;if(!l&&g===b.Class.UNIVERSAL&&h===b.Type.BITSTRING&&i>1){var m=d.read,n=d.getByte();if(0===n){f=d.getByte();var o=192&f;if(o===b.Class.UNIVERSAL||o===b.Class.CONTEXT_SPECIFIC)try{var p=c(d);l=p===i-(d.read-m),l&&(++m,--i)}catch(q){}}d.read=m}if(l)if(j=[],void 0===i)for(;;){if(d.bytes(2)===String.fromCharCode(0,0)){d.getBytes(2);break}j.push(b.fromDer(d,e))}else for(var r=d.length();i>0;)j.push(b.fromDer(d,e)),i-=r-d.length(),r=d.length();else{if(void 0===i){if(e)throw{message:"Non-constructed ASN.1 object of indefinite length."};i=d.length()}if(h===b.Type.BMPSTRING){j="";for(var s=0;i>s;s+=2)j+=String.fromCharCode(d.getInt16())}else j=d.getBytes(i)}return b.create(g,h,k,j)},b.toDer=function(c){var d=a.util.createBuffer(),e=c.tagClass|c.type,f=a.util.createBuffer();if(c.composed){c.constructed?e|=32:f.putByte(0);for(var g=0;g<c.value.length;++g)void 0!==c.value[g]&&f.putBuffer(b.toDer(c.value[g]))}else if(c.type===b.Type.BMPSTRING)for(var g=0;g<c.value.length;++g)f.putInt16(c.value.charCodeAt(g));else f.putBytes(c.value);if(d.putByte(e),f.length()<=127)d.putByte(127&f.length());else{var h=f.length(),i="";do i+=String.fromCharCode(255&h),h>>>=8;while(h>0);d.putByte(128|i.length);for(var g=i.length-1;g>=0;--g)d.putByte(i.charCodeAt(g))}return d.putBuffer(f),d},b.oidToDer=function(b){var c=b.split("."),d=a.util.createBuffer();d.putByte(40*parseInt(c[0],10)+parseInt(c[1],10));for(var e,f,g,h,i=2;i<c.length;++i){e=!0,f=[],g=parseInt(c[i],10);do h=127&g,g>>>=7,e||(h|=128),f.push(h),e=!1;while(g>0);for(var j=f.length-1;j>=0;--j)d.putByte(f[j])}return d},b.derToOid=function(b){var c;"string"==typeof b&&(b=a.util.createBuffer(b));var d=b.getByte();c=Math.floor(d/40)+"."+d%40;for(var e=0;b.length()>0;)d=b.getByte(),e<<=7,128&d?e+=127&d:(c+="."+(e+d),e=0);return c},b.utcTimeToDate=function(a){var b=new Date,c=parseInt(a.substr(0,2),10);c=c>=50?1900+c:2e3+c;var d=parseInt(a.substr(2,2),10)-1,e=parseInt(a.substr(4,2),10),f=parseInt(a.substr(6,2),10),g=parseInt(a.substr(8,2),10),h=0;if(a.length>11){var i=a.charAt(10),j=10;"+"!==i&&"-"!==i&&(h=parseInt(a.substr(10,2),10),j+=2)}if(b.setUTCFullYear(c,d,e),b.setUTCHours(f,g,h,0),j&&(i=a.charAt(j),"+"===i||"-"===i)){var k=parseInt(a.substr(j+1,2),10),l=parseInt(a.substr(j+4,2),10),m=60*k+l;m*=6e4,b.setTime("+"===i?+b-m:+b+m)}return b},b.generalizedTimeToDate=function(a){var b=new Date,c=parseInt(a.substr(0,4),10),d=parseInt(a.substr(4,2),10)-1,e=parseInt(a.substr(6,2),10),f=parseInt(a.substr(8,2),10),g=parseInt(a.substr(10,2),10),h=parseInt(a.substr(12,2),10),i=0,j=0,k=!1;"Z"===a.charAt(a.length-1)&&(k=!0);var l=a.length-5,m=a.charAt(l);if("+"===m||"-"===m){var n=parseInt(a.substr(l+1,2),10),o=parseInt(a.substr(l+4,2),10);j=60*n+o,j*=6e4,"+"===m&&(j*=-1),k=!0}return"."===a.charAt(14)&&(i=1e3*parseFloat(a.substr(14),10)),k?(b.setUTCFullYear(c,d,e),b.setUTCHours(f,g,h,i),b.setTime(+b+j)):(b.setFullYear(c,d,e),b.setHours(f,g,h,i)),b},b.dateToUtcTime=function(a){var b="",c=[];c.push((""+a.getUTCFullYear()).substr(2)),c.push(""+(a.getUTCMonth()+1)),c.push(""+a.getUTCDate()),c.push(""+a.getUTCHours()),c.push(""+a.getUTCMinutes()),c.push(""+a.getUTCSeconds());for(var d=0;d<c.length;++d)c[d].length<2&&(b+="0"),b+=c[d];return b+="Z"},b.integerToDer=function(b){var c=a.util.createBuffer();if(b>=-128&&128>b)return c.putSignedInt(b,8);if(b>=-32768&&32768>b)return c.putSignedInt(b,16);if(b>=-8388608&&8388608>b)return c.putSignedInt(b,24);if(b>=-2147483648&&2147483648>b)return c.putSignedInt(b,32);throw{message:"Integer too large; max is 32-bits.",integer:b}},b.derToInteger=function(b){"string"==typeof b&&(b=a.util.createBuffer(b));var c=8*b.length();if(c>32)throw{message:"Integer too large; max is 32-bits."};return b.getSignedInt(c)},b.validate=function(c,d,e,f){var g=!1;if(c.tagClass!==d.tagClass&&"undefined"!=typeof d.tagClass||c.type!==d.type&&"undefined"!=typeof d.type)f&&(c.tagClass!==d.tagClass&&f.push("["+d.name+'] Expected tag class "'+d.tagClass+'", got "'+c.tagClass+'"'),c.type!==d.type&&f.push("["+d.name+'] Expected type "'+d.type+'", got "'+c.type+'"'));else if(c.constructed===d.constructed||"undefined"==typeof d.constructed){if(g=!0,d.value&&a.util.isArray(d.value))for(var h=0,i=0;g&&i<d.value.length;++i)g=d.value[i].optional||!1,c.value[h]&&(g=b.validate(c.value[h],d.value[i],e,f),g?++h:d.value[i].optional&&(g=!0)),!g&&f&&f.push("["+d.name+'] Tag class "'+d.tagClass+'", type "'+d.type+'" expected value length "'+d.value.length+'", got "'+c.value.length+'"');g&&e&&(d.capture&&(e[d.capture]=c.value),d.captureAsn1&&(e[d.captureAsn1]=c))}else f&&f.push("["+d.name+'] Expected constructed "'+d.constructed+'", got "'+c.constructed+'"');return g};var d=/[^\\u0000-\\u00ff]/;b.prettyPrint=function(c,e,f){var g="";e=e||0,f=f||2,e>0&&(g+="\n");for(var h="",i=0;e*f>i;++i)h+=" ";switch(g+=h+"Tag: ",c.tagClass){case b.Class.UNIVERSAL:g+="Universal:";break;case b.Class.APPLICATION:g+="Application:";break;case b.Class.CONTEXT_SPECIFIC:g+="Context-Specific:";break;case b.Class.PRIVATE:g+="Private:"}if(c.tagClass===b.Class.UNIVERSAL)switch(g+=c.type,c.type){case b.Type.NONE:g+=" (None)";break;case b.Type.BOOLEAN:g+=" (Boolean)";break;case b.Type.BITSTRING:g+=" (Bit string)";break;case b.Type.INTEGER:g+=" (Integer)";break;case b.Type.OCTETSTRING:g+=" (Octet string)";break;case b.Type.NULL:g+=" (Null)";break;case b.Type.OID:g+=" (Object Identifier)";break;case b.Type.ODESC:g+=" (Object Descriptor)";break;case b.Type.EXTERNAL:g+=" (External or Instance of)";break;case b.Type.REAL:g+=" (Real)";break;case b.Type.ENUMERATED:g+=" (Enumerated)";break;case b.Type.EMBEDDED:g+=" (Embedded PDV)";break;case b.Type.UTF8:g+=" (UTF8)";break;case b.Type.ROID:g+=" (Relative Object Identifier)";break;case b.Type.SEQUENCE:g+=" (Sequence)";break;case b.Type.SET:g+=" (Set)";break;case b.Type.PRINTABLESTRING:g+=" (Printable String)";break;case b.Type.IA5String:g+=" (IA5String (ASCII))";break;case b.Type.UTCTIME:g+=" (UTC time)";break;case b.Type.GENERALIZEDTIME:g+=" (Generalized time)";break;case b.Type.BMPSTRING:g+=" (BMP String)"}else g+=c.type;if(g+="\n",g+=h+"Constructed: "+c.constructed+"\n",c.composed){for(var j=0,k="",i=0;i<c.value.length;++i)void 0!==c.value[i]&&(j+=1,k+=b.prettyPrint(c.value[i],e+1,f),i+1<c.value.length&&(k+=","));g+=h+"Sub values: "+j+k}else{if(g+=h+"Value: ",c.type===b.Type.OID){var l=b.derToOid(c.value);g+=l,a.pki&&a.pki.oids&&l in a.pki.oids&&(g+=" ("+a.pki.oids[l]+")")}if(c.type===b.Type.INTEGER)try{g+=b.derToInteger(c.value)}catch(m){g+="0x"+a.util.bytesToHex(c.value)}else g+=d.test(c.value)?"0x"+a.util.createBuffer(c.value,"utf8").toHex():0===c.value.length?"[null]":c.value}return g}}var c="asn1";if("function"!=typeof e){if("object"!=typeof b||!b.exports)return"undefined"==typeof forge&&(forge={}),a(forge);var f=!0;e=function(a,c){c(d,b)}}var g,h=function(b,d){d.exports=function(d){var e=g.map(function(a){return b(a)}).concat(a);if(d=d||{},d.defined=d.defined||{},d.defined[c])return d[c];d.defined[c]=!0;for(var f=0;f<e.length;++f)e[f](d);return d[c]}},i=e;(e=function(a,b){return g="string"==typeof a?b.slice(2):a.slice(2),f?(delete e,i.apply(null,Array.prototype.slice.call(arguments,0))):(e=i,e.apply(null,Array.prototype.slice.call(arguments,0)))})("js/asn1",["require","module","./util","./oids"],function(){h.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function a(a){var b=a.md5=a.md5||{};a.md=a.md||{},a.md.algorithms=a.md.algorithms||{},a.md.md5=a.md.algorithms.md5=b;var c=null,d=null,e=null,f=null,g=!1,h=function(){c=String.fromCharCode(128),c+=a.util.fillString(String.fromCharCode(0),64),d=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,1,6,11,0,5,10,15,4,9,14,3,8,13,2,7,12,5,8,11,14,1,4,7,10,13,0,3,6,9,12,15,2,0,7,14,5,12,3,10,1,8,15,6,13,4,11,2,9],e=[7,12,17,22,7,12,17,22,7,12,17,22,7,12,17,22,5,9,14,20,5,9,14,20,5,9,14,20,5,9,14,20,4,11,16,23,4,11,16,23,4,11,16,23,4,11,16,23,6,10,15,21,6,10,15,21,6,10,15,21,6,10,15,21],f=new Array(64);for(var b=0;64>b;++b)f[b]=Math.floor(4294967296*Math.abs(Math.sin(b+1)));g=!0},i=function(a,b,c){for(var g,h,i,j,k,l,m,n,o=c.length();o>=64;){for(h=a.h0,i=a.h1,j=a.h2,k=a.h3,n=0;16>n;++n)b[n]=c.getInt32Le(),l=k^i&(j^k),g=h+l+f[n]+b[n],m=e[n],h=k,k=j,j=i,i+=g<<m|g>>>32-m;for(;32>n;++n)l=j^k&(i^j),g=h+l+f[n]+b[d[n]],m=e[n],h=k,k=j,j=i,i+=g<<m|g>>>32-m;for(;48>n;++n)l=i^j^k,g=h+l+f[n]+b[d[n]],m=e[n],h=k,k=j,j=i,i+=g<<m|g>>>32-m;for(;64>n;++n)l=j^(i|~k),g=h+l+f[n]+b[d[n]],m=e[n],h=k,k=j,j=i,i+=g<<m|g>>>32-m;a.h0=a.h0+h&4294967295,a.h1=a.h1+i&4294967295,a.h2=a.h2+j&4294967295,a.h3=a.h3+k&4294967295,o-=64}};b.create=function(){g||h();var b=null,d=a.util.createBuffer(),e=new Array(16),f={algorithm:"md5",blockLength:64,digestLength:16,messageLength:0};return f.start=function(){return f.messageLength=0,d=a.util.createBuffer(),b={h0:1732584193,h1:4023233417,h2:2562383102,h3:271733878},f},f.start(),f.update=function(c,g){return"utf8"===g&&(c=a.util.encodeUtf8(c)),f.messageLength+=c.length,d.putBytes(c),i(b,e,d),(d.read>2048||0===d.length())&&d.compact(),f},f.digest=function(){var g=f.messageLength,h=a.util.createBuffer();h.putBytes(d.bytes()),h.putBytes(c.substr(0,64-(g+8)%64)),h.putInt32Le(g<<3&4294967295),h.putInt32Le(g>>>29&255);var j={h0:b.h0,h1:b.h1,h2:b.h2,h3:b.h3};i(j,e,h);var k=a.util.createBuffer();return k.putInt32Le(j.h0),k.putInt32Le(j.h1),k.putInt32Le(j.h2),k.putInt32Le(j.h3),k},f}}var c="md5";if("function"!=typeof e){if("object"!=typeof b||!b.exports)return"undefined"==typeof forge&&(forge={}),a(forge);var f=!0;e=function(a,c){c(d,b)}}var g,h=function(b,d){d.exports=function(d){var e=g.map(function(a){return b(a)}).concat(a);if(d=d||{},d.defined=d.defined||{},d.defined[c])return d[c];d.defined[c]=!0;for(var f=0;f<e.length;++f)e[f](d);return d[c]}},i=e;(e=function(a,b){return g="string"==typeof a?b.slice(2):a.slice(2),f?(delete e,i.apply(null,Array.prototype.slice.call(arguments,0))):(e=i,e.apply(null,Array.prototype.slice.call(arguments,0)))})("js/md5",["require","module","./util"],function(){h.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function a(a){var b=a.sha1=a.sha1||{};a.md=a.md||{},a.md.algorithms=a.md.algorithms||{},a.md.sha1=a.md.algorithms.sha1=b;var c=null,d=!1,e=function(){c=String.fromCharCode(128),c+=a.util.fillString(String.fromCharCode(0),64),d=!0},f=function(a,b,c){for(var d,e,f,g,h,i,j,k,l=c.length();l>=64;){for(e=a.h0,f=a.h1,g=a.h2,h=a.h3,i=a.h4,k=0;16>k;++k)d=c.getInt32(),b[k]=d,j=h^f&(g^h),d=(e<<5|e>>>27)+j+i+1518500249+d,i=h,h=g,g=f<<30|f>>>2,f=e,e=d;for(;20>k;++k)d=b[k-3]^b[k-8]^b[k-14]^b[k-16],d=d<<1|d>>>31,b[k]=d,j=h^f&(g^h),d=(e<<5|e>>>27)+j+i+1518500249+d,i=h,h=g,g=f<<30|f>>>2,f=e,e=d;for(;32>k;++k)d=b[k-3]^b[k-8]^b[k-14]^b[k-16],d=d<<1|d>>>31,b[k]=d,j=f^g^h,d=(e<<5|e>>>27)+j+i+1859775393+d,i=h,h=g,g=f<<30|f>>>2,f=e,e=d;for(;40>k;++k)d=b[k-6]^b[k-16]^b[k-28]^b[k-32],d=d<<2|d>>>30,b[k]=d,j=f^g^h,d=(e<<5|e>>>27)+j+i+1859775393+d,i=h,h=g,g=f<<30|f>>>2,f=e,e=d;for(;60>k;++k)d=b[k-6]^b[k-16]^b[k-28]^b[k-32],d=d<<2|d>>>30,b[k]=d,j=f&g|h&(f^g),d=(e<<5|e>>>27)+j+i+2400959708+d,i=h,h=g,g=f<<30|f>>>2,f=e,e=d;for(;80>k;++k)d=b[k-6]^b[k-16]^b[k-28]^b[k-32],d=d<<2|d>>>30,b[k]=d,j=f^g^h,d=(e<<5|e>>>27)+j+i+3395469782+d,i=h,h=g,g=f<<30|f>>>2,f=e,e=d;a.h0+=e,a.h1+=f,a.h2+=g,a.h3+=h,a.h4+=i,l-=64}};b.create=function(){d||e();var b=null,g=a.util.createBuffer(),h=new Array(80),i={algorithm:"sha1",blockLength:64,digestLength:20,messageLength:0};return i.start=function(){return i.messageLength=0,g=a.util.createBuffer(),b={h0:1732584193,h1:4023233417,h2:2562383102,h3:271733878,h4:3285377520},i},i.start(),i.update=function(c,d){return"utf8"===d&&(c=a.util.encodeUtf8(c)),i.messageLength+=c.length,g.putBytes(c),f(b,h,g),(g.read>2048||0===g.length())&&g.compact(),i},i.digest=function(){var d=i.messageLength,e=a.util.createBuffer();e.putBytes(g.bytes()),e.putBytes(c.substr(0,64-(d+8)%64)),e.putInt32(d>>>29&255),e.putInt32(d<<3&4294967295);var j={h0:b.h0,h1:b.h1,h2:b.h2,h3:b.h3,h4:b.h4};f(j,h,e);var k=a.util.createBuffer();return k.putInt32(j.h0),k.putInt32(j.h1),k.putInt32(j.h2),k.putInt32(j.h3),k.putInt32(j.h4),k},i}}var c="sha1";if("function"!=typeof e){if("object"!=typeof b||!b.exports)return"undefined"==typeof forge&&(forge={}),a(forge);var f=!0;e=function(a,c){c(d,b)}}var g,h=function(b,d){d.exports=function(d){var e=g.map(function(a){return b(a)}).concat(a);if(d=d||{},d.defined=d.defined||{},d.defined[c])return d[c];d.defined[c]=!0;for(var f=0;f<e.length;++f)e[f](d);return d[c]}},i=e;(e=function(a,b){return g="string"==typeof a?b.slice(2):a.slice(2),f?(delete e,i.apply(null,Array.prototype.slice.call(arguments,0))):(e=i,e.apply(null,Array.prototype.slice.call(arguments,0)))})("js/sha1",["require","module","./util"],function(){h.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function a(a){var b=a.sha256=a.sha256||{};a.md=a.md||{},a.md.algorithms=a.md.algorithms||{},a.md.sha256=a.md.algorithms.sha256=b;var c=null,d=!1,e=null,f=function(){c=String.fromCharCode(128),c+=a.util.fillString(String.fromCharCode(0),64),e=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],d=!0},g=function(a,b,c){for(var d,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t=c.length();t>=64;){for(k=0;16>k;++k)b[k]=c.getInt32();for(;64>k;++k)d=b[k-2],d=(d>>>17|d<<15)^(d>>>19|d<<13)^d>>>10,f=b[k-15],f=(f>>>7|f<<25)^(f>>>18|f<<14)^f>>>3,b[k]=d+b[k-7]+f+b[k-16]&4294967295;for(l=a.h0,m=a.h1,n=a.h2,o=a.h3,p=a.h4,q=a.h5,r=a.h6,s=a.h7,k=0;64>k;++k)h=(p>>>6|p<<26)^(p>>>11|p<<21)^(p>>>25|p<<7),i=r^p&(q^r),g=(l>>>2|l<<30)^(l>>>13|l<<19)^(l>>>22|l<<10),j=l&m|n&(l^m),d=s+h+i+e[k]+b[k],f=g+j,s=r,r=q,q=p,p=o+d&4294967295,o=n,n=m,m=l,l=d+f&4294967295;a.h0=a.h0+l&4294967295,a.h1=a.h1+m&4294967295,a.h2=a.h2+n&4294967295,a.h3=a.h3+o&4294967295,a.h4=a.h4+p&4294967295,a.h5=a.h5+q&4294967295,a.h6=a.h6+r&4294967295,a.h7=a.h7+s&4294967295,t-=64}};b.create=function(){d||f();var b=null,e=a.util.createBuffer(),h=new Array(64),i={algorithm:"sha256",blockLength:64,digestLength:32,messageLength:0};return i.start=function(){return i.messageLength=0,e=a.util.createBuffer(),b={h0:1779033703,h1:3144134277,h2:1013904242,h3:2773480762,h4:1359893119,h5:2600822924,h6:528734635,h7:1541459225},i},i.start(),i.update=function(c,d){return"utf8"===d&&(c=a.util.encodeUtf8(c)),i.messageLength+=c.length,e.putBytes(c),g(b,h,e),(e.read>2048||0===e.length())&&e.compact(),i},i.digest=function(){var d=i.messageLength,f=a.util.createBuffer();f.putBytes(e.bytes()),f.putBytes(c.substr(0,64-(d+8)%64)),f.putInt32(d>>>29&255),f.putInt32(d<<3&4294967295);var j={h0:b.h0,h1:b.h1,h2:b.h2,h3:b.h3,h4:b.h4,h5:b.h5,h6:b.h6,h7:b.h7};g(j,h,f);var k=a.util.createBuffer();return k.putInt32(j.h0),k.putInt32(j.h1),k.putInt32(j.h2),k.putInt32(j.h3),k.putInt32(j.h4),k.putInt32(j.h5),k.putInt32(j.h6),k.putInt32(j.h7),k},i}}var c="sha256";if("function"!=typeof e){if("object"!=typeof b||!b.exports)return"undefined"==typeof forge&&(forge={}),a(forge);var f=!0;e=function(a,c){c(d,b)}}var g,h=function(b,d){d.exports=function(d){var e=g.map(function(a){return b(a)}).concat(a);if(d=d||{},d.defined=d.defined||{},d.defined[c])return d[c];d.defined[c]=!0;for(var f=0;f<e.length;++f)e[f](d);return d[c]}},i=e;(e=function(a,b){return g="string"==typeof a?b.slice(2):a.slice(2),f?(delete e,i.apply(null,Array.prototype.slice.call(arguments,0))):(e=i,e.apply(null,Array.prototype.slice.call(arguments,0)))})("js/sha256",["require","module","./util"],function(){h.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function a(a){a.md=a.md||{},a.md.algorithms={md5:a.md5,sha1:a.sha1,sha256:a.sha256},a.md.md5=a.md5,a.md.sha1=a.sha1,a.md.sha256=a.sha256}var c="md";if("function"!=typeof e){if("object"!=typeof b||!b.exports)return"undefined"==typeof forge&&(forge={}),a(forge);var f=!0;e=function(a,c){c(d,b)}}var g,h=function(b,d){d.exports=function(d){var e=g.map(function(a){return b(a)}).concat(a);if(d=d||{},d.defined=d.defined||{},d.defined[c])return d[c];d.defined[c]=!0;for(var f=0;f<e.length;++f)e[f](d);return d[c]}},i=e;(e=function(a,b){return g="string"==typeof a?b.slice(2):a.slice(2),f?(delete e,i.apply(null,Array.prototype.slice.call(arguments,0))):(e=i,e.apply(null,Array.prototype.slice.call(arguments,0)))})("js/md",["require","module","./md5","./sha1","./sha256"],function(){h.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function a(a){var b=a.hmac=a.hmac||{};b.create=function(){var b=null,c=null,d=null,e=null,f={};return f.start=function(f,g){if(null!==f)if("string"==typeof f){if(f=f.toLowerCase(),!(f in a.md.algorithms))throw'Unknown hash algorithm "'+f+'"';c=a.md.algorithms[f].create()}else c=f;if(null===g)g=b;else{if("string"==typeof g)g=a.util.createBuffer(g);else if(a.util.isArray(g)){var h=g;g=a.util.createBuffer();for(var i=0;i<h.length;++i)g.putByte(h[i])}var j=g.length();j>c.blockLength&&(c.start(),c.update(g.bytes()),g=c.digest()),d=a.util.createBuffer(),e=a.util.createBuffer(),j=g.length();for(var i=0;j>i;++i){var h=g.at(i);d.putByte(54^h),e.putByte(92^h)}if(j<c.blockLength)for(var h=c.blockLength-j,i=0;h>i;++i)d.putByte(54),e.putByte(92);b=g,d=d.bytes(),e=e.bytes()}c.start(),c.update(d)},f.update=function(a){c.update(a)},f.getMac=function(){var a=c.digest().bytes();return c.start(),c.update(e),c.update(a),c.digest()},f.digest=f.getMac,f}}var c="hmac";if("function"!=typeof e){if("object"!=typeof b||!b.exports)return"undefined"==typeof forge&&(forge={}),a(forge);var f=!0;e=function(a,c){c(d,b)}}var g,h=function(b,d){d.exports=function(d){var e=g.map(function(a){return b(a)}).concat(a);if(d=d||{},d.defined=d.defined||{},d.defined[c])return d[c];d.defined[c]=!0;for(var f=0;f<e.length;++f)e[f](d);return d[c]}},i=e;(e=function(a,b){return g="string"==typeof a?b.slice(2):a.slice(2),f?(delete e,i.apply(null,Array.prototype.slice.call(arguments,0))):(e=i,e.apply(null,Array.prototype.slice.call(arguments,0)))})("js/hmac",["require","module","./md","./util"],function(){h.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function a(a){function b(a){for(var b=a.name+": ",c=[],d=0;d<a.values.length;++d)c.push(a.values[d].replace(/^(\S+\r\n)/,function(a,b){return" "+b}));b+=c.join(",")+"\r\n";for(var e=0,f=-1,d=0;d<b.length;++d,++e)if(e>65&&-1!==f){var g=b[f];","===g?(++f,b=b.substr(0,f)+"\r\n "+b.substr(f)):b=b.substr(0,f)+"\r\n"+g+b.substr(f+1),e=d-f-1,f=-1,++d}else(" "===b[d]||"	"===b[d]||","===b[d])&&(f=d);return b}function c(a){return a.replace(/^\s+/,"")}var d=a.pem=a.pem||{};d.encode=function(c,d){d=d||{};var e,f="-----BEGIN "+c.type+"-----\r\n";if(c.procType&&(e={name:"Proc-Type",values:[String(c.procType.version),c.procType.type]},f+=b(e)),c.contentDomain&&(e={name:"Content-Domain",values:[c.contentDomain]},f+=b(e)),c.dekInfo&&(e={name:"DEK-Info",values:[c.dekInfo.algorithm]},c.dekInfo.parameters&&e.values.push(c.dekInfo.parameters),f+=b(e)),c.headers)for(var g=0;g<c.headers.length;++g)f+=b(c.headers[g]);return c.procType&&(f+="\r\n"),f+=a.util.encode64(c.body,d.maxline||64)+"\r\n",f+="-----END "+c.type+"-----\r\n"},d.decode=function(b){for(var d,e=[],f=/\s*-----BEGIN ([A-Z0-9- ]+)-----\r?\n?([\x21-\x7e\s]+?(?:\r?\n\r?\n))?([:A-Za-z0-9+\/=\s]+?)-----END \1-----/g,g=/([\x21-\x7e]+):\s*([\x21-\x7e\s^:]+)/,h=/\r?\n/;d=f.exec(b),d;){var i={type:d[1],procType:null,contentDomain:null,dekInfo:null,headers:[],body:a.util.decode64(d[3])};if(e.push(i),d[2]){for(var j=d[2].split(h),k=0;d&&k<j.length;){for(var l=j[k].replace(/\s+$/,""),m=k+1;m<j.length;++m){var n=j[m];if(!/\s/.test(n[0]))break;l+=n,k=m}if(d=l.match(g)){for(var o={name:d[1],values:[]},p=d[2].split(","),q=0;q<p.length;++q)o.values.push(c(p[q]));if(i.procType)if(i.contentDomain||"Content-Domain"!==o.name)if(i.dekInfo||"DEK-Info"!==o.name)i.headers.push(o);else{if(0===o.values.length)throw{message:'Invalid PEM formatted message. The "DEK-Info" header must have at least one subfield.'};i.dekInfo={algorithm:p[0],parameters:p[1]||null}}else i.contentDomain=p[0]||"";else{if("Proc-Type"!==o.name)throw{message:'Invalid PEM formatted message. The first encapsulated header must be "Proc-Type".'};if(2!==o.values.length)throw{message:'Invalid PEM formatted message. The "Proc-Type" header must have two subfields.'};i.procType={version:p[0],type:p[1]}}}++k}if("ENCRYPTED"===i.procType&&!i.dekInfo)throw{message:'Invalid PEM formatted message. The "DEK-Info" header must be present if "Proc-Type" is "ENCRYPTED".'}}}if(0===e.length)throw{message:"Invalid PEM formatted message."};return e}}var c="pem";if("function"!=typeof e){if("object"!=typeof b||!b.exports)return"undefined"==typeof forge&&(forge={}),a(forge);var f=!0;e=function(a,c){c(d,b)}}var g,h=function(b,d){d.exports=function(d){var e=g.map(function(a){return b(a)}).concat(a);if(d=d||{},d.defined=d.defined||{},d.defined[c])return d[c];d.defined[c]=!0;for(var f=0;f<e.length;++f)e[f](d);return d[c]}},i=e;(e=function(a,b){return g="string"==typeof a?b.slice(2):a.slice(2),f?(delete e,i.apply(null,Array.prototype.slice.call(arguments,0))):(e=i,e.apply(null,Array.prototype.slice.call(arguments,0)))})("js/pem",["require","module","./util"],function(){h.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function a(a){function b(a){for(var b,c=[0,4,536870912,536870916,65536,65540,536936448,536936452,512,516,536871424,536871428,66048,66052,536936960,536936964],d=[0,1,1048576,1048577,67108864,67108865,68157440,68157441,256,257,1048832,1048833,67109120,67109121,68157696,68157697],e=[0,8,2048,2056,16777216,16777224,16779264,16779272,0,8,2048,2056,16777216,16777224,16779264,16779272],f=[0,2097152,134217728,136314880,8192,2105344,134225920,136323072,131072,2228224,134348800,136445952,139264,2236416,134356992,136454144],g=[0,262144,16,262160,0,262144,16,262160,4096,266240,4112,266256,4096,266240,4112,266256],h=[0,1024,32,1056,0,1024,32,1056,33554432,33555456,33554464,33555488,33554432,33555456,33554464,33555488],i=[0,268435456,524288,268959744,2,268435458,524290,268959746,0,268435456,524288,268959744,2,268435458,524290,268959746],j=[0,65536,2048,67584,536870912,536936448,536872960,536938496,131072,196608,133120,198656,537001984,537067520,537004032,537069568],k=[0,262144,0,262144,2,262146,2,262146,33554432,33816576,33554432,33816576,33554434,33816578,33554434,33816578],l=[0,268435456,8,268435464,0,268435456,8,268435464,1024,268436480,1032,268436488,1024,268436480,1032,268436488],m=[0,32,0,32,1048576,1048608,1048576,1048608,8192,8224,8192,8224,1056768,1056800,1056768,1056800],n=[0,16777216,512,16777728,2097152,18874368,2097664,18874880,67108864,83886080,67109376,83886592,69206016,85983232,69206528,85983744],o=[0,4096,134217728,134221824,524288,528384,134742016,134746112,16,4112,134217744,134221840,524304,528400,134742032,134746128],p=[0,4,256,260,0,4,256,260,1,5,257,261,1,5,257,261],q=a.length()>8?3:1,r=[],s=[0,0,1,1,1,1,1,1,0,1,1,1,1,1,1,0],t=0,u=0;q>u;u++){var v=a.getInt32(),w=a.getInt32();b=252645135&(v>>>4^w),w^=b,v^=b<<4,b=65535&(w>>>-16^v),v^=b,w^=b<<-16,b=858993459&(v>>>2^w),w^=b,v^=b<<2,b=65535&(w>>>-16^v),v^=b,w^=b<<-16,b=1431655765&(v>>>1^w),w^=b,v^=b<<1,b=16711935&(w>>>8^v),v^=b,w^=b<<8,b=1431655765&(v>>>1^w),w^=b,v^=b<<1,b=v<<8|w>>>20&240,v=w<<24|w<<8&16711680|w>>>8&65280|w>>>24&240,w=b;for(var x=0;x<s.length;x++){s[x]?(v=v<<2|v>>>26,w=w<<2|w>>>26):(v=v<<1|v>>>27,w=w<<1|w>>>27),v&=-15,w&=-15;var y=c[v>>>28]|d[v>>>24&15]|e[v>>>20&15]|f[v>>>16&15]|g[v>>>12&15]|h[v>>>8&15]|i[v>>>4&15],z=j[w>>>28]|k[w>>>24&15]|l[w>>>20&15]|m[w>>>16&15]|n[w>>>12&15]|o[w>>>8&15]|p[w>>>4&15];b=65535&(z>>>16^y),r[t++]=y^b,r[t++]=z^b<<16}}return r}var c=[16843776,0,65536,16843780,16842756,66564,4,65536,1024,16843776,16843780,1024,16778244,16842756,16777216,4,1028,16778240,16778240,66560,66560,16842752,16842752,16778244,65540,16777220,16777220,65540,0,1028,66564,16777216,65536,16843780,4,16842752,16843776,16777216,16777216,1024,16842756,65536,66560,16777220,1024,4,16778244,66564,16843780,65540,16842752,16778244,16777220,1028,66564,16843776,1028,16778240,16778240,0,65540,66560,0,16842756],d=[-2146402272,-2147450880,32768,1081376,1048576,32,-2146435040,-2147450848,-2147483616,-2146402272,-2146402304,-2147483648,-2147450880,1048576,32,-2146435040,1081344,1048608,-2147450848,0,-2147483648,32768,1081376,-2146435072,1048608,-2147483616,0,1081344,32800,-2146402304,-2146435072,32800,0,1081376,-2146435040,1048576,-2147450848,-2146435072,-2146402304,32768,-2146435072,-2147450880,32,-2146402272,1081376,32,32768,-2147483648,32800,-2146402304,1048576,-2147483616,1048608,-2147450848,-2147483616,1048608,1081344,0,-2147450880,32800,-2147483648,-2146435040,-2146402272,1081344],e=[520,134349312,0,134348808,134218240,0,131592,134218240,131080,134217736,134217736,131072,134349320,131080,134348800,520,134217728,8,134349312,512,131584,134348800,134348808,131592,134218248,131584,131072,134218248,8,134349320,512,134217728,134349312,134217728,131080,520,131072,134349312,134218240,0,512,131080,134349320,134218240,134217736,512,0,134348808,134218248,131072,134217728,134349320,8,131592,131584,134217736,134348800,134218248,520,134348800,131592,8,134348808,131584],f=[8396801,8321,8321,128,8396928,8388737,8388609,8193,0,8396800,8396800,8396929,129,0,8388736,8388609,1,8192,8388608,8396801,128,8388608,8193,8320,8388737,1,8320,8388736,8192,8396928,8396929,129,8388736,8388609,8396800,8396929,129,0,0,8396800,8320,8388736,8388737,1,8396801,8321,8321,128,8396929,129,1,8192,8388609,8193,8396928,8388737,8193,8320,8388608,8396801,128,8388608,8192,8396928],g=[256,34078976,34078720,1107296512,524288,256,1073741824,34078720,1074266368,524288,33554688,1074266368,1107296512,1107820544,524544,1073741824,33554432,1074266112,1074266112,0,1073742080,1107820800,1107820800,33554688,1107820544,1073742080,0,1107296256,34078976,33554432,1107296256,524544,524288,1107296512,256,33554432,1073741824,34078720,1107296512,1074266368,33554688,1073741824,1107820544,34078976,1074266368,256,33554432,1107820544,1107820800,524544,1107296256,1107820800,34078720,0,1074266112,1107296256,524544,33554688,1073742080,524288,0,1074266112,34078976,1073742080],h=[536870928,541065216,16384,541081616,541065216,16,541081616,4194304,536887296,4210704,4194304,536870928,4194320,536887296,536870912,16400,0,4194320,536887312,16384,4210688,536887312,16,541065232,541065232,0,4210704,541081600,16400,4210688,541081600,536870912,536887296,16,541065232,4210688,541081616,4194304,16400,536870928,4194304,536887296,536870912,16400,536870928,541081616,4210688,541065216,4210704,541081600,0,541065232,16,16384,541065216,4210704,16384,4194320,536887312,0,541081600,536870912,4194320,536887312],i=[2097152,69206018,67110914,0,2048,67110914,2099202,69208064,69208066,2097152,0,67108866,2,67108864,69206018,2050,67110912,2099202,2097154,67110912,67108866,69206016,69208064,2097154,69206016,2048,2050,69208066,2099200,2,67108864,2099200,67108864,2099200,2097152,67110914,67110914,69206018,69206018,2,2097154,67108864,67110912,2097152,69208064,2050,2099202,69208064,2050,67108866,69208066,69206016,2099200,0,2,69208066,0,2099202,69206016,2048,67108866,67110912,2048,2097154],j=[268439616,4096,262144,268701760,268435456,268439616,64,268435456,262208,268697600,268701760,266240,268701696,266304,4096,64,268697600,268435520,268439552,4160,266240,262208,268697664,268701696,4160,0,0,268697664,268435520,268439552,266304,262144,266304,262144,268701696,4096,64,268697664,4096,266304,268439552,64,268435520,268697600,268697664,268435456,262144,268439616,0,268701760,262208,268435520,268697600,268439552,268439616,0,268701760,266240,266240,4160,4160,262208,268435456,268701696],k=function(k,l){"string"==typeof k&&(8===k.length||24===k.length)&&(k=a.util.createBuffer(k));var m,n=b(k),o=1,p=0,q=0,r=0,s=0,t=!1,u=null,v=null,w=32===n.length?3:9;m=3===w?l?[0,32,2]:[30,-2,-2]:l?[0,32,2,62,30,-2,64,96,2]:[94,62,-2,32,64,2,30,-2,-2];var x=null;return x={start:function(b,c){b?("string"==typeof b&&8===b.length&&(b=a.util.createBuffer(b)),o=1,p=b.getInt32(),r=b.getInt32()):o=0,t=!1,u=a.util.createBuffer(),v=c||a.util.createBuffer(),x.output=v},update:function(a){for(t||u.putBuffer(a);u.length()>=8;){var b,k=u.getInt32(),x=u.getInt32();1===o&&(l?(k^=p,x^=r):(q=p,s=r,p=k,r=x)),b=252645135&(k>>>4^x),x^=b,k^=b<<4,b=65535&(k>>>16^x),x^=b,k^=b<<16,b=858993459&(x>>>2^k),k^=b,x^=b<<2,b=16711935&(x>>>8^k),k^=b,x^=b<<8,b=1431655765&(k>>>1^x),x^=b,k^=b<<1,k=k<<1|k>>>31,x=x<<1|x>>>31;for(var y=0;w>y;y+=3){for(var z=m[y+1],A=m[y+2],B=m[y];B!=z;B+=A){var C=x^n[B],D=(x>>>4|x<<28)^n[B+1];b=k,k=x,x=b^(d[C>>>24&63]|f[C>>>16&63]|h[C>>>8&63]|j[63&C]|c[D>>>24&63]|e[D>>>16&63]|g[D>>>8&63]|i[63&D])}b=k,k=x,x=b}k=k>>>1|k<<31,x=x>>>1|x<<31,b=1431655765&(k>>>1^x),x^=b,k^=b<<1,b=16711935&(x>>>8^k),k^=b,x^=b<<8,b=858993459&(x>>>2^k),k^=b,x^=b<<2,b=65535&(k>>>16^x),x^=b,k^=b<<16,b=252645135&(k>>>4^x),x^=b,k^=b<<4,1===o&&(l?(p=k,r=x):(k^=q,x^=s)),v.putInt32(k),v.putInt32(x)}},finish:function(a){var b=!0;if(l)if(a)b=a(8,u,!l);else{var c=8===u.length()?8:8-u.length();u.fillWithByte(c,c)}if(b&&(t=!0,x.update()),!l&&(b=0===u.length()))if(a)b=a(8,v,!l);else{var d=v.length(),e=v.at(d-1);e>d?b=!1:v.truncate(e)}return b}}};a.des=a.des||{},a.des.startEncrypting=function(a,b,c){var d=k(a,!0);return d.start(b,c),d},a.des.createEncryptionCipher=function(a){return k(a,!0)},a.des.startDecrypting=function(a,b,c){var d=k(a,!1);return d.start(b,c),d},a.des.createDecryptionCipher=function(a){return k(a,!1)}}var c="des";if("function"!=typeof e){if("object"!=typeof b||!b.exports)return"undefined"==typeof forge&&(forge={}),a(forge);var f=!0;e=function(a,c){c(d,b)}}var g,h=function(b,d){d.exports=function(d){var e=g.map(function(a){return b(a)}).concat(a);if(d=d||{},d.defined=d.defined||{},d.defined[c])return d[c];d.defined[c]=!0;for(var f=0;f<e.length;++f)e[f](d);return d[c]}},i=e;(e=function(a,b){return g="string"==typeof a?b.slice(2):a.slice(2),f?(delete e,i.apply(null,Array.prototype.slice.call(arguments,0))):(e=i,e.apply(null,Array.prototype.slice.call(arguments,0)))
})("js/des",["require","module","./util"],function(){h.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function a(a){var b=a.pkcs5=a.pkcs5||{};a.pbkdf2=b.pbkdf2=function(b,c,d,e,f){("undefined"==typeof f||null===f)&&(f=a.md.sha1.create());var g=f.digestLength;if(e>4294967295*g)throw{message:"Derived key is too long."};var h=Math.ceil(e/g),i=e-(h-1)*g,j=a.hmac.create();j.start(f,b);for(var k,l,m,n="",o=1;h>=o;++o){j.start(null,null),j.update(c),j.update(a.util.int32ToBytes(o)),k=m=j.digest().getBytes();for(var p=2;d>=p;++p)j.start(null,null),j.update(m),l=j.digest().getBytes(),k=a.util.xorBytes(k,l,g),m=l;n+=h>o?k:k.substr(0,i)}return n}}var c="pbkdf2";if("function"!=typeof e){if("object"!=typeof b||!b.exports)return"undefined"==typeof forge&&(forge={}),a(forge);var f=!0;e=function(a,c){c(d,b)}}var g,h=function(b,d){d.exports=function(d){var e=g.map(function(a){return b(a)}).concat(a);if(d=d||{},d.defined=d.defined||{},d.defined[c])return d[c];d.defined[c]=!0;for(var f=0;f<e.length;++f)e[f](d);return d[c]}},i=e;(e=function(a,b){return g="string"==typeof a?b.slice(2):a.slice(2),f?(delete e,i.apply(null,Array.prototype.slice.call(arguments,0))):(e=i,e.apply(null,Array.prototype.slice.call(arguments,0)))})("js/pbkdf2",["require","module","./hmac","./md","./util"],function(){h.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function c(b){var c="undefined"!=typeof a&&a.versions&&a.versions.node,e=null;!b.disableNativeCode&&c&&(e=d("crypto"));var f=b.prng=b.prng||{};f.create=function(a){function c(a){if(h.pools[0].messageLength>=32)return f(),a();var b=32-h.pools[0].messageLength<<5;h.seedFile(b,function(b,c){return b?a(b):(h.collect(c),f(),a(),void 0)})}function d(){if(h.pools[0].messageLength>=32)return f();var a=32-h.pools[0].messageLength<<5;h.collect(h.seedFileSync(a)),f()}function f(){var a=b.md.sha1.create();a.update(h.pools[0].digest().getBytes()),h.pools[0].start();for(var c=1,d=1;32>d;++d)c=31===c?2147483648:c<<2,c%h.reseeds===0&&(a.update(h.pools[d].digest().getBytes()),h.pools[d].start());var e=a.digest().getBytes();a.start(),a.update(e);var f=a.digest().getBytes();h.key=h.plugin.formatKey(e),h.seed=h.plugin.formatSeed(f),++h.reseeds,h.generated=0,h.time=+new Date}function g(a){var c=null;if("undefined"!=typeof window){var d=window.crypto||window.msCrypto;d&&d.getRandomValues&&(c=function(a){return d.getRandomValues(a)})}var e=b.util.createBuffer();if(c)for(;e.length()<a;){var f=Math.max(1,Math.min(a-e.length(),65536)/4),g=new Uint32Array(Math.floor(f));try{c(g);for(var h=0;h<g.length;++h)e.putInt32(g[h])}catch(i){if(!("undefined"!=typeof QuotaExceededError&&i instanceof QuotaExceededError))throw i}}if(e.length()<a)for(var j,k,l,m=Math.floor(65536*Math.random());e.length()<a;){k=16807*(65535&m),j=16807*(m>>16),k+=(32767&j)<<16,k+=j>>15,k=(2147483647&k)+(k>>31),m=4294967295&k;for(var h=0;3>h;++h)l=m>>>(h<<3),l^=Math.floor(256*Math.random()),e.putByte(String.fromCharCode(255&l))}return e.getBytes(a)}for(var h={plugin:a,key:null,seed:null,time:null,reseeds:0,generated:0},i=a.md,j=new Array(32),k=0;32>k;++k)j[k]=i.create();return h.pools=j,h.pool=0,h.generate=function(a,d){function e(l){if(l)return d(l);if(k.length()>=a)return d(null,k.getBytes(a));if(h.generated>=1048576){var m=+new Date;(null===h.time||m-h.time>100)&&(h.key=null)}if(null===h.key)return c(e);var n=f(h.key,h.seed);h.generated+=n.length,k.putBytes(n),h.key=i(f(h.key,g(h.seed))),h.seed=j(f(h.key,h.seed)),b.util.setImmediate(e)}if(!d)return h.generateSync(a);var f=h.plugin.cipher,g=h.plugin.increment,i=h.plugin.formatKey,j=h.plugin.formatSeed,k=b.util.createBuffer();e()},h.generateSync=function(a){for(var c=h.plugin.cipher,e=h.plugin.increment,f=h.plugin.formatKey,g=h.plugin.formatSeed,i=b.util.createBuffer();i.length()<a;){if(h.generated>=1048576){var j=+new Date;(null===h.time||j-h.time>100)&&(h.key=null)}null===h.key&&d();var k=c(h.key,h.seed);h.generated+=k.length,i.putBytes(k),h.key=f(c(h.key,e(h.seed))),h.seed=g(c(h.key,h.seed))}return i.getBytes(a)},e?(h.seedFile=function(a,b){e.randomBytes(a,function(a,c){return a?b(a):void b(null,c.toString())})},h.seedFileSync=function(a){return e.randomBytes(a).toString()}):(h.seedFile=function(a,b){try{b(null,g(a))}catch(c){b(c)}},h.seedFileSync=g),h.collect=function(a){for(var b=a.length,c=0;b>c;++c)h.pools[h.pool].update(a.substr(c,1)),h.pool=31===h.pool?0:h.pool+1},h.collectInt=function(a,b){for(var c="",d=0;b>d;d+=8)c+=String.fromCharCode(a>>d&255);h.collect(c)},h.registerWorker=function(a){function b(b){var c=b.data;c.forge&&c.forge.prng&&h.seedFile(c.forge.prng.needed,function(b,c){a.postMessage({forge:{prng:{err:b,bytes:c}}})})}a===self?h.seedFile=function(a,b){function c(a){var d=a.data;d.forge&&d.forge.prng&&(self.removeEventListener("message",c),b(d.forge.prng.err,d.forge.prng.bytes))}self.addEventListener("message",c),self.postMessage({forge:{prng:{needed:a}}})}:a.addEventListener("message",b)},h}}var f="prng";if("function"!=typeof e){if("object"!=typeof b||!b.exports)return"undefined"==typeof forge&&(forge={}),c(forge);var g=!0;e=function(a,c){c(d,b)}}var h,i=function(a,b){b.exports=function(b){var d=h.map(function(b){return a(b)}).concat(c);if(b=b||{},b.defined=b.defined||{},b.defined[f])return b[f];b.defined[f]=!0;for(var e=0;e<d.length;++e)d[e](b);return b[f]}},j=e;(e=function(a,b){return h="string"==typeof a?b.slice(2):a.slice(2),g?(delete e,j.apply(null,Array.prototype.slice.call(arguments,0))):(e=j,e.apply(null,Array.prototype.slice.call(arguments,0)))})("js/prng",["require","module","./md","./util"],function(){i.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function c(b){b.random&&b.random.getBytes||!function(c){var d={},e=new Array(4),f=b.util.createBuffer();d.formatKey=function(a){var c=b.util.createBuffer(a);return a=new Array(4),a[0]=c.getInt32(),a[1]=c.getInt32(),a[2]=c.getInt32(),a[3]=c.getInt32(),b.aes._expandKey(a,!1)},d.formatSeed=function(a){var c=b.util.createBuffer(a);return a=new Array(4),a[0]=c.getInt32(),a[1]=c.getInt32(),a[2]=c.getInt32(),a[3]=c.getInt32(),a},d.cipher=function(a,c){return b.aes._updateBlock(a,c,e,!1),f.putInt32(e[0]),f.putInt32(e[1]),f.putInt32(e[2]),f.putInt32(e[3]),f.getBytes()},d.increment=function(a){return++a[3],a},d.md=b.md.sha1;var g=b.prng.create(d),h="undefined"!=typeof a&&a.versions&&a.versions.node,i=null;if("undefined"!=typeof window){var j=window.crypto||window.msCrypto;j&&j.getRandomValues&&(i=function(a){return j.getRandomValues(a)})}if(b.disableNativeCode||!h&&!i){if("undefined"==typeof window||void 0===window.document,g.collectInt(+new Date,32),"undefined"!=typeof navigator){var k="";for(var l in navigator)try{"string"==typeof navigator[l]&&(k+=navigator[l])}catch(m){}g.collect(k),k=null}c&&(c().mousemove(function(a){g.collectInt(a.clientX,16),g.collectInt(a.clientY,16)}),c().keypress(function(a){g.collectInt(a.charCode,8)}))}if(b.random)for(var l in g)b.random[l]=g[l];else b.random=g;b.random.getBytes=function(a,c){return b.random.generate(a,c)},b.random.getBytesSync=function(a){return b.random.generate(a)}}("undefined"!=typeof jQuery?jQuery:null)}var f="random";if("function"!=typeof e){if("object"!=typeof b||!b.exports)return"undefined"==typeof forge&&(forge={}),c(forge);var g=!0;e=function(a,c){c(d,b)}}var h,i=function(a,b){b.exports=function(b){var d=h.map(function(b){return a(b)}).concat(c);if(b=b||{},b.defined=b.defined||{},b.defined[f])return b[f];b.defined[f]=!0;for(var e=0;e<d.length;++e)d[e](b);return b[f]}},j=e;(e=function(a,b){return h="string"==typeof a?b.slice(2):a.slice(2),g?(delete e,j.apply(null,Array.prototype.slice.call(arguments,0))):(e=j,e.apply(null,Array.prototype.slice.call(arguments,0)))})("js/random",["require","module","./aes","./md","./prng","./util"],function(){i.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function a(a){var b=[217,120,249,196,25,221,181,237,40,233,253,121,74,160,216,157,198,126,55,131,43,118,83,142,98,76,100,136,68,139,251,162,23,154,89,245,135,179,79,19,97,69,109,141,9,129,125,50,189,143,64,235,134,183,123,11,240,149,33,34,92,107,78,130,84,214,101,147,206,96,178,28,115,86,192,20,167,140,241,220,18,117,202,31,59,190,228,209,66,61,212,48,163,60,182,38,111,191,14,218,70,105,7,87,39,242,29,155,188,148,67,3,248,17,199,246,144,239,62,231,6,195,213,47,200,102,30,215,8,232,234,222,128,82,238,247,132,170,114,172,53,77,106,42,150,26,210,113,90,21,73,116,75,159,208,94,4,24,164,236,194,224,65,110,15,81,203,204,36,145,175,80,161,244,112,57,153,124,58,133,35,184,180,122,252,2,54,91,37,85,151,49,45,93,250,152,227,138,146,174,5,223,41,16,103,108,186,201,211,0,230,207,225,158,168,44,99,22,1,63,88,226,137,169,13,56,52,27,171,51,255,176,187,72,12,95,185,177,205,46,197,243,219,71,229,165,156,119,10,166,32,104,254,127,193,173],c=[1,2,3,5],d=function(a,b){return a<<b&65535|(65535&a)>>16-b},e=function(a,b){return(65535&a)>>b|a<<16-b&65535};a.rc2=a.rc2||{},a.rc2.expandKey=function(c,d){"string"==typeof c&&(c=a.util.createBuffer(c)),d=d||128;var e,f=c,g=c.length(),h=d,i=Math.ceil(h/8),j=255>>(7&h);for(e=g;128>e;e++)f.putByte(b[f.at(e-1)+f.at(e-g)&255]);for(f.setAt(128-i,b[f.at(128-i)&j]),e=127-i;e>=0;e--)f.setAt(e,b[f.at(e+1)^f.at(e+i)]);return f};var f=function(b,f,g){var h,i,j,k,l=!1,m=null,n=null,o=null,p=[];for(b=a.rc2.expandKey(b,f),j=0;64>j;j++)p.push(b.getInt16Le());g?(h=function(a){for(j=0;4>j;j++)a[j]+=p[k]+(a[(j+3)%4]&a[(j+2)%4])+(~a[(j+3)%4]&a[(j+1)%4]),a[j]=d(a[j],c[j]),k++},i=function(a){for(j=0;4>j;j++)a[j]+=p[63&a[(j+3)%4]]}):(h=function(a){for(j=3;j>=0;j--)a[j]=e(a[j],c[j]),a[j]-=p[k]+(a[(j+3)%4]&a[(j+2)%4])+(~a[(j+3)%4]&a[(j+1)%4]),k--},i=function(a){for(j=3;j>=0;j--)a[j]-=p[63&a[(j+3)%4]]});var q=function(a){var b=[];for(j=0;4>j;j++){var c=m.getInt16Le();null!==o&&(g?c^=o.getInt16Le():o.putInt16Le(c)),b.push(65535&c)}k=g?0:63;for(var d=0;d<a.length;d++)for(var e=0;e<a[d][0];e++)a[d][1](b);for(j=0;4>j;j++)null!==o&&(g?o.putInt16Le(b[j]):b[j]^=o.getInt16Le()),n.putInt16Le(b[j])},r=null;return r={start:function(b,c){b&&"string"==typeof b&&(b=a.util.createBuffer(b)),l=!1,m=a.util.createBuffer(),n=c||new a.util.createBuffer,o=b,r.output=n},update:function(a){for(l||m.putBuffer(a);m.length()>=8;)q([[5,h],[1,i],[6,h],[1,i],[5,h]])},finish:function(a){var b=!0;if(g)if(a)b=a(8,m,!g);else{var c=8===m.length()?8:8-m.length();m.fillWithByte(c,c)}if(b&&(l=!0,r.update()),!g&&(b=0===m.length()))if(a)b=a(8,n,!g);else{var d=n.length(),e=n.at(d-1);e>d?b=!1:n.truncate(e)}return b}}};a.rc2.startEncrypting=function(b,c,d){var e=a.rc2.createEncryptionCipher(b,128);return e.start(c,d),e},a.rc2.createEncryptionCipher=function(a,b){return f(a,b,!0)},a.rc2.startDecrypting=function(b,c,d){var e=a.rc2.createDecryptionCipher(b,128);return e.start(c,d),e},a.rc2.createDecryptionCipher=function(a,b){return f(a,b,!1)}}var c="rc2";if("function"!=typeof e){if("object"!=typeof b||!b.exports)return"undefined"==typeof forge&&(forge={}),a(forge);var f=!0;e=function(a,c){c(d,b)}}var g,h=function(b,d){d.exports=function(d){var e=g.map(function(a){return b(a)}).concat(a);if(d=d||{},d.defined=d.defined||{},d.defined[c])return d[c];d.defined[c]=!0;for(var f=0;f<e.length;++f)e[f](d);return d[c]}},i=e;(e=function(a,b){return g="string"==typeof a?b.slice(2):a.slice(2),f?(delete e,i.apply(null,Array.prototype.slice.call(arguments,0))):(e=i,e.apply(null,Array.prototype.slice.call(arguments,0)))})("js/rc2",["require","module","./util"],function(){h.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function a(a){function b(a,b,c){this.data=[],null!=a&&("number"==typeof a?this.fromNumber(a,b,c):null==b&&"string"!=typeof a?this.fromString(a,256):this.fromString(a,b))}function c(){return new b(null)}function d(a,b,c,d,e,f){for(;--f>=0;){var g=b*this.data[a++]+c.data[d]+e;e=Math.floor(g/67108864),c.data[d++]=67108863&g}return e}function e(a,b,c,d,e,f){for(var g=32767&b,h=b>>15;--f>=0;){var i=32767&this.data[a],j=this.data[a++]>>15,k=h*i+j*g;i=g*i+((32767&k)<<15)+c.data[d]+(1073741823&e),e=(i>>>30)+(k>>>15)+h*j+(e>>>30),c.data[d++]=1073741823&i}return e}function f(a,b,c,d,e,f){for(var g=16383&b,h=b>>14;--f>=0;){var i=16383&this.data[a],j=this.data[a++]>>14,k=h*i+j*g;i=g*i+((16383&k)<<14)+c.data[d]+e,e=(i>>28)+(k>>14)+h*j,c.data[d++]=268435455&i}return e}function g(a){return fc.charAt(a)}function h(a,b){var c=gc[a.charCodeAt(b)];return null==c?-1:c}function i(a){for(var b=this.t-1;b>=0;--b)a.data[b]=this.data[b];a.t=this.t,a.s=this.s}function j(a){this.t=1,this.s=0>a?-1:0,a>0?this.data[0]=a:-1>a?this.data[0]=a+this.DV:this.t=0}function k(a){var b=c();return b.fromInt(a),b}function l(a,c){var d;if(16==c)d=4;else if(8==c)d=3;else if(256==c)d=8;else if(2==c)d=1;else if(32==c)d=5;else{if(4!=c)return void this.fromRadix(a,c);d=2}this.t=0,this.s=0;for(var e=a.length,f=!1,g=0;--e>=0;){var i=8==d?255&a[e]:h(a,e);0>i?"-"==a.charAt(e)&&(f=!0):(f=!1,0==g?this.data[this.t++]=i:g+d>this.DB?(this.data[this.t-1]|=(i&(1<<this.DB-g)-1)<<g,this.data[this.t++]=i>>this.DB-g):this.data[this.t-1]|=i<<g,g+=d,g>=this.DB&&(g-=this.DB))}8==d&&0!=(128&a[0])&&(this.s=-1,g>0&&(this.data[this.t-1]|=(1<<this.DB-g)-1<<g)),this.clamp(),f&&b.ZERO.subTo(this,this)}function m(){for(var a=this.s&this.DM;this.t>0&&this.data[this.t-1]==a;)--this.t}function n(a){if(this.s<0)return"-"+this.negate().toString(a);var b;if(16==a)b=4;else if(8==a)b=3;else if(2==a)b=1;else if(32==a)b=5;else{if(4!=a)return this.toRadix(a);b=2}var c,d=(1<<b)-1,e=!1,f="",h=this.t,i=this.DB-h*this.DB%b;if(h-->0)for(i<this.DB&&(c=this.data[h]>>i)>0&&(e=!0,f=g(c));h>=0;)b>i?(c=(this.data[h]&(1<<i)-1)<<b-i,c|=this.data[--h]>>(i+=this.DB-b)):(c=this.data[h]>>(i-=b)&d,0>=i&&(i+=this.DB,--h)),c>0&&(e=!0),e&&(f+=g(c));return e?f:"0"}function o(){var a=c();return b.ZERO.subTo(this,a),a}function p(){return this.s<0?this.negate():this}function q(a){var b=this.s-a.s;if(0!=b)return b;var c=this.t;if(b=c-a.t,0!=b)return this.s<0?-b:b;for(;--c>=0;)if(0!=(b=this.data[c]-a.data[c]))return b;return 0}function r(a){var b,c=1;return 0!=(b=a>>>16)&&(a=b,c+=16),0!=(b=a>>8)&&(a=b,c+=8),0!=(b=a>>4)&&(a=b,c+=4),0!=(b=a>>2)&&(a=b,c+=2),0!=(b=a>>1)&&(a=b,c+=1),c}function s(){return this.t<=0?0:this.DB*(this.t-1)+r(this.data[this.t-1]^this.s&this.DM)}function t(a,b){var c;for(c=this.t-1;c>=0;--c)b.data[c+a]=this.data[c];for(c=a-1;c>=0;--c)b.data[c]=0;b.t=this.t+a,b.s=this.s}function u(a,b){for(var c=a;c<this.t;++c)b.data[c-a]=this.data[c];b.t=Math.max(this.t-a,0),b.s=this.s}function v(a,b){var c,d=a%this.DB,e=this.DB-d,f=(1<<e)-1,g=Math.floor(a/this.DB),h=this.s<<d&this.DM;for(c=this.t-1;c>=0;--c)b.data[c+g+1]=this.data[c]>>e|h,h=(this.data[c]&f)<<d;for(c=g-1;c>=0;--c)b.data[c]=0;b.data[g]=h,b.t=this.t+g+1,b.s=this.s,b.clamp()}function w(a,b){b.s=this.s;var c=Math.floor(a/this.DB);if(c>=this.t)return void(b.t=0);var d=a%this.DB,e=this.DB-d,f=(1<<d)-1;b.data[0]=this.data[c]>>d;for(var g=c+1;g<this.t;++g)b.data[g-c-1]|=(this.data[g]&f)<<e,b.data[g-c]=this.data[g]>>d;d>0&&(b.data[this.t-c-1]|=(this.s&f)<<e),b.t=this.t-c,b.clamp()}function x(a,b){for(var c=0,d=0,e=Math.min(a.t,this.t);e>c;)d+=this.data[c]-a.data[c],b.data[c++]=d&this.DM,d>>=this.DB;if(a.t<this.t){for(d-=a.s;c<this.t;)d+=this.data[c],b.data[c++]=d&this.DM,d>>=this.DB;d+=this.s}else{for(d+=this.s;c<a.t;)d-=a.data[c],b.data[c++]=d&this.DM,d>>=this.DB;d-=a.s}b.s=0>d?-1:0,-1>d?b.data[c++]=this.DV+d:d>0&&(b.data[c++]=d),b.t=c,b.clamp()}function y(a,c){var d=this.abs(),e=a.abs(),f=d.t;for(c.t=f+e.t;--f>=0;)c.data[f]=0;for(f=0;f<e.t;++f)c.data[f+d.t]=d.am(0,e.data[f],c,f,0,d.t);c.s=0,c.clamp(),this.s!=a.s&&b.ZERO.subTo(c,c)}function z(a){for(var b=this.abs(),c=a.t=2*b.t;--c>=0;)a.data[c]=0;for(c=0;c<b.t-1;++c){var d=b.am(c,b.data[c],a,2*c,0,1);(a.data[c+b.t]+=b.am(c+1,2*b.data[c],a,2*c+1,d,b.t-c-1))>=b.DV&&(a.data[c+b.t]-=b.DV,a.data[c+b.t+1]=1)}a.t>0&&(a.data[a.t-1]+=b.am(c,b.data[c],a,2*c,0,1)),a.s=0,a.clamp()}function A(a,d,e){var f=a.abs();if(!(f.t<=0)){var g=this.abs();if(g.t<f.t)return null!=d&&d.fromInt(0),void(null!=e&&this.copyTo(e));null==e&&(e=c());var h=c(),i=this.s,j=a.s,k=this.DB-r(f.data[f.t-1]);k>0?(f.lShiftTo(k,h),g.lShiftTo(k,e)):(f.copyTo(h),g.copyTo(e));var l=h.t,m=h.data[l-1];if(0!=m){var n=m*(1<<this.F1)+(l>1?h.data[l-2]>>this.F2:0),o=this.FV/n,p=(1<<this.F1)/n,q=1<<this.F2,s=e.t,t=s-l,u=null==d?c():d;for(h.dlShiftTo(t,u),e.compareTo(u)>=0&&(e.data[e.t++]=1,e.subTo(u,e)),b.ONE.dlShiftTo(l,u),u.subTo(h,h);h.t<l;)h.data[h.t++]=0;for(;--t>=0;){var v=e.data[--s]==m?this.DM:Math.floor(e.data[s]*o+(e.data[s-1]+q)*p);if((e.data[s]+=h.am(0,v,e,t,0,l))<v)for(h.dlShiftTo(t,u),e.subTo(u,e);e.data[s]<--v;)e.subTo(u,e)}null!=d&&(e.drShiftTo(l,d),i!=j&&b.ZERO.subTo(d,d)),e.t=l,e.clamp(),k>0&&e.rShiftTo(k,e),0>i&&b.ZERO.subTo(e,e)}}}function B(a){var d=c();return this.abs().divRemTo(a,null,d),this.s<0&&d.compareTo(b.ZERO)>0&&a.subTo(d,d),d}function C(a){this.m=a}function D(a){return a.s<0||a.compareTo(this.m)>=0?a.mod(this.m):a}function E(a){return a}function F(a){a.divRemTo(this.m,null,a)}function G(a,b,c){a.multiplyTo(b,c),this.reduce(c)}function H(a,b){a.squareTo(b),this.reduce(b)}function I(){if(this.t<1)return 0;var a=this.data[0];if(0==(1&a))return 0;var b=3&a;return b=b*(2-(15&a)*b)&15,b=b*(2-(255&a)*b)&255,b=b*(2-((65535&a)*b&65535))&65535,b=b*(2-a*b%this.DV)%this.DV,b>0?this.DV-b:-b}function J(a){this.m=a,this.mp=a.invDigit(),this.mpl=32767&this.mp,this.mph=this.mp>>15,this.um=(1<<a.DB-15)-1,this.mt2=2*a.t}function K(a){var d=c();return a.abs().dlShiftTo(this.m.t,d),d.divRemTo(this.m,null,d),a.s<0&&d.compareTo(b.ZERO)>0&&this.m.subTo(d,d),d}function L(a){var b=c();return a.copyTo(b),this.reduce(b),b}function M(a){for(;a.t<=this.mt2;)a.data[a.t++]=0;for(var b=0;b<this.m.t;++b){var c=32767&a.data[b],d=c*this.mpl+((c*this.mph+(a.data[b]>>15)*this.mpl&this.um)<<15)&a.DM;for(c=b+this.m.t,a.data[c]+=this.m.am(0,d,a,b,0,this.m.t);a.data[c]>=a.DV;)a.data[c]-=a.DV,a.data[++c]++}a.clamp(),a.drShiftTo(this.m.t,a),a.compareTo(this.m)>=0&&a.subTo(this.m,a)}function N(a,b){a.squareTo(b),this.reduce(b)}function O(a,b,c){a.multiplyTo(b,c),this.reduce(c)}function P(){return 0==(this.t>0?1&this.data[0]:this.s)}function Q(a,d){if(a>4294967295||1>a)return b.ONE;var e=c(),f=c(),g=d.convert(this),h=r(a)-1;for(g.copyTo(e);--h>=0;)if(d.sqrTo(e,f),(a&1<<h)>0)d.mulTo(f,g,e);else{var i=e;e=f,f=i}return d.revert(e)}function R(a,b){var c;return c=256>a||b.isEven()?new C(b):new J(b),this.exp(a,c)}function S(){var a=c();return this.copyTo(a),a}function T(){if(this.s<0){if(1==this.t)return this.data[0]-this.DV;if(0==this.t)return-1}else{if(1==this.t)return this.data[0];if(0==this.t)return 0}return(this.data[1]&(1<<32-this.DB)-1)<<this.DB|this.data[0]}function U(){return 0==this.t?this.s:this.data[0]<<24>>24}function V(){return 0==this.t?this.s:this.data[0]<<16>>16}function W(a){return Math.floor(Math.LN2*this.DB/Math.log(a))}function X(){return this.s<0?-1:this.t<=0||1==this.t&&this.data[0]<=0?0:1}function Y(a){if(null==a&&(a=10),0==this.signum()||2>a||a>36)return"0";var b=this.chunkSize(a),d=Math.pow(a,b),e=k(d),f=c(),g=c(),h="";for(this.divRemTo(e,f,g);f.signum()>0;)h=(d+g.intValue()).toString(a).substr(1)+h,f.divRemTo(e,f,g);return g.intValue().toString(a)+h}function Z(a,c){this.fromInt(0),null==c&&(c=10);for(var d=this.chunkSize(c),e=Math.pow(c,d),f=!1,g=0,i=0,j=0;j<a.length;++j){var k=h(a,j);0>k?"-"==a.charAt(j)&&0==this.signum()&&(f=!0):(i=c*i+k,++g>=d&&(this.dMultiply(e),this.dAddOffset(i,0),g=0,i=0))}g>0&&(this.dMultiply(Math.pow(c,g)),this.dAddOffset(i,0)),f&&b.ZERO.subTo(this,this)}function $(a,c,d){if("number"==typeof c)if(2>a)this.fromInt(1);else for(this.fromNumber(a,d),this.testBit(a-1)||this.bitwiseTo(b.ONE.shiftLeft(a-1),gb,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(c);)this.dAddOffset(2,0),this.bitLength()>a&&this.subTo(b.ONE.shiftLeft(a-1),this);else{var e=new Array,f=7&a;e.length=(a>>3)+1,c.nextBytes(e),f>0?e[0]&=(1<<f)-1:e[0]=0,this.fromString(e,256)}}function _(){var a=this.t,b=new Array;b[0]=this.s;var c,d=this.DB-a*this.DB%8,e=0;if(a-->0)for(d<this.DB&&(c=this.data[a]>>d)!=(this.s&this.DM)>>d&&(b[e++]=c|this.s<<this.DB-d);a>=0;)8>d?(c=(this.data[a]&(1<<d)-1)<<8-d,c|=this.data[--a]>>(d+=this.DB-8)):(c=this.data[a]>>(d-=8)&255,0>=d&&(d+=this.DB,--a)),0!=(128&c)&&(c|=-256),0==e&&(128&this.s)!=(128&c)&&++e,(e>0||c!=this.s)&&(b[e++]=c);return b}function ab(a){return 0==this.compareTo(a)}function bb(a){return this.compareTo(a)<0?this:a}function cb(a){return this.compareTo(a)>0?this:a}function db(a,b,c){var d,e,f=Math.min(a.t,this.t);for(d=0;f>d;++d)c.data[d]=b(this.data[d],a.data[d]);if(a.t<this.t){for(e=a.s&this.DM,d=f;d<this.t;++d)c.data[d]=b(this.data[d],e);c.t=this.t}else{for(e=this.s&this.DM,d=f;d<a.t;++d)c.data[d]=b(e,a.data[d]);c.t=a.t}c.s=b(this.s,a.s),c.clamp()}function eb(a,b){return a&b}function fb(a){var b=c();return this.bitwiseTo(a,eb,b),b}function gb(a,b){return a|b}function hb(a){var b=c();return this.bitwiseTo(a,gb,b),b}function ib(a,b){return a^b}function jb(a){var b=c();return this.bitwiseTo(a,ib,b),b}function kb(a,b){return a&~b}function lb(a){var b=c();return this.bitwiseTo(a,kb,b),b}function mb(){for(var a=c(),b=0;b<this.t;++b)a.data[b]=this.DM&~this.data[b];return a.t=this.t,a.s=~this.s,a}function nb(a){var b=c();return 0>a?this.rShiftTo(-a,b):this.lShiftTo(a,b),b}function ob(a){var b=c();return 0>a?this.lShiftTo(-a,b):this.rShiftTo(a,b),b}function pb(a){if(0==a)return-1;var b=0;return 0==(65535&a)&&(a>>=16,b+=16),0==(255&a)&&(a>>=8,b+=8),0==(15&a)&&(a>>=4,b+=4),0==(3&a)&&(a>>=2,b+=2),0==(1&a)&&++b,b}function qb(){for(var a=0;a<this.t;++a)if(0!=this.data[a])return a*this.DB+pb(this.data[a]);return this.s<0?this.t*this.DB:-1}function rb(a){for(var b=0;0!=a;)a&=a-1,++b;return b}function sb(){for(var a=0,b=this.s&this.DM,c=0;c<this.t;++c)a+=rb(this.data[c]^b);return a}function tb(a){var b=Math.floor(a/this.DB);return b>=this.t?0!=this.s:0!=(this.data[b]&1<<a%this.DB)}function ub(a,c){var d=b.ONE.shiftLeft(a);return this.bitwiseTo(d,c,d),d}function vb(a){return this.changeBit(a,gb)}function wb(a){return this.changeBit(a,kb)}function xb(a){return this.changeBit(a,ib)}function yb(a,b){for(var c=0,d=0,e=Math.min(a.t,this.t);e>c;)d+=this.data[c]+a.data[c],b.data[c++]=d&this.DM,d>>=this.DB;if(a.t<this.t){for(d+=a.s;c<this.t;)d+=this.data[c],b.data[c++]=d&this.DM,d>>=this.DB;d+=this.s}else{for(d+=this.s;c<a.t;)d+=a.data[c],b.data[c++]=d&this.DM,d>>=this.DB;d+=a.s}b.s=0>d?-1:0,d>0?b.data[c++]=d:-1>d&&(b.data[c++]=this.DV+d),b.t=c,b.clamp()}function zb(a){var b=c();return this.addTo(a,b),b}function Ab(a){var b=c();return this.subTo(a,b),b}function Bb(a){var b=c();return this.multiplyTo(a,b),b}function Cb(a){var b=c();return this.divRemTo(a,b,null),b}function Db(a){var b=c();return this.divRemTo(a,null,b),b}function Eb(a){var b=c(),d=c();return this.divRemTo(a,b,d),new Array(b,d)}function Fb(a){this.data[this.t]=this.am(0,a-1,this,0,0,this.t),++this.t,this.clamp()}function Gb(a,b){if(0!=a){for(;this.t<=b;)this.data[this.t++]=0;for(this.data[b]+=a;this.data[b]>=this.DV;)this.data[b]-=this.DV,++b>=this.t&&(this.data[this.t++]=0),++this.data[b]}}function Hb(){}function Ib(a){return a}function Jb(a,b,c){a.multiplyTo(b,c)}function Kb(a,b){a.squareTo(b)}function Lb(a){return this.exp(a,new Hb)}function Mb(a,b,c){var d=Math.min(this.t+a.t,b);for(c.s=0,c.t=d;d>0;)c.data[--d]=0;var e;for(e=c.t-this.t;e>d;++d)c.data[d+this.t]=this.am(0,a.data[d],c,d,0,this.t);for(e=Math.min(a.t,b);e>d;++d)this.am(0,a.data[d],c,d,0,b-d);c.clamp()}function Nb(a,b,c){--b;var d=c.t=this.t+a.t-b;for(c.s=0;--d>=0;)c.data[d]=0;for(d=Math.max(b-this.t,0);d<a.t;++d)c.data[this.t+d-b]=this.am(b-d,a.data[d],c,0,0,this.t+d-b);c.clamp(),c.drShiftTo(1,c)}function Ob(a){this.r2=c(),this.q3=c(),b.ONE.dlShiftTo(2*a.t,this.r2),this.mu=this.r2.divide(a),this.m=a}function Pb(a){if(a.s<0||a.t>2*this.m.t)return a.mod(this.m);if(a.compareTo(this.m)<0)return a;var b=c();return a.copyTo(b),this.reduce(b),b}function Qb(a){return a}function Rb(a){for(a.drShiftTo(this.m.t-1,this.r2),a.t>this.m.t+1&&(a.t=this.m.t+1,a.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);a.compareTo(this.r2)<0;)a.dAddOffset(1,this.m.t+1);for(a.subTo(this.r2,a);a.compareTo(this.m)>=0;)a.subTo(this.m,a)}function Sb(a,b){a.squareTo(b),this.reduce(b)}function Tb(a,b,c){a.multiplyTo(b,c),this.reduce(c)}function Ub(a,b){var d,e,f=a.bitLength(),g=k(1);if(0>=f)return g;d=18>f?1:48>f?3:144>f?4:768>f?5:6,e=8>f?new C(b):b.isEven()?new Ob(b):new J(b);var h=new Array,i=3,j=d-1,l=(1<<d)-1;if(h[1]=e.convert(this),d>1){var m=c();for(e.sqrTo(h[1],m);l>=i;)h[i]=c(),e.mulTo(m,h[i-2],h[i]),i+=2}var n,o,p=a.t-1,q=!0,s=c();for(f=r(a.data[p])-1;p>=0;){for(f>=j?n=a.data[p]>>f-j&l:(n=(a.data[p]&(1<<f+1)-1)<<j-f,p>0&&(n|=a.data[p-1]>>this.DB+f-j)),i=d;0==(1&n);)n>>=1,--i;if((f-=i)<0&&(f+=this.DB,--p),q)h[n].copyTo(g),q=!1;else{for(;i>1;)e.sqrTo(g,s),e.sqrTo(s,g),i-=2;i>0?e.sqrTo(g,s):(o=g,g=s,s=o),e.mulTo(s,h[n],g)}for(;p>=0&&0==(a.data[p]&1<<f);)e.sqrTo(g,s),o=g,g=s,s=o,--f<0&&(f=this.DB-1,--p)}return e.revert(g)}function Vb(a){var b=this.s<0?this.negate():this.clone(),c=a.s<0?a.negate():a.clone();if(b.compareTo(c)<0){var d=b;b=c,c=d}var e=b.getLowestSetBit(),f=c.getLowestSetBit();if(0>f)return b;for(f>e&&(f=e),f>0&&(b.rShiftTo(f,b),c.rShiftTo(f,c));b.signum()>0;)(e=b.getLowestSetBit())>0&&b.rShiftTo(e,b),(e=c.getLowestSetBit())>0&&c.rShiftTo(e,c),b.compareTo(c)>=0?(b.subTo(c,b),b.rShiftTo(1,b)):(c.subTo(b,c),c.rShiftTo(1,c));return f>0&&c.lShiftTo(f,c),c}function Wb(a){if(0>=a)return 0;var b=this.DV%a,c=this.s<0?a-1:0;if(this.t>0)if(0==b)c=this.data[0]%a;else for(var d=this.t-1;d>=0;--d)c=(b*c+this.data[d])%a;return c}function Xb(a){var c=a.isEven();if(this.isEven()&&c||0==a.signum())return b.ZERO;for(var d=a.clone(),e=this.clone(),f=k(1),g=k(0),h=k(0),i=k(1);0!=d.signum();){for(;d.isEven();)d.rShiftTo(1,d),c?(f.isEven()&&g.isEven()||(f.addTo(this,f),g.subTo(a,g)),f.rShiftTo(1,f)):g.isEven()||g.subTo(a,g),g.rShiftTo(1,g);for(;e.isEven();)e.rShiftTo(1,e),c?(h.isEven()&&i.isEven()||(h.addTo(this,h),i.subTo(a,i)),h.rShiftTo(1,h)):i.isEven()||i.subTo(a,i),i.rShiftTo(1,i);d.compareTo(e)>=0?(d.subTo(e,d),c&&f.subTo(h,f),g.subTo(i,g)):(e.subTo(d,e),c&&h.subTo(f,h),i.subTo(g,i))}return 0!=e.compareTo(b.ONE)?b.ZERO:i.compareTo(a)>=0?i.subtract(a):i.signum()<0?(i.addTo(a,i),i.signum()<0?i.add(a):i):i}function Yb(a){var b,c=this.abs();if(1==c.t&&c.data[0]<=hc[hc.length-1]){for(b=0;b<hc.length;++b)if(c.data[0]==hc[b])return!0;return!1}if(c.isEven())return!1;for(b=1;b<hc.length;){for(var d=hc[b],e=b+1;e<hc.length&&ic>d;)d*=hc[e++];for(d=c.modInt(d);e>b;)if(d%hc[b++]==0)return!1}return c.millerRabin(a)}function Zb(a){var c=this.subtract(b.ONE),d=c.getLowestSetBit();if(0>=d)return!1;for(var e,f=c.shiftRight(d),g=$b(),h=0;a>h;++h){do e=new b(this.bitLength(),g);while(e.compareTo(b.ONE)<=0||e.compareTo(c)>=0);var i=e.modPow(f,this);if(0!=i.compareTo(b.ONE)&&0!=i.compareTo(c)){for(var j=1;j++<d&&0!=i.compareTo(c);)if(i=i.modPowInt(2,this),0==i.compareTo(b.ONE))return!1;if(0!=i.compareTo(c))return!1}}return!0}function $b(){return{nextBytes:function(a){for(var b=0;b<a.length;++b)a[b]=Math.floor(255*Math.random())}}}var _b,ac=0xdeadbeefcafe,bc=15715070==(16777215&ac);"undefined"==typeof navigator?(b.prototype.am=f,_b=28):bc&&"Microsoft Internet Explorer"==navigator.appName?(b.prototype.am=e,_b=30):bc&&"Netscape"!=navigator.appName?(b.prototype.am=d,_b=26):(b.prototype.am=f,_b=28),b.prototype.DB=_b,b.prototype.DM=(1<<_b)-1,b.prototype.DV=1<<_b;var cc=52;b.prototype.FV=Math.pow(2,cc),b.prototype.F1=cc-_b,b.prototype.F2=2*_b-cc;var dc,ec,fc="0123456789abcdefghijklmnopqrstuvwxyz",gc=new Array;for(dc="0".charCodeAt(0),ec=0;9>=ec;++ec)gc[dc++]=ec;for(dc="a".charCodeAt(0),ec=10;36>ec;++ec)gc[dc++]=ec;for(dc="A".charCodeAt(0),ec=10;36>ec;++ec)gc[dc++]=ec;C.prototype.convert=D,C.prototype.revert=E,C.prototype.reduce=F,C.prototype.mulTo=G,C.prototype.sqrTo=H,J.prototype.convert=K,J.prototype.revert=L,J.prototype.reduce=M,J.prototype.mulTo=O,J.prototype.sqrTo=N,b.prototype.copyTo=i,b.prototype.fromInt=j,b.prototype.fromString=l,b.prototype.clamp=m,b.prototype.dlShiftTo=t,b.prototype.drShiftTo=u,b.prototype.lShiftTo=v,b.prototype.rShiftTo=w,b.prototype.subTo=x,b.prototype.multiplyTo=y,b.prototype.squareTo=z,b.prototype.divRemTo=A,b.prototype.invDigit=I,b.prototype.isEven=P,b.prototype.exp=Q,b.prototype.toString=n,b.prototype.negate=o,b.prototype.abs=p,b.prototype.compareTo=q,b.prototype.bitLength=s,b.prototype.mod=B,b.prototype.modPowInt=R,b.ZERO=k(0),b.ONE=k(1),Hb.prototype.convert=Ib,Hb.prototype.revert=Ib,Hb.prototype.mulTo=Jb,Hb.prototype.sqrTo=Kb,Ob.prototype.convert=Pb,Ob.prototype.revert=Qb,Ob.prototype.reduce=Rb,Ob.prototype.mulTo=Tb,Ob.prototype.sqrTo=Sb;var hc=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509],ic=(1<<26)/hc[hc.length-1];b.prototype.chunkSize=W,b.prototype.toRadix=Y,b.prototype.fromRadix=Z,b.prototype.fromNumber=$,b.prototype.bitwiseTo=db,b.prototype.changeBit=ub,b.prototype.addTo=yb,b.prototype.dMultiply=Fb,b.prototype.dAddOffset=Gb,b.prototype.multiplyLowerTo=Mb,b.prototype.multiplyUpperTo=Nb,b.prototype.modInt=Wb,b.prototype.millerRabin=Zb,b.prototype.clone=S,b.prototype.intValue=T,b.prototype.byteValue=U,b.prototype.shortValue=V,b.prototype.signum=X,b.prototype.toByteArray=_,b.prototype.equals=ab,b.prototype.min=bb,b.prototype.max=cb,b.prototype.and=fb,b.prototype.or=hb,b.prototype.xor=jb,b.prototype.andNot=lb,b.prototype.not=mb,b.prototype.shiftLeft=nb,b.prototype.shiftRight=ob,b.prototype.getLowestSetBit=qb,b.prototype.bitCount=sb,b.prototype.testBit=tb,b.prototype.setBit=vb,b.prototype.clearBit=wb,b.prototype.flipBit=xb,b.prototype.add=zb,b.prototype.subtract=Ab,b.prototype.multiply=Bb,b.prototype.divide=Cb,b.prototype.remainder=Db,b.prototype.divideAndRemainder=Eb,b.prototype.modPow=Ub,b.prototype.modInverse=Xb,b.prototype.pow=Lb,b.prototype.gcd=Vb,b.prototype.isProbablePrime=Yb,a.jsbn=a.jsbn||{},a.jsbn.BigInteger=b}var c="jsbn";if("function"!=typeof e){if("object"!=typeof b||!b.exports)return"undefined"==typeof forge&&(forge={}),a(forge);var f=!0;e=function(a,c){c(d,b)}}var g,h=function(b,d){d.exports=function(d){var e=g.map(function(a){return b(a)}).concat(a);if(d=d||{},d.defined=d.defined||{},d.defined[c])return d[c];d.defined[c]=!0;for(var f=0;f<e.length;++f)e[f](d);return d[c]}},i=e;(e=function(a,b){return g="string"==typeof a?b.slice(2):a.slice(2),f?(delete e,i.apply(null,Array.prototype.slice.call(arguments,0))):(e=i,e.apply(null,Array.prototype.slice.call(arguments,0)))})("js/jsbn",["require","module"],function(){h.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function a(a){function b(a,b,c){for(var d="",e=Math.ceil(b/c.digestLength),f=0;e>f;++f){var g=String.fromCharCode(f>>24&255,f>>16&255,f>>8&255,255&f);c.start(),c.update(a+g),d+=c.digest().getBytes()}return d.substring(0,b)}var c=a.pkcs1=a.pkcs1||{};c.encode_rsa_oaep=function(c,d,e){var f=void 0,g=void 0,h=void 0;"string"==typeof e?(f=e,g=arguments[3]||void 0,h=arguments[4]||void 0):e&&(f=e.label||void 0,g=e.seed||void 0,h=e.md||void 0),h?h.start():h=a.md.sha1.create();var i=Math.ceil(c.n.bitLength()/8),j=i-2*h.digestLength-2;if(d.length>j)throw{message:"RSAES-OAEP input message length is too long.",length:d.length,maxLength:j};f||(f=""),h.update(f,"raw");for(var k=h.digest(),l="",m=j-d.length,n=0;m>n;n++)l+="\x00";var o=k.getBytes()+l+""+d;if(g){if(g.length!==h.digestLength)throw{message:"Invalid RSAES-OAEP seed. The seed length must match the digest length.",seedLength:g.length,digestLength:h.digestLength}}else g=a.random.getBytes(h.digestLength);var p=b(g,i-h.digestLength-1,h),q=a.util.xorBytes(o,p,o.length),r=b(q,h.digestLength,h),s=a.util.xorBytes(g,r,g.length);return"\x00"+s+q
},c.decode_rsa_oaep=function(c,d,e){var f=void 0,g=void 0;"string"==typeof e?(f=e,g=arguments[3]||void 0):e&&(f=e.label||void 0,g=e.md||void 0);var h=Math.ceil(c.n.bitLength()/8);if(d.length!==h)throw{message:"RSAES-OAEP encoded message length is invalid.",length:d.length,expectedLength:h};if(void 0===g?g=a.md.sha1.create():g.start(),h<2*g.digestLength+2)throw{message:"RSAES-OAEP key is too short for the hash function."};f||(f=""),g.update(f,"raw");for(var i=g.digest().getBytes(),j=d.charAt(0),k=d.substring(1,g.digestLength+1),l=d.substring(1+g.digestLength),m=b(l,g.digestLength,g),n=a.util.xorBytes(k,m,k.length),o=b(n,h-g.digestLength-1,g),p=a.util.xorBytes(l,o,l.length),q=p.substring(0,g.digestLength),r="\x00"!==j,s=0;s<g.digestLength;++s)r|=i.charAt(s)!==q.charAt(s);for(var t=1,u=g.digestLength,v=g.digestLength;v<p.length;v++){var w=p.charCodeAt(v),x=1&w^1,y=t?65534:0;r|=w&y,t&=x,u+=t}if(r||1!==p.charCodeAt(u))throw{message:"Invalid RSAES-OAEP padding."};return p.substring(u+1)}}var c="pkcs1";if("function"!=typeof e){if("object"!=typeof b||!b.exports)return"undefined"==typeof forge&&(forge={}),a(forge);var f=!0;e=function(a,c){c(d,b)}}var g,h=function(b,d){d.exports=function(d){var e=g.map(function(a){return b(a)}).concat(a);if(d=d||{},d.defined=d.defined||{},d.defined[c])return d[c];d.defined[c]=!0;for(var f=0;f<e.length;++f)e[f](d);return d[c]}},i=e;(e=function(a,b){return g="string"==typeof a?b.slice(2):a.slice(2),f?(delete e,i.apply(null,Array.prototype.slice.call(arguments,0))):(e=i,e.apply(null,Array.prototype.slice.call(arguments,0)))})("js/pkcs1",["require","module","./util","./random","./sha1"],function(){h.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function a(a){function b(b,c,d){var e=a.util.createBuffer(),f=Math.ceil(c.n.bitLength()/8);if(b.length>f-11)throw{message:"Message is too long for PKCS#1 v1.5 padding.",length:b.length,max:f-11};e.putByte(0),e.putByte(d);var g,h=f-3-b.length;if(0===d||1===d){g=0===d?0:255;for(var i=0;h>i;++i)e.putByte(g)}else for(;h>0;){for(var j=0,k=a.random.getBytes(h),i=0;h>i;++i)g=k.charCodeAt(i),0===g?++j:e.putByte(g);h=j}return e.putByte(0),e.putBytes(b),e}function c(b,c,d,e){var f=Math.ceil(c.n.bitLength()/8),g=a.util.createBuffer(b),h=g.getByte(),i=g.getByte();if(0!==h||d&&0!==i&&1!==i||!d&&2!=i||d&&0===i&&"undefined"==typeof e)throw{message:"Encryption block is invalid."};var j=0;if(0===i){j=f-3-e;for(var k=0;j>k;++k)if(0!==g.getByte())throw{message:"Encryption block is invalid."}}else if(1===i)for(j=0;g.length()>1;){if(255!==g.getByte()){--g.read;break}++j}else if(2===i)for(j=0;g.length()>1;){if(0===g.getByte()){--g.read;break}++j}var l=g.getByte();if(0!==l||j!==f-3-g.length())throw{message:"Encryption block is invalid."};return g.getBytes()}function d(b,c,d){function e(){f(b.pBits,function(a,c){return a?d(a):(b.p=c,void f(b.qBits,h))})}function f(a,c){function d(){var c=a-1,d=new g(a,b.rng);return d.testBit(c)||d.bitwiseTo(g.ONE.shiftLeft(c),o,d),d.dAddOffset(31-d.mod(n).byteValue(),0),d}function e(e){if(!p){--i;var h=e.data;if(h.found){for(var k=0;k<f.length;++k)f[k].terminate();return p=!0,c(null,new g(h.prime,16))}j.bitLength()>a&&(j=d());var n=j.toString(16);e.target.postMessage({e:b.eInt,hex:n,workLoad:l}),j.dAddOffset(m,0)}}for(var f=[],h=0;k>h;++h)f[h]=new Worker("./forge/prime.worker.js");for(var i=k,j=d(),h=0;k>h;++h)f[h].addEventListener("message",e);var p=!1}function h(a,c){if(b.q=c,b.p.compareTo(b.q)<0){var j=b.p;b.p=b.q,b.q=j}if(b.p1=b.p.subtract(g.ONE),b.q1=b.q.subtract(g.ONE),b.phi=b.p1.multiply(b.q1),0!==b.phi.gcd(b.e).compareTo(g.ONE))return b.p=b.q=null,void e();if(b.n=b.p.multiply(b.q),b.n.bitLength()!==b.bits)return b.q=null,void f(b.qBits,h);var k=b.e.modInverse(b.phi);b.keys={privateKey:i.rsa.setPrivateKey(b.n,b.e,k,b.p,b.q,k.mod(b.p1),k.mod(b.q1),b.q.modInverse(b.p)),publicKey:i.rsa.setPublicKey(b.n,b.e)},d(null,b.keys)}function j(){return i.rsa.stepKeyPairGenerationState(b,10)?d(null,b.keys):void a.util.setImmediate(j)}if("function"==typeof c&&(d=c,c={}),"undefined"==typeof Worker)return j();var k=c.workers||2,l=c.workLoad||100,m=30*l/8,n=(c.workerScript||"forge/prime.worker.js",new g(null));n.fromInt(30);var o=function(a,b){return a|b};e()}function e(b){var c=b.toString(16);return c[0]>="8"&&(c="00"+c),a.util.hexToBytes(c)}function f(a){return 100>=a?27:150>=a?18:200>=a?15:250>=a?12:300>=a?9:350>=a?8:400>=a?7:500>=a?6:600>=a?5:800>=a?4:1250>=a?3:2}if("undefined"==typeof g)var g=a.jsbn.BigInteger;var h=a.asn1;a.pki=a.pki||{},a.pki.rsa=a.rsa=a.rsa||{};var i=a.pki,j=[6,4,2,4,2,4,6,2],k={name:"PrivateKeyInfo",tagClass:h.Class.UNIVERSAL,type:h.Type.SEQUENCE,constructed:!0,value:[{name:"PrivateKeyInfo.version",tagClass:h.Class.UNIVERSAL,type:h.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"PrivateKeyInfo.privateKeyAlgorithm",tagClass:h.Class.UNIVERSAL,type:h.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:h.Class.UNIVERSAL,type:h.Type.OID,constructed:!1,capture:"privateKeyOid"}]},{name:"PrivateKeyInfo",tagClass:h.Class.UNIVERSAL,type:h.Type.OCTETSTRING,constructed:!1,capture:"privateKey"}]},l={name:"RSAPrivateKey",tagClass:h.Class.UNIVERSAL,type:h.Type.SEQUENCE,constructed:!0,value:[{name:"RSAPrivateKey.version",tagClass:h.Class.UNIVERSAL,type:h.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"RSAPrivateKey.modulus",tagClass:h.Class.UNIVERSAL,type:h.Type.INTEGER,constructed:!1,capture:"privateKeyModulus"},{name:"RSAPrivateKey.publicExponent",tagClass:h.Class.UNIVERSAL,type:h.Type.INTEGER,constructed:!1,capture:"privateKeyPublicExponent"},{name:"RSAPrivateKey.privateExponent",tagClass:h.Class.UNIVERSAL,type:h.Type.INTEGER,constructed:!1,capture:"privateKeyPrivateExponent"},{name:"RSAPrivateKey.prime1",tagClass:h.Class.UNIVERSAL,type:h.Type.INTEGER,constructed:!1,capture:"privateKeyPrime1"},{name:"RSAPrivateKey.prime2",tagClass:h.Class.UNIVERSAL,type:h.Type.INTEGER,constructed:!1,capture:"privateKeyPrime2"},{name:"RSAPrivateKey.exponent1",tagClass:h.Class.UNIVERSAL,type:h.Type.INTEGER,constructed:!1,capture:"privateKeyExponent1"},{name:"RSAPrivateKey.exponent2",tagClass:h.Class.UNIVERSAL,type:h.Type.INTEGER,constructed:!1,capture:"privateKeyExponent2"},{name:"RSAPrivateKey.coefficient",tagClass:h.Class.UNIVERSAL,type:h.Type.INTEGER,constructed:!1,capture:"privateKeyCoefficient"}]},m={name:"RSAPublicKey",tagClass:h.Class.UNIVERSAL,type:h.Type.SEQUENCE,constructed:!0,value:[{name:"RSAPublicKey.modulus",tagClass:h.Class.UNIVERSAL,type:h.Type.INTEGER,constructed:!1,capture:"publicKeyModulus"},{name:"RSAPublicKey.exponent",tagClass:h.Class.UNIVERSAL,type:h.Type.INTEGER,constructed:!1,capture:"publicKeyExponent"}]},n=a.pki.rsa.publicKeyValidator={name:"SubjectPublicKeyInfo",tagClass:h.Class.UNIVERSAL,type:h.Type.SEQUENCE,constructed:!0,captureAsn1:"subjectPublicKeyInfo",value:[{name:"SubjectPublicKeyInfo.AlgorithmIdentifier",tagClass:h.Class.UNIVERSAL,type:h.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:h.Class.UNIVERSAL,type:h.Type.OID,constructed:!1,capture:"publicKeyOid"}]},{name:"SubjectPublicKeyInfo.subjectPublicKey",tagClass:h.Class.UNIVERSAL,type:h.Type.BITSTRING,constructed:!1,value:[{name:"SubjectPublicKeyInfo.subjectPublicKey.RSAPublicKey",tagClass:h.Class.UNIVERSAL,type:h.Type.SEQUENCE,constructed:!0,optional:!0,captureAsn1:"rsaPublicKey"}]}]},o=function(a){var b;if(a.algorithm in i.oids){b=i.oids[a.algorithm];var c=h.oidToDer(b).getBytes(),d=h.create(h.Class.UNIVERSAL,h.Type.SEQUENCE,!0,[]),e=h.create(h.Class.UNIVERSAL,h.Type.SEQUENCE,!0,[]);e.value.push(h.create(h.Class.UNIVERSAL,h.Type.OID,!1,c)),e.value.push(h.create(h.Class.UNIVERSAL,h.Type.NULL,!1,""));var f=h.create(h.Class.UNIVERSAL,h.Type.OCTETSTRING,!1,a.digest().getBytes());return d.value.push(e),d.value.push(f),h.toDer(d).getBytes()}throw{message:"Unknown message digest algorithm.",algorithm:a.algorithm}},p=function(a,b,c){var d;if(c)d=a.modPow(b.e,b.n);else if(b.p&&b.q){b.dP||(b.dP=b.d.mod(b.p.subtract(g.ONE))),b.dQ||(b.dQ=b.d.mod(b.q.subtract(g.ONE))),b.qInv||(b.qInv=b.q.modInverse(b.p));for(var e=a.mod(b.p).modPow(b.dP,b.p),f=a.mod(b.q).modPow(b.dQ,b.q);e.compareTo(f)<0;)e=e.add(b.p);d=e.subtract(f).multiply(b.qInv).mod(b.p).multiply(b.q).add(f)}else d=a.modPow(b.d,b.n);return d};i.rsa.encrypt=function(c,d,e){var f,h=e,i=Math.ceil(d.n.bitLength()/8);e!==!1&&e!==!0?(h=2===e,f=b(c,d,e)):(f=a.util.createBuffer(),f.putBytes(c));for(var j=new g(f.toHex(),16),k=p(j,d,h),l=k.toString(16),m=a.util.createBuffer(),n=i-Math.ceil(l.length/2);n>0;)m.putByte(0),--n;return m.putBytes(a.util.hexToBytes(l)),m.getBytes()},i.rsa.decrypt=function(b,d,e,f){var h=Math.ceil(d.n.bitLength()/8);if(b.length!==h)throw{message:"Encrypted message length is invalid.",length:b.length,expected:h};var i=new g(a.util.createBuffer(b).toHex(),16);if(i.compareTo(d.n)>=0)throw{message:"Encrypted message is invalid."};for(var j=p(i,d,e),k=j.toString(16),l=a.util.createBuffer(),m=h-Math.ceil(k.length/2);m>0;)l.putByte(0),--m;return l.putBytes(a.util.hexToBytes(k)),f!==!1?c(l.getBytes(),d,e):l.getBytes()},i.rsa.createKeyPairGenerationState=function(b,c){"string"==typeof b&&(b=parseInt(b,10)),b=b||2048;var d={nextBytes:function(b){for(var c=a.random.getBytes(b.length),d=0;d<b.length;++d)b[d]=c.charCodeAt(d)}},e={state:0,bits:b,rng:d,eInt:c||65537,e:new g(null),p:null,q:null,qBits:b>>1,pBits:b-(b>>1),pqState:0,num:null,keys:null};return e.e.fromInt(e.eInt),e},i.rsa.stepKeyPairGenerationState=function(a,b){var c=new g(null);c.fromInt(30);for(var d,e=0,h=function(a,b){return a|b},k=+new Date,l=0;null===a.keys&&(0>=b||b>l);){if(0===a.state){var m=null===a.p?a.pBits:a.qBits,n=m-1;0===a.pqState?(a.num=new g(m,a.rng),a.num.testBit(n)||a.num.bitwiseTo(g.ONE.shiftLeft(n),h,a.num),a.num.dAddOffset(31-a.num.mod(c).byteValue(),0),e=0,++a.pqState):1===a.pqState?a.num.bitLength()>m?a.pqState=0:a.num.isProbablePrime(f(a.num.bitLength()))?++a.pqState:a.num.dAddOffset(j[e++%8],0):2===a.pqState?a.pqState=0===a.num.subtract(g.ONE).gcd(a.e).compareTo(g.ONE)?3:0:3===a.pqState&&(a.pqState=0,null===a.p?a.p=a.num:a.q=a.num,null!==a.p&&null!==a.q&&++a.state,a.num=null)}else if(1===a.state)a.p.compareTo(a.q)<0&&(a.num=a.p,a.p=a.q,a.q=a.num),++a.state;else if(2===a.state)a.p1=a.p.subtract(g.ONE),a.q1=a.q.subtract(g.ONE),a.phi=a.p1.multiply(a.q1),++a.state;else if(3===a.state)0===a.phi.gcd(a.e).compareTo(g.ONE)?++a.state:(a.p=null,a.q=null,a.state=0);else if(4===a.state)a.n=a.p.multiply(a.q),a.n.bitLength()===a.bits?++a.state:(a.q=null,a.state=0);else if(5===a.state){var o=a.e.modInverse(a.phi);a.keys={privateKey:i.rsa.setPrivateKey(a.n,a.e,o,a.p,a.q,o.mod(a.p1),o.mod(a.q1),a.q.modInverse(a.p)),publicKey:i.rsa.setPublicKey(a.n,a.e)}}d=+new Date,l+=d-k,k=d}return null!==a.keys},i.rsa.generateKeyPair=function(a,b,c,e){1===arguments.length?"object"==typeof a?(c=a,a=void 0):"function"==typeof a&&(e=a,a=void 0):2===arguments.length?("number"==typeof a?"function"==typeof b?e=b:c=b:(c=a,e=b,a=void 0),b=void 0):3===arguments.length&&("number"==typeof b?"function"==typeof c&&(e=c,c=void 0):(e=c,c=b,b=void 0)),c=c||{},void 0===a&&(a=c.bits||2048),void 0===b&&(b=c.e||65537);var f=i.rsa.createKeyPairGenerationState(a,b);return e?void d(f,c,e):(i.rsa.stepKeyPairGenerationState(f,0),f.keys)},i.setRsaPublicKey=i.rsa.setPublicKey=function(d,e){var f={n:d,e:e};return f.encrypt=function(c,d,e){if("string"==typeof d?d=d.toUpperCase():void 0===d&&(d="RSAES-PKCS1-V1_5"),"RSAES-PKCS1-V1_5"===d)d={encode:function(a,c){return b(a,c,2).getBytes()}};else if("RSA-OAEP"===d||"RSAES-OAEP"===d)d={encode:function(b,c){return a.pkcs1.encode_rsa_oaep(c,b,e)}};else{if(-1===["RAW","NONE","NULL",null].indexOf(d))throw{message:'Unsupported encryption scheme: "'+d+'".'};d={encode:function(a){return a}}}var g=d.encode(c,f,!0);return i.rsa.encrypt(g,f,!0)},f.verify=function(a,b,d){"string"==typeof d?d=d.toUpperCase():void 0===d&&(d="RSASSA-PKCS1-V1_5"),"RSASSA-PKCS1-V1_5"===d?d={verify:function(a,b){b=c(b,f,!0);var d=h.fromDer(b);return a===d.value[1].value}}:("NONE"===d||"NULL"===d||null===d)&&(d={verify:function(a,b){return b=c(b,f,!0),a===b}});var e=i.rsa.decrypt(b,f,!0,!1);return d.verify(a,e,f.n.bitLength())},f},i.setRsaPrivateKey=i.rsa.setPrivateKey=function(b,d,e,f,g,h,j,k){var l={n:b,e:d,d:e,p:f,q:g,dP:h,dQ:j,qInv:k};return l.decrypt=function(b,d,e){"string"==typeof d?d=d.toUpperCase():void 0===d&&(d="RSAES-PKCS1-V1_5");var f=i.rsa.decrypt(b,l,!1,!1);if("RSAES-PKCS1-V1_5"===d)d={decode:c};else if("RSA-OAEP"===d||"RSAES-OAEP"===d)d={decode:function(b,c){return a.pkcs1.decode_rsa_oaep(c,b,e)}};else{if(-1===["RAW","NONE","NULL",null].indexOf(d))throw{message:'Unsupported encryption scheme: "'+d+'".'};d={decode:function(a){return a}}}return d.decode(f,l,!1)},l.sign=function(a,b){var c=!1;"string"==typeof b&&(b=b.toUpperCase()),void 0===b||"RSASSA-PKCS1-V1_5"===b?(b={encode:o},c=1):("NONE"===b||"NULL"===b||null===b)&&(b={encode:function(){return a}},c=1);var d=b.encode(a,l.n.bitLength());return i.rsa.encrypt(d,l,c)},l},i.wrapRsaPrivateKey=function(a){return h.create(h.Class.UNIVERSAL,h.Type.SEQUENCE,!0,[h.create(h.Class.UNIVERSAL,h.Type.INTEGER,!1,h.integerToDer(0).getBytes()),h.create(h.Class.UNIVERSAL,h.Type.SEQUENCE,!0,[h.create(h.Class.UNIVERSAL,h.Type.OID,!1,h.oidToDer(i.oids.rsaEncryption).getBytes()),h.create(h.Class.UNIVERSAL,h.Type.NULL,!1,"")]),h.create(h.Class.UNIVERSAL,h.Type.OCTETSTRING,!1,h.toDer(a).getBytes())])},i.wrapRsaPrivateKey=function(a){return h.create(h.Class.UNIVERSAL,h.Type.SEQUENCE,!0,[h.create(h.Class.UNIVERSAL,h.Type.INTEGER,!1,h.integerToDer(0).getBytes()),h.create(h.Class.UNIVERSAL,h.Type.SEQUENCE,!0,[h.create(h.Class.UNIVERSAL,h.Type.OID,!1,h.oidToDer(i.oids.rsaEncryption).getBytes()),h.create(h.Class.UNIVERSAL,h.Type.NULL,!1,"")]),h.create(h.Class.UNIVERSAL,h.Type.OCTETSTRING,!1,h.toDer(a).getBytes())])},i.privateKeyFromAsn1=function(b){var c={},d=[];if(h.validate(b,k,c,d)&&(b=h.fromDer(a.util.createBuffer(c.privateKey))),c={},d=[],!h.validate(b,l,c,d))throw{message:"Cannot read private key. ASN.1 object does not contain an RSAPrivateKey.",errors:d};var e,f,j,m,n,o,p,q;return e=a.util.createBuffer(c.privateKeyModulus).toHex(),f=a.util.createBuffer(c.privateKeyPublicExponent).toHex(),j=a.util.createBuffer(c.privateKeyPrivateExponent).toHex(),m=a.util.createBuffer(c.privateKeyPrime1).toHex(),n=a.util.createBuffer(c.privateKeyPrime2).toHex(),o=a.util.createBuffer(c.privateKeyExponent1).toHex(),p=a.util.createBuffer(c.privateKeyExponent2).toHex(),q=a.util.createBuffer(c.privateKeyCoefficient).toHex(),i.setRsaPrivateKey(new g(e,16),new g(f,16),new g(j,16),new g(m,16),new g(n,16),new g(o,16),new g(p,16),new g(q,16))},i.privateKeyToAsn1=i.privateKeyToRSAPrivateKey=function(a){return h.create(h.Class.UNIVERSAL,h.Type.SEQUENCE,!0,[h.create(h.Class.UNIVERSAL,h.Type.INTEGER,!1,h.integerToDer(0).getBytes()),h.create(h.Class.UNIVERSAL,h.Type.INTEGER,!1,e(a.n)),h.create(h.Class.UNIVERSAL,h.Type.INTEGER,!1,e(a.e)),h.create(h.Class.UNIVERSAL,h.Type.INTEGER,!1,e(a.d)),h.create(h.Class.UNIVERSAL,h.Type.INTEGER,!1,e(a.p)),h.create(h.Class.UNIVERSAL,h.Type.INTEGER,!1,e(a.q)),h.create(h.Class.UNIVERSAL,h.Type.INTEGER,!1,e(a.dP)),h.create(h.Class.UNIVERSAL,h.Type.INTEGER,!1,e(a.dQ)),h.create(h.Class.UNIVERSAL,h.Type.INTEGER,!1,e(a.qInv))])},i.publicKeyFromAsn1=function(b){var c={},d=[];if(h.validate(b,n,c,d)){var e=h.derToOid(c.publicKeyOid);if(e!==i.oids.rsaEncryption)throw{message:"Cannot read public key. Unknown OID.",oid:e};b=c.rsaPublicKey}if(d=[],!h.validate(b,m,c,d))throw{message:"Cannot read public key. ASN.1 object does not contain an RSAPublicKey.",errors:d};var f=a.util.createBuffer(c.publicKeyModulus).toHex(),j=a.util.createBuffer(c.publicKeyExponent).toHex();return i.setRsaPublicKey(new g(f,16),new g(j,16))},i.publicKeyToAsn1=i.publicKeyToSubjectPublicKeyInfo=function(a){return h.create(h.Class.UNIVERSAL,h.Type.SEQUENCE,!0,[h.create(h.Class.UNIVERSAL,h.Type.SEQUENCE,!0,[h.create(h.Class.UNIVERSAL,h.Type.OID,!1,h.oidToDer(i.oids.rsaEncryption).getBytes()),h.create(h.Class.UNIVERSAL,h.Type.NULL,!1,"")]),h.create(h.Class.UNIVERSAL,h.Type.BITSTRING,!1,[i.publicKeyToRSAPublicKey(a)])])},i.publicKeyToRSAPublicKey=function(a){return h.create(h.Class.UNIVERSAL,h.Type.SEQUENCE,!0,[h.create(h.Class.UNIVERSAL,h.Type.INTEGER,!1,e(a.n)),h.create(h.Class.UNIVERSAL,h.Type.INTEGER,!1,e(a.e))])}}var c="rsa";if("function"!=typeof e){if("object"!=typeof b||!b.exports)return"undefined"==typeof forge&&(forge={}),a(forge);var f=!0;e=function(a,c){c(d,b)}}var g,h=function(b,d){d.exports=function(d){var e=g.map(function(a){return b(a)}).concat(a);if(d=d||{},d.defined=d.defined||{},d.defined[c])return d[c];d.defined[c]=!0;for(var f=0;f<e.length;++f)e[f](d);return d[c]}},i=e;(e=function(a,b){return g="string"==typeof a?b.slice(2):a.slice(2),f?(delete e,i.apply(null,Array.prototype.slice.call(arguments,0))):(e=i,e.apply(null,Array.prototype.slice.call(arguments,0)))})("js/rsa",["require","module","./asn1","./oids","./random","./util","./jsbn","./pkcs1"],function(){h.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function a(a){function b(a,b,d){for(var e=[c(a+b)],f=16,g=1;d>f;++g,f+=16)e.push(c(e[g-1]+a+b));return e.join("").substr(0,d)}function c(b){return a.md.md5.create().update(b).digest().getBytes()}if("undefined"==typeof d)var d=a.jsbn.BigInteger;var e=a.asn1,f=a.pki=a.pki||{};f.pbe=a.pbe=a.pbe||{};var g=f.oids,h={name:"EncryptedPrivateKeyInfo",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedPrivateKeyInfo.encryptionAlgorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"encryptionOid"},{name:"AlgorithmIdentifier.parameters",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,captureAsn1:"encryptionParams"}]},{name:"EncryptedPrivateKeyInfo.encryptedData",tagClass:e.Class.UNIVERSAL,type:e.Type.OCTETSTRING,constructed:!1,capture:"encryptedData"}]},i={name:"PBES2Algorithms",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.keyDerivationFunc",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.keyDerivationFunc.oid",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"kdfOid"},{name:"PBES2Algorithms.params",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.params.salt",tagClass:e.Class.UNIVERSAL,type:e.Type.OCTETSTRING,constructed:!1,capture:"kdfSalt"},{name:"PBES2Algorithms.params.iterationCount",tagClass:e.Class.UNIVERSAL,type:e.Type.INTEGER,onstructed:!0,capture:"kdfIterationCount"}]}]},{name:"PBES2Algorithms.encryptionScheme",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.encryptionScheme.oid",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"encOid"},{name:"PBES2Algorithms.encryptionScheme.iv",tagClass:e.Class.UNIVERSAL,type:e.Type.OCTETSTRING,constructed:!1,capture:"encIv"}]}]},j={name:"pkcs-12PbeParams",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"pkcs-12PbeParams.salt",tagClass:e.Class.UNIVERSAL,type:e.Type.OCTETSTRING,constructed:!1,capture:"salt"},{name:"pkcs-12PbeParams.iterations",tagClass:e.Class.UNIVERSAL,type:e.Type.INTEGER,constructed:!1,capture:"iterations"}]};f.encryptPrivateKeyInfo=function(b,c,d){d=d||{},d.saltSize=d.saltSize||8,d.count=d.count||2048,d.algorithm=d.algorithm||"aes128";var h,i,j,k=a.random.getBytes(d.saltSize),l=d.count,m=e.integerToDer(l);if(0===d.algorithm.indexOf("aes")){var n;if("aes128"===d.algorithm)h=16,n=g["aes128-CBC"];else if("aes192"===d.algorithm)h=24,n=g["aes192-CBC"];else{if("aes256"!==d.algorithm)throw{message:"Cannot encrypt private key. Unknown encryption algorithm.",algorithm:d.algorithm};h=32,n=g["aes256-CBC"]}var o=a.pkcs5.pbkdf2(c,k,l,h),p=a.random.getBytes(16),q=a.aes.createEncryptionCipher(o);q.start(p),q.update(e.toDer(b)),q.finish(),j=q.output.getBytes(),i=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(g.pkcs5PBES2).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(g.pkcs5PBKDF2).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OCTETSTRING,!1,k),e.create(e.Class.UNIVERSAL,e.Type.INTEGER,!1,m.getBytes())])]),e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(n).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.OCTETSTRING,!1,p)])])])}else{if("3des"!==d.algorithm)throw{message:"Cannot encrypt private key. Unknown encryption algorithm.",algorithm:d.algorithm};h=24;var r=new a.util.ByteBuffer(k),o=f.pbe.generatePkcs12Key(c,r,1,l,h),p=f.pbe.generatePkcs12Key(c,r,2,l,h),q=a.des.createEncryptionCipher(o);q.start(p),q.update(e.toDer(b)),q.finish(),j=q.output.getBytes(),i=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(g["pbeWithSHAAnd3-KeyTripleDES-CBC"]).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OCTETSTRING,!1,k),e.create(e.Class.UNIVERSAL,e.Type.INTEGER,!1,m.getBytes())])])}var s=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[i,e.create(e.Class.UNIVERSAL,e.Type.OCTETSTRING,!1,j)]);return s},f.decryptPrivateKeyInfo=function(b,c){var d=null,g={},i=[];if(!e.validate(b,h,g,i))throw{message:"Cannot read encrypted private key. ASN.1 object is not a supported EncryptedPrivateKeyInfo.",errors:i};var j=e.derToOid(g.encryptionOid),k=f.pbe.getCipher(j,g.encryptionParams,c),l=a.util.createBuffer(g.encryptedData);return k.update(l),k.finish()&&(d=e.fromDer(k.output)),d},f.encryptedPrivateKeyToPem=function(b,c){var d={type:"ENCRYPTED PRIVATE KEY",body:e.toDer(b).getBytes()};return a.pem.encode(d,{maxline:c})},f.encryptedPrivateKeyFromPem=function(b){var c=a.pem.decode(b)[0];if("ENCRYPTED PRIVATE KEY"!==c.type)throw{message:'Could not convert encrypted private key from PEM; PEM header type is "ENCRYPTED PRIVATE KEY".',headerType:c.type};if(c.procType&&"ENCRYPTED"===c.procType.type)throw{message:"Could not convert encrypted private key from PEM; PEM is encrypted."};return e.fromDer(c.body)},f.encryptRsaPrivateKey=function(c,d,g){if(g=g||{},!g.legacy){var h=f.wrapRsaPrivateKey(f.privateKeyToAsn1(c));return h=f.encryptPrivateKeyInfo(h,d,g),f.encryptedPrivateKeyToPem(h)}var i,j,k,l;switch(g.algorithm){case"aes128":i="AES-128-CBC",k=16,j=a.random.getBytes(16),l=a.aes.createEncryptionCipher;break;case"aes192":i="AES-192-CBC",k=24,j=a.random.getBytes(16),l=a.aes.createEncryptionCipher;break;case"aes256":i="AES-256-CBC",k=32,j=a.random.getBytes(16),l=a.aes.createEncryptionCipher;break;case"3des":i="DES-EDE3-CBC",k=24,j=a.random.getBytes(8),l=a.des.createEncryptionCipher;break;default:throw{message:'Could not encrypt RSA private key; unsupported encryption algorithm "'+g.algorithm+'".',algorithm:g.algorithm}}var m=b(d,j.substr(0,8),k),n=l(m);n.start(j),n.update(e.toDer(f.privateKeyToAsn1(c))),n.finish();var o={type:"RSA PRIVATE KEY",procType:{version:"4",type:"ENCRYPTED"},dekInfo:{algorithm:i,parameters:a.util.bytesToHex(j).toUpperCase()},body:n.output.getBytes()};return a.pem.encode(o)},f.decryptRsaPrivateKey=function(c,d){var g=null,h=a.pem.decode(c)[0];if("ENCRYPTED PRIVATE KEY"!==h.type&&"PRIVATE KEY"!==h.type&&"RSA PRIVATE KEY"!==h.type)throw{message:'Could not convert private key from PEM; PEM header type is not "ENCRYPTED PRIVATE KEY", "PRIVATE KEY", or "RSA PRIVATE KEY".',headerType:h.type};if(h.procType&&"ENCRYPTED"===h.procType.type){var i,j;switch(h.dekInfo.algorithm){case"DES-EDE3-CBC":i=24,j=a.des.createDecryptionCipher;break;case"AES-128-CBC":i=16,j=a.aes.createDecryptionCipher;break;case"AES-192-CBC":i=24,j=a.aes.createDecryptionCipher;break;case"AES-256-CBC":i=32,j=a.aes.createDecryptionCipher;break;case"RC2-40-CBC":i=5,j=function(b){return a.rc2.createDecryptionCipher(b,40)};break;case"RC2-64-CBC":i=8,j=function(b){return a.rc2.createDecryptionCipher(b,64)};break;case"RC2-128-CBC":i=16,j=function(b){return a.rc2.createDecryptionCipher(b,128)};break;default:throw{message:'Could not decrypt private key; unsupported encryption algorithm "'+h.dekInfo.algorithm+'".',algorithm:h.dekInfo.algorithm}}var k=a.util.hexToBytes(h.dekInfo.parameters),l=b(d,k.substr(0,8),i),m=j(l);if(m.start(k),m.update(a.util.createBuffer(h.body)),!m.finish())return g;g=m.output.getBytes()}else g=h.body;return g="ENCRYPTED PRIVATE KEY"===h.type?f.decryptPrivateKeyInfo(e.fromDer(g),d):e.fromDer(g),null!==g&&(g=f.privateKeyFromAsn1(g)),g},f.pbe.generatePkcs12Key=function(b,c,d,e,f,g){var h,i;("undefined"==typeof g||null===g)&&(g=a.md.sha1.create());var j=g.digestLength,k=g.blockLength,l=new a.util.ByteBuffer,m=new a.util.ByteBuffer;for(i=0;i<b.length;i++)m.putInt16(b.charCodeAt(i));m.putInt16(0);var n=m.length(),o=c.length(),p=new a.util.ByteBuffer;p.fillWithByte(d,k);var q=k*Math.ceil(o/k),r=new a.util.ByteBuffer;for(i=0;q>i;i++)r.putByte(c.at(i%o));var s=k*Math.ceil(n/k),t=new a.util.ByteBuffer;for(i=0;s>i;i++)t.putByte(m.at(i%n));var u=r;u.putBuffer(t);for(var v=Math.ceil(f/j),w=1;v>=w;w++){var x=new a.util.ByteBuffer;x.putBytes(p.bytes()),x.putBytes(u.bytes());for(var y=0;e>y;y++)g.start(),g.update(x.getBytes()),x=g.digest();var z=new a.util.ByteBuffer;for(i=0;k>i;i++)z.putByte(x.at(i%j));var A=Math.ceil(o/k)+Math.ceil(n/k),B=new a.util.ByteBuffer;for(h=0;A>h;h++){var C=new a.util.ByteBuffer(u.getBytes(k)),D=511;for(i=z.length()-1;i>=0;i--)D>>=8,D+=z.at(i)+C.at(i),C.setAt(i,255&D);B.putBuffer(C)}u=B,l.putBuffer(x)}return l.truncate(l.length()-f),l},f.pbe.getCipher=function(a,b,c){switch(a){case f.oids.pkcs5PBES2:return f.pbe.getCipherForPBES2(a,b,c);case f.oids["pbeWithSHAAnd3-KeyTripleDES-CBC"]:case f.oids["pbewithSHAAnd40BitRC2-CBC"]:return f.pbe.getCipherForPKCS12PBE(a,b,c);default:throw{message:"Cannot read encrypted PBE data block. Unsupported OID.",oid:a,supportedOids:["pkcs5PBES2","pbeWithSHAAnd3-KeyTripleDES-CBC","pbewithSHAAnd40BitRC2-CBC"]}}},f.pbe.getCipherForPBES2=function(b,c,d){var g={},h=[];if(!e.validate(c,i,g,h))throw{message:"Cannot read password-based-encryption algorithm parameters. ASN.1 object is not a supported EncryptedPrivateKeyInfo.",errors:h};if(b=e.derToOid(g.kdfOid),b!==f.oids.pkcs5PBKDF2)throw{message:"Cannot read encrypted private key. Unsupported key derivation function OID.",oid:b,supportedOids:["pkcs5PBKDF2"]};if(b=e.derToOid(g.encOid),b!==f.oids["aes128-CBC"]&&b!==f.oids["aes192-CBC"]&&b!==f.oids["aes256-CBC"])throw{message:"Cannot read encrypted private key. Unsupported encryption scheme OID.",oid:b,supportedOids:["aes128-CBC","aes192-CBC","aes256-CBC"]};var j=g.kdfSalt,k=a.util.createBuffer(g.kdfIterationCount);k=k.getInt(k.length()<<3);var l;b===f.oids["aes128-CBC"]?l=16:b===f.oids["aes192-CBC"]?l=24:b===f.oids["aes256-CBC"]&&(l=32);var m=a.pkcs5.pbkdf2(d,j,k,l),n=g.encIv,o=a.aes.createDecryptionCipher(m);return o.start(n),o},f.pbe.getCipherForPKCS12PBE=function(b,c,d){var g={},h=[];if(!e.validate(c,j,g,h))throw{message:"Cannot read password-based-encryption algorithm parameters. ASN.1 object is not a supported EncryptedPrivateKeyInfo.",errors:h};var i=a.util.createBuffer(g.salt),k=a.util.createBuffer(g.iterations);k=k.getInt(k.length()<<3);var l,m,n;switch(b){case f.oids["pbeWithSHAAnd3-KeyTripleDES-CBC"]:l=24,m=8,n=a.des.startDecrypting;break;case f.oids["pbewithSHAAnd40BitRC2-CBC"]:l=5,m=8,n=function(b,c){var d=a.rc2.createDecryptionCipher(b,40);return d.start(c,null),d};break;default:throw{message:"Cannot read PKCS #12 PBE data block. Unsupported OID.",oid:b}}var o=f.pbe.generatePkcs12Key(d,i,1,k,l),p=f.pbe.generatePkcs12Key(d,i,2,k,m);return n(o,p)}}var c="pbe";if("function"!=typeof e){if("object"!=typeof b||!b.exports)return"undefined"==typeof forge&&(forge={}),a(forge);var f=!0;e=function(a,c){c(d,b)}}var g,h=function(b,d){d.exports=function(d){var e=g.map(function(a){return b(a)}).concat(a);if(d=d||{},d.defined=d.defined||{},d.defined[c])return d[c];d.defined[c]=!0;for(var f=0;f<e.length;++f)e[f](d);return d[c]}},i=e;(e=function(a,b){return g="string"==typeof a?b.slice(2):a.slice(2),f?(delete e,i.apply(null,Array.prototype.slice.call(arguments,0))):(e=i,e.apply(null,Array.prototype.slice.call(arguments,0)))})("js/pbe",["require","module","./aes","./asn1","./des","./md","./oids","./pem","./pbkdf2","./random","./rc2","./rsa","./util"],function(){h.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function a(a){var b=a.asn1,c=a.pkcs7asn1=a.pkcs7asn1||{};a.pkcs7=a.pkcs7||{},a.pkcs7.asn1=c;var d={name:"ContentInfo",tagClass:b.Class.UNIVERSAL,type:b.Type.SEQUENCE,constructed:!0,value:[{name:"ContentInfo.ContentType",tagClass:b.Class.UNIVERSAL,type:b.Type.OID,constructed:!1,capture:"contentType"},{name:"ContentInfo.content",tagClass:b.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,captureAsn1:"content"}]};c.contentInfoValidator=d;var e={name:"EncryptedContentInfo",tagClass:b.Class.UNIVERSAL,type:b.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedContentInfo.contentType",tagClass:b.Class.UNIVERSAL,type:b.Type.OID,constructed:!1,capture:"contentType"},{name:"EncryptedContentInfo.contentEncryptionAlgorithm",tagClass:b.Class.UNIVERSAL,type:b.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedContentInfo.contentEncryptionAlgorithm.algorithm",tagClass:b.Class.UNIVERSAL,type:b.Type.OID,constructed:!1,capture:"encAlgorithm"},{name:"EncryptedContentInfo.contentEncryptionAlgorithm.parameter",tagClass:b.Class.UNIVERSAL,captureAsn1:"encParameter"}]},{name:"EncryptedContentInfo.encryptedContent",tagClass:b.Class.CONTEXT_SPECIFIC,type:0,capture:"encryptedContent"}]};c.envelopedDataValidator={name:"EnvelopedData",tagClass:b.Class.UNIVERSAL,type:b.Type.SEQUENCE,constructed:!0,value:[{name:"EnvelopedData.Version",tagClass:b.Class.UNIVERSAL,type:b.Type.INTEGER,constructed:!1,capture:"version"},{name:"EnvelopedData.RecipientInfos",tagClass:b.Class.UNIVERSAL,type:b.Type.SET,constructed:!0,captureAsn1:"recipientInfos"}].concat(e)},c.encryptedDataValidator={name:"EncryptedData",tagClass:b.Class.UNIVERSAL,type:b.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedData.Version",tagClass:b.Class.UNIVERSAL,type:b.Type.INTEGER,constructed:!1,capture:"version"}].concat(e)};var f={name:"SignerInfo",tagClass:b.Class.UNIVERSAL,type:b.Type.SEQUENCE,constructed:!0,value:[{name:"SignerInfo.Version",tagClass:b.Class.UNIVERSAL,type:b.Type.INTEGER,constructed:!1},{name:"SignerInfo.IssuerAndSerialNumber",tagClass:b.Class.UNIVERSAL,type:b.Type.SEQUENCE,constructed:!0},{name:"SignerInfo.DigestAlgorithm",tagClass:b.Class.UNIVERSAL,type:b.Type.SEQUENCE,constructed:!0},{name:"SignerInfo.AuthenticatedAttributes",tagClass:b.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,capture:"authenticatedAttributes"},{name:"SignerInfo.DigestEncryptionAlgorithm",tagClass:b.Class.UNIVERSAL,type:b.Type.SEQUENCE,constructed:!0},{name:"SignerInfo.EncryptedDigest",tagClass:b.Class.UNIVERSAL,type:b.Type.OCTETSTRING,constructed:!1,capture:"signature"},{name:"SignerInfo.UnauthenticatedAttributes",tagClass:b.Class.CONTEXT_SPECIFIC,type:1,constructed:!0,optional:!0}]};c.signedDataValidator={name:"SignedData",tagClass:b.Class.UNIVERSAL,type:b.Type.SEQUENCE,constructed:!0,value:[{name:"SignedData.Version",tagClass:b.Class.UNIVERSAL,type:b.Type.INTEGER,constructed:!1,capture:"version"},{name:"SignedData.DigestAlgorithms",tagClass:b.Class.UNIVERSAL,type:b.Type.SET,constructed:!0,captureAsn1:"digestAlgorithms"},d,{name:"SignedData.Certificates",tagClass:b.Class.CONTEXT_SPECIFIC,type:0,optional:!0,captureAsn1:"certificates"},{name:"SignedData.CertificateRevocationLists",tagClass:b.Class.CONTEXT_SPECIFIC,type:1,optional:!0,captureAsn1:"crls"},{name:"SignedData.SignerInfos",tagClass:b.Class.UNIVERSAL,type:b.Type.SET,capture:"signerInfos",optional:!0,value:[f]}]},c.recipientInfoValidator={name:"RecipientInfo",tagClass:b.Class.UNIVERSAL,type:b.Type.SEQUENCE,constructed:!0,value:[{name:"RecipientInfo.version",tagClass:b.Class.UNIVERSAL,type:b.Type.INTEGER,constructed:!1,capture:"version"},{name:"RecipientInfo.issuerAndSerial",tagClass:b.Class.UNIVERSAL,type:b.Type.SEQUENCE,constructed:!0,value:[{name:"RecipientInfo.issuerAndSerial.issuer",tagClass:b.Class.UNIVERSAL,type:b.Type.SEQUENCE,constructed:!0,captureAsn1:"issuer"},{name:"RecipientInfo.issuerAndSerial.serialNumber",tagClass:b.Class.UNIVERSAL,type:b.Type.INTEGER,constructed:!1,capture:"serial"}]},{name:"RecipientInfo.keyEncryptionAlgorithm",tagClass:b.Class.UNIVERSAL,type:b.Type.SEQUENCE,constructed:!0,value:[{name:"RecipientInfo.keyEncryptionAlgorithm.algorithm",tagClass:b.Class.UNIVERSAL,type:b.Type.OID,constructed:!1,capture:"encAlgorithm"},{name:"RecipientInfo.keyEncryptionAlgorithm.parameter",tagClass:b.Class.UNIVERSAL,constructed:!1,captureAsn1:"encParameter"}]},{name:"RecipientInfo.encryptedKey",tagClass:b.Class.UNIVERSAL,type:b.Type.OCTETSTRING,constructed:!1,capture:"encKey"}]}
}var c="pkcs7asn1";if("function"!=typeof e){if("object"!=typeof b||!b.exports)return"undefined"==typeof forge&&(forge={}),a(forge);var f=!0;e=function(a,c){c(d,b)}}var g,h=function(b,d){d.exports=function(d){var e=g.map(function(a){return b(a)}).concat(a);if(d=d||{},d.defined=d.defined||{},d.defined[c])return d[c];d.defined[c]=!0;for(var f=0;f<e.length;++f)e[f](d);return d[c]}},i=e;(e=function(a,b){return g="string"==typeof a?b.slice(2):a.slice(2),f?(delete e,i.apply(null,Array.prototype.slice.call(arguments,0))):(e=i,e.apply(null,Array.prototype.slice.call(arguments,0)))})("js/pkcs7asn1",["require","module","./asn1","./util"],function(){h.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function a(a){a.mgf=a.mgf||{};var b=a.mgf.mgf1=a.mgf1=a.mgf1||{};b.create=function(b){var c={generate:function(c,d){for(var e=new a.util.ByteBuffer,f=Math.ceil(d/b.digestLength),g=0;f>g;g++){var h=new a.util.ByteBuffer;h.putInt32(g),b.start(),b.update(c+h.getBytes()),e.putBuffer(b.digest())}return e.truncate(e.length()-d),e.getBytes()}};return c}}var c="mgf1";if("function"!=typeof e){if("object"!=typeof b||!b.exports)return"undefined"==typeof forge&&(forge={}),a(forge);var f=!0;e=function(a,c){c(d,b)}}var g,h=function(b,d){d.exports=function(d){var e=g.map(function(a){return b(a)}).concat(a);if(d=d||{},d.defined=d.defined||{},d.defined[c])return d[c];d.defined[c]=!0;for(var f=0;f<e.length;++f)e[f](d);return d[c]}},i=e;(e=function(a,b){return g="string"==typeof a?b.slice(2):a.slice(2),f?(delete e,i.apply(null,Array.prototype.slice.call(arguments,0))):(e=i,e.apply(null,Array.prototype.slice.call(arguments,0)))})("js/mgf1",["require","module","./util"],function(){h.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function a(a){a.mgf=a.mgf||{},a.mgf.mgf1=a.mgf1}var c="mgf";if("function"!=typeof e){if("object"!=typeof b||!b.exports)return"undefined"==typeof forge&&(forge={}),a(forge);var f=!0;e=function(a,c){c(d,b)}}var g,h=function(b,d){d.exports=function(d){var e=g.map(function(a){return b(a)}).concat(a);if(d=d||{},d.defined=d.defined||{},d.defined[c])return d[c];d.defined[c]=!0;for(var f=0;f<e.length;++f)e[f](d);return d[c]}},i=e;(e=function(a,b){return g="string"==typeof a?b.slice(2):a.slice(2),f?(delete e,i.apply(null,Array.prototype.slice.call(arguments,0))):(e=i,e.apply(null,Array.prototype.slice.call(arguments,0)))})("js/mgf",["require","module","./mgf1"],function(){h.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function a(a){var b=a.pss=a.pss||{};b.create=function(b,c,d){var e=b.digestLength,f={};return f.verify=function(f,g,h){var i,j=h-1,k=Math.ceil(j/8);if(g=g.substr(-k),e+d+2>k)throw{message:"Inconsistent parameters to PSS signature verification."};if(188!==g.charCodeAt(k-1))throw{message:"Encoded message does not end in 0xBC."};var l=k-e-1,m=g.substr(0,l),n=g.substr(l,e),o=65280>>8*k-j&255;if(0!==(m.charCodeAt(0)&o))throw{message:"Bits beyond keysize not zero as expected."};var p=c.generate(n,l),q="";for(i=0;l>i;i++)q+=String.fromCharCode(m.charCodeAt(i)^p.charCodeAt(i));q=String.fromCharCode(q.charCodeAt(0)&~o)+q.substr(1);var r=k-e-d-2;for(i=0;r>i;i++)if(0!==q.charCodeAt(i))throw{message:"Leftmost octets not zero as expected"};if(1!==q.charCodeAt(r))throw{message:"Inconsistent PSS signature, 0x01 marker not found"};var s=q.substr(-d),t=new a.util.ByteBuffer;t.fillWithByte(0,8),t.putBytes(f),t.putBytes(s),b.start(),b.update(t.getBytes());var u=b.digest().getBytes();return n===u},f.encode=function(f,g){var h,i=g-1,j=Math.ceil(i/8),k=f.digest().getBytes();if(e+d+2>j)throw{message:"Message is too long to encrypt"};var l=a.random.getBytes(d),m=new a.util.ByteBuffer;m.fillWithByte(0,8),m.putBytes(k),m.putBytes(l),b.start(),b.update(m.getBytes());var n=b.digest().getBytes(),o=new a.util.ByteBuffer;o.fillWithByte(0,j-d-e-2),o.putByte(1),o.putBytes(l);var p=o.getBytes(),q=j-e-1,r=c.generate(n,q),s="";for(h=0;q>h;h++)s+=String.fromCharCode(p.charCodeAt(h)^r.charCodeAt(h));var t=65280>>8*j-i&255;return s=String.fromCharCode(s.charCodeAt(0)&~t)+s.substr(1),s+n+String.fromCharCode(188)},f}}var c="pss";if("function"!=typeof e){if("object"!=typeof b||!b.exports)return"undefined"==typeof forge&&(forge={}),a(forge);var f=!0;e=function(a,c){c(d,b)}}var g,h=function(b,d){d.exports=function(d){var e=g.map(function(a){return b(a)}).concat(a);if(d=d||{},d.defined=d.defined||{},d.defined[c])return d[c];d.defined[c]=!0;for(var f=0;f<e.length;++f)e[f](d);return d[c]}},i=e;(e=function(a,b){return g="string"==typeof a?b.slice(2):a.slice(2),f?(delete e,i.apply(null,Array.prototype.slice.call(arguments,0))):(e=i,e.apply(null,Array.prototype.slice.call(arguments,0)))})("js/pss",["require","module","./random","./util"],function(){h.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function a(a){function b(a,b){"string"==typeof b&&(b={shortName:b});for(var c,d=null,e=0;null===d&&e<a.attributes.length;++e)c=a.attributes[e],b.type&&b.type===c.type?d=c:b.name&&b.name===c.name?d=c:b.shortName&&b.shortName===c.shortName&&(d=c);return d}function c(b){for(var c,d,e=h.create(h.Class.UNIVERSAL,h.Type.SEQUENCE,!0,[]),f=b.attributes,g=0;g<f.length;++g){c=f[g];var i=c.value,j=h.Type.PRINTABLESTRING;"valueTagClass"in c&&(j=c.valueTagClass,j===h.Type.UTF8&&(i=a.util.encodeUtf8(i))),d=h.create(h.Class.UNIVERSAL,h.Type.SET,!0,[h.create(h.Class.UNIVERSAL,h.Type.SEQUENCE,!0,[h.create(h.Class.UNIVERSAL,h.Type.OID,!1,h.oidToDer(c.type).getBytes()),h.create(h.Class.UNIVERSAL,j,!1,i)])]),e.value.push(d)}return e}function d(a){var b=h.create(h.Class.CONTEXT_SPECIFIC,3,!0,[]),c=h.create(h.Class.UNIVERSAL,h.Type.SEQUENCE,!0,[]);b.value.push(c);for(var d,e,f=0;f<a.length;++f){d=a[f],e=h.create(h.Class.UNIVERSAL,h.Type.SEQUENCE,!0,[]),c.value.push(e),e.value.push(h.create(h.Class.UNIVERSAL,h.Type.OID,!1,h.oidToDer(d.id).getBytes())),d.critical&&e.value.push(h.create(h.Class.UNIVERSAL,h.Type.BOOLEAN,!1,String.fromCharCode(255)));var g=d.value;"string"!=typeof d.value&&(g=h.toDer(g).getBytes()),e.value.push(h.create(h.Class.UNIVERSAL,h.Type.OCTETSTRING,!1,g))}return b}function e(a){for(var b,c=0;c<a.length;++c){if(b=a[c],"undefined"==typeof b.name&&(b.type&&b.type in i.oids?b.name=i.oids[b.type]:b.shortName&&b.shortName in k&&(b.name=i.oids[k[b.shortName]])),"undefined"==typeof b.type){if(!(b.name&&b.name in i.oids))throw{message:"Attribute type not specified.",attribute:b};b.type=i.oids[b.name]}if("undefined"==typeof b.shortName&&b.name&&b.name in k&&(b.shortName=k[b.name]),"undefined"==typeof b.value)throw{message:"Attribute value not specified.",attribute:b}}}function f(a,b){switch(a){case j["RSASSA-PSS"]:var c=[];return void 0!==b.hash.algorithmOid&&c.push(h.create(h.Class.CONTEXT_SPECIFIC,0,!0,[h.create(h.Class.UNIVERSAL,h.Type.SEQUENCE,!0,[h.create(h.Class.UNIVERSAL,h.Type.OID,!1,h.oidToDer(b.hash.algorithmOid).getBytes()),h.create(h.Class.UNIVERSAL,h.Type.NULL,!1,"")])])),void 0!==b.mgf.algorithmOid&&c.push(h.create(h.Class.CONTEXT_SPECIFIC,1,!0,[h.create(h.Class.UNIVERSAL,h.Type.SEQUENCE,!0,[h.create(h.Class.UNIVERSAL,h.Type.OID,!1,h.oidToDer(b.mgf.algorithmOid).getBytes()),h.create(h.Class.UNIVERSAL,h.Type.SEQUENCE,!0,[h.create(h.Class.UNIVERSAL,h.Type.OID,!1,h.oidToDer(b.mgf.hash.algorithmOid).getBytes()),h.create(h.Class.UNIVERSAL,h.Type.NULL,!1,"")])])])),void 0!==b.saltLength&&c.push(h.create(h.Class.CONTEXT_SPECIFIC,2,!0,[h.create(h.Class.UNIVERSAL,h.Type.INTEGER,!1,h.integerToDer(b.saltLength).getBytes())])),h.create(h.Class.UNIVERSAL,h.Type.SEQUENCE,!0,c);default:return h.create(h.Class.UNIVERSAL,h.Type.NULL,!1,"")}}function g(b){var c=h.create(h.Class.CONTEXT_SPECIFIC,0,!0,[]);if(0===b.attributes.length)return c;for(var d=b.attributes,e=0;e<d.length;++e){var f=d[e],g=f.value,i=h.Type.UTF8;"valueTagClass"in f&&(i=f.valueTagClass),i===h.Type.UTF8&&(g=a.util.encodeUtf8(g));var j=h.create(h.Class.UNIVERSAL,h.Type.SEQUENCE,!0,[h.create(h.Class.UNIVERSAL,h.Type.OID,!1,h.oidToDer(f.type).getBytes()),h.create(h.Class.UNIVERSAL,h.Type.SET,!0,[h.create(h.Class.UNIVERSAL,i,!1,g)])]);c.value.push(j)}return c}var h=a.asn1,i=a.pki=a.pki||{},j=i.oids,k={};k.CN=j.commonName,k.commonName="CN",k.C=j.countryName,k.countryName="C",k.L=j.localityName,k.localityName="L",k.ST=j.stateOrProvinceName,k.stateOrProvinceName="ST",k.O=j.organizationName,k.organizationName="O",k.OU=j.organizationalUnitName,k.organizationalUnitName="OU",k.E=j.emailAddress,k.emailAddress="E";var l=a.pki.rsa.publicKeyValidator,m={name:"Certificate",tagClass:h.Class.UNIVERSAL,type:h.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.TBSCertificate",tagClass:h.Class.UNIVERSAL,type:h.Type.SEQUENCE,constructed:!0,captureAsn1:"tbsCertificate",value:[{name:"Certificate.TBSCertificate.version",tagClass:h.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,value:[{name:"Certificate.TBSCertificate.version.integer",tagClass:h.Class.UNIVERSAL,type:h.Type.INTEGER,constructed:!1,capture:"certVersion"}]},{name:"Certificate.TBSCertificate.serialNumber",tagClass:h.Class.UNIVERSAL,type:h.Type.INTEGER,constructed:!1,capture:"certSerialNumber"},{name:"Certificate.TBSCertificate.signature",tagClass:h.Class.UNIVERSAL,type:h.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.TBSCertificate.signature.algorithm",tagClass:h.Class.UNIVERSAL,type:h.Type.OID,constructed:!1,capture:"certinfoSignatureOid"},{name:"Certificate.TBSCertificate.signature.parameters",tagClass:h.Class.UNIVERSAL,optional:!0,captureAsn1:"certinfoSignatureParams"}]},{name:"Certificate.TBSCertificate.issuer",tagClass:h.Class.UNIVERSAL,type:h.Type.SEQUENCE,constructed:!0,captureAsn1:"certIssuer"},{name:"Certificate.TBSCertificate.validity",tagClass:h.Class.UNIVERSAL,type:h.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.TBSCertificate.validity.notBefore (utc)",tagClass:h.Class.UNIVERSAL,type:h.Type.UTCTIME,constructed:!1,optional:!0,capture:"certValidity1UTCTime"},{name:"Certificate.TBSCertificate.validity.notBefore (generalized)",tagClass:h.Class.UNIVERSAL,type:h.Type.GENERALIZEDTIME,constructed:!1,optional:!0,capture:"certValidity2GeneralizedTime"},{name:"Certificate.TBSCertificate.validity.notAfter (utc)",tagClass:h.Class.UNIVERSAL,type:h.Type.UTCTIME,constructed:!1,optional:!0,capture:"certValidity3UTCTime"},{name:"Certificate.TBSCertificate.validity.notAfter (generalized)",tagClass:h.Class.UNIVERSAL,type:h.Type.GENERALIZEDTIME,constructed:!1,optional:!0,capture:"certValidity4GeneralizedTime"}]},{name:"Certificate.TBSCertificate.subject",tagClass:h.Class.UNIVERSAL,type:h.Type.SEQUENCE,constructed:!0,captureAsn1:"certSubject"},l,{name:"Certificate.TBSCertificate.issuerUniqueID",tagClass:h.Class.CONTEXT_SPECIFIC,type:1,constructed:!0,optional:!0,value:[{name:"Certificate.TBSCertificate.issuerUniqueID.id",tagClass:h.Class.UNIVERSAL,type:h.Type.BITSTRING,constructed:!1,capture:"certIssuerUniqueId"}]},{name:"Certificate.TBSCertificate.subjectUniqueID",tagClass:h.Class.CONTEXT_SPECIFIC,type:2,constructed:!0,optional:!0,value:[{name:"Certificate.TBSCertificate.subjectUniqueID.id",tagClass:h.Class.UNIVERSAL,type:h.Type.BITSTRING,constructed:!1,capture:"certSubjectUniqueId"}]},{name:"Certificate.TBSCertificate.extensions",tagClass:h.Class.CONTEXT_SPECIFIC,type:3,constructed:!0,captureAsn1:"certExtensions",optional:!0}]},{name:"Certificate.signatureAlgorithm",tagClass:h.Class.UNIVERSAL,type:h.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.signatureAlgorithm.algorithm",tagClass:h.Class.UNIVERSAL,type:h.Type.OID,constructed:!1,capture:"certSignatureOid"},{name:"Certificate.TBSCertificate.signature.parameters",tagClass:h.Class.UNIVERSAL,optional:!0,captureAsn1:"certSignatureParams"}]},{name:"Certificate.signatureValue",tagClass:h.Class.UNIVERSAL,type:h.Type.BITSTRING,constructed:!1,capture:"certSignature"}]},n={name:"rsapss",tagClass:h.Class.UNIVERSAL,type:h.Type.SEQUENCE,constructed:!0,value:[{name:"rsapss.hashAlgorithm",tagClass:h.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,value:[{name:"rsapss.hashAlgorithm.AlgorithmIdentifier",tagClass:h.Class.UNIVERSAL,type:h.Class.SEQUENCE,constructed:!0,optional:!0,value:[{name:"rsapss.hashAlgorithm.AlgorithmIdentifier.algorithm",tagClass:h.Class.UNIVERSAL,type:h.Type.OID,constructed:!1,capture:"hashOid"}]}]},{name:"rsapss.maskGenAlgorithm",tagClass:h.Class.CONTEXT_SPECIFIC,type:1,constructed:!0,value:[{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier",tagClass:h.Class.UNIVERSAL,type:h.Class.SEQUENCE,constructed:!0,optional:!0,value:[{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier.algorithm",tagClass:h.Class.UNIVERSAL,type:h.Type.OID,constructed:!1,capture:"maskGenOid"},{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier.params",tagClass:h.Class.UNIVERSAL,type:h.Type.SEQUENCE,constructed:!0,value:[{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier.params.algorithm",tagClass:h.Class.UNIVERSAL,type:h.Type.OID,constructed:!1,capture:"maskGenHashOid"}]}]}]},{name:"rsapss.saltLength",tagClass:h.Class.CONTEXT_SPECIFIC,type:2,optional:!0,value:[{name:"rsapss.saltLength.saltLength",tagClass:h.Class.UNIVERSAL,type:h.Class.INTEGER,constructed:!1,capture:"saltLength"}]},{name:"rsapss.trailerField",tagClass:h.Class.CONTEXT_SPECIFIC,type:3,optional:!0,value:[{name:"rsapss.trailer.trailer",tagClass:h.Class.UNIVERSAL,type:h.Class.INTEGER,constructed:!1,capture:"trailer"}]}]},o={name:"CertificationRequestInfo",tagClass:h.Class.UNIVERSAL,type:h.Type.SEQUENCE,constructed:!0,captureAsn1:"certificationRequestInfo",value:[{name:"CertificationRequestInfo.integer",tagClass:h.Class.UNIVERSAL,type:h.Type.INTEGER,constructed:!1,capture:"certificationRequestInfoVersion"},{name:"CertificationRequestInfo.subject",tagClass:h.Class.UNIVERSAL,type:h.Type.SEQUENCE,constructed:!0,captureAsn1:"certificationRequestInfoSubject"},l,{name:"CertificationRequestInfo.attributes",tagClass:h.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,capture:"certificationRequestInfoAttributes",value:[{name:"CertificationRequestInfo.attributes",tagClass:h.Class.UNIVERSAL,type:h.Type.SEQUENCE,constructed:!0,value:[{name:"CertificationRequestInfo.attributes.type",tagClass:h.Class.UNIVERSAL,type:h.Type.OID,constructed:!1},{name:"CertificationRequestInfo.attributes.value",tagClass:h.Class.UNIVERSAL,type:h.Type.SET,constructed:!0}]}]}]},p={name:"CertificationRequest",tagClass:h.Class.UNIVERSAL,type:h.Type.SEQUENCE,constructed:!0,captureAsn1:"csr",value:[o,{name:"CertificationRequest.signatureAlgorithm",tagClass:h.Class.UNIVERSAL,type:h.Type.SEQUENCE,constructed:!0,value:[{name:"CertificationRequest.signatureAlgorithm.algorithm",tagClass:h.Class.UNIVERSAL,type:h.Type.OID,constructed:!1,capture:"csrSignatureOid"},{name:"CertificationRequest.signatureAlgorithm.parameters",tagClass:h.Class.UNIVERSAL,optional:!0,captureAsn1:"csrSignatureParams"}]},{name:"CertificationRequest.signature",tagClass:h.Class.UNIVERSAL,type:h.Type.BITSTRING,constructed:!1,capture:"csrSignature"}]};i.RDNAttributesAsArray=function(a,b){for(var c,d,e,f=[],g=0;g<a.value.length;++g){c=a.value[g];for(var i=0;i<c.value.length;++i)e={},d=c.value[i],e.type=h.derToOid(d.value[0].value),e.value=d.value[1].value,e.valueTagClass=d.value[1].type,e.type in j&&(e.name=j[e.type],e.name in k&&(e.shortName=k[e.name])),b&&(b.update(e.type),b.update(e.value)),f.push(e)}return f},i.CRIAttributesAsArray=function(a){for(var b=[],c=0;c<a.length;++c)for(var d=a[c],e=h.derToOid(d.value[0].value),f=d.value[1].value,g=0;g<f.length;++g){var i={};i.type=e,i.value=f[g].value,i.valueTagClass=f[g].type,i.type in j&&(i.name=j[i.type],i.name in k&&(i.shortName=k[i.name])),b.push(i)}return b};var q=function(b){for(var c,d,e,f=[],g=0;g<b.value.length;++g){e=b.value[g];for(var i=0;i<e.value.length;++i){if(d=e.value[i],c={},c.id=h.derToOid(d.value[0].value),c.critical=!1,d.value[1].type===h.Type.BOOLEAN?(c.critical=0!==d.value[1].value.charCodeAt(0),c.value=d.value[2].value):c.value=d.value[1].value,c.id in j)if(c.name=j[c.id],"keyUsage"===c.name){var k=h.fromDer(c.value),l=0,m=0;k.value.length>1&&(l=k.value.charCodeAt(1),m=k.value.length>2?k.value.charCodeAt(2):0),c.digitalSignature=128===(128&l),c.nonRepudiation=64===(64&l),c.keyEncipherment=32===(32&l),c.dataEncipherment=16===(16&l),c.keyAgreement=8===(8&l),c.keyCertSign=4===(4&l),c.cRLSign=2===(2&l),c.encipherOnly=1===(1&l),c.decipherOnly=128===(128&m)}else if("basicConstraints"===c.name){var k=h.fromDer(c.value);c.cA=k.value.length>0&&k.value[0].type===h.Type.BOOLEAN?0!==k.value[0].value.charCodeAt(0):!1;var n=null;k.value.length>0&&k.value[0].type===h.Type.INTEGER?n=k.value[0].value:k.value.length>1&&(n=k.value[1].value),null!==n&&(c.pathLenConstraint=h.derToInteger(n))}else if("extKeyUsage"===c.name)for(var k=h.fromDer(c.value),o=0;o<k.value.length;++o){var p=h.derToOid(k.value[o].value);p in j?c[j[p]]=!0:c[p]=!0}else if("nsCertType"===c.name){var k=h.fromDer(c.value),l=0;k.value.length>1&&(l=k.value.charCodeAt(1)),c.client=128===(128&l),c.server=64===(64&l),c.email=32===(32&l),c.objsign=16===(16&l),c.reserved=8===(8&l),c.sslCA=4===(4&l),c.emailCA=2===(2&l),c.objCA=1===(1&l)}else if("subjectAltName"===c.name||"issuerAltName"===c.name){c.altNames=[];for(var q,k=h.fromDer(c.value),r=0;r<k.value.length;++r){q=k.value[r];var s={type:q.type,value:q.value};switch(c.altNames.push(s),q.type){case 1:case 2:case 6:break;case 7:s.ip=a.util.bytesToIP(q.value);break;case 8:s.oid=h.derToOid(q.value)}}}else if("subjectKeyIdentifier"===c.name){var k=h.fromDer(c.value);c.subjectKeyIdentifier=a.util.bytesToHex(k.value)}f.push(c)}}return f},r=function(a,b,c){var d={};if(a!==j["RSASSA-PSS"])return d;c&&(d={hash:{algorithmOid:j.sha1},mgf:{algorithmOid:j.mgf1,hash:{algorithmOid:j.sha1}},saltLength:20});var e={},f=[];if(!h.validate(b,n,e,f))throw{message:"Cannot read RSASSA-PSS parameter block.",errors:f};return void 0!==e.hashOid&&(d.hash=d.hash||{},d.hash.algorithmOid=h.derToOid(e.hashOid)),void 0!==e.maskGenOid&&(d.mgf=d.mgf||{},d.mgf.algorithmOid=h.derToOid(e.maskGenOid),d.mgf.hash=d.mgf.hash||{},d.mgf.hash.algorithmOid=h.derToOid(e.maskGenHashOid)),void 0!==e.saltLength&&(d.saltLength=e.saltLength.charCodeAt(0)),d};i.certificateFromPem=function(b,c,d){var e=a.pem.decode(b)[0];if("CERTIFICATE"!==e.type&&"X509 CERTIFICATE"!==e.type&&"TRUSTED CERTIFICATE"!==e.type)throw{message:'Could not convert certificate from PEM; PEM header type is not "CERTIFICATE", "X509 CERTIFICATE", or "TRUSTED CERTIFICATE".',headerType:e.type};if(e.procType&&"ENCRYPTED"===e.procType.type)throw{message:"Could not convert certificate from PEM; PEM is encrypted."};var f=h.fromDer(e.body,d);return i.certificateFromAsn1(f,c)},i.certificateToPem=function(b,c){var d={type:"CERTIFICATE",body:h.toDer(i.certificateToAsn1(b)).getBytes()};return a.pem.encode(d,{maxline:c})},i.publicKeyFromPem=function(b){var c=a.pem.decode(b)[0];if("PUBLIC KEY"!==c.type&&"RSA PUBLIC KEY"!==c.type)throw{message:'Could not convert public key from PEM; PEM header type is not "PUBLIC KEY" or "RSA PUBLIC KEY".',headerType:c.type};if(c.procType&&"ENCRYPTED"===c.procType.type)throw{message:"Could not convert public key from PEM; PEM is encrypted."};var d=h.fromDer(c.body);return i.publicKeyFromAsn1(d)},i.publicKeyToPem=function(b,c){var d={type:"PUBLIC KEY",body:h.toDer(i.publicKeyToAsn1(b)).getBytes()};return a.pem.encode(d,{maxline:c})},i.publicKeyToRSAPublicKeyPem=function(b,c){var d={type:"RSA PUBLIC KEY",body:h.toDer(i.publicKeyToRSAPublicKey(b)).getBytes()};return a.pem.encode(d,{maxline:c})},i.certificationRequestFromPem=function(b,c,d){var e=a.pem.decode(b)[0];if("CERTIFICATE REQUEST"!==e.type)throw{message:'Could not convert certification request from PEM; PEM header type is not "CERTIFICATE REQUEST".',headerType:e.type};if(e.procType&&"ENCRYPTED"===e.procType.type)throw{message:"Could not convert certification request from PEM; PEM is encrypted."};var f=h.fromDer(e.body,d);return i.certificationRequestFromAsn1(f,c)},i.certificationRequestToPem=function(b,c){var d={type:"CERTIFICATE REQUEST",body:h.toDer(i.certificationRequestToAsn1(b)).getBytes()};return a.pem.encode(d,{maxline:c})},i.createCertificate=function(){var c={};return c.version=2,c.serialNumber="00",c.signatureOid=null,c.signature=null,c.siginfo={},c.siginfo.algorithmOid=null,c.validity={},c.validity.notBefore=new Date,c.validity.notAfter=new Date,c.issuer={},c.issuer.getField=function(a){return b(c.issuer,a)},c.issuer.addField=function(a){e([a]),c.issuer.attributes.push(a)},c.issuer.attributes=[],c.issuer.hash=null,c.subject={},c.subject.getField=function(a){return b(c.subject,a)},c.subject.addField=function(a){e([a]),c.subject.attributes.push(a)},c.subject.attributes=[],c.subject.hash=null,c.extensions=[],c.publicKey=null,c.md=null,c.setSubject=function(a,b){e(a),c.subject.attributes=a,delete c.subject.uniqueId,b&&(c.subject.uniqueId=b),c.subject.hash=null},c.setIssuer=function(a,b){e(a),c.issuer.attributes=a,delete c.issuer.uniqueId,b&&(c.issuer.uniqueId=b),c.issuer.hash=null},c.setExtensions=function(b){for(var d,e=0;e<b.length;++e){if(d=b[e],"undefined"==typeof d.name&&d.id&&d.id in i.oids&&(d.name=i.oids[d.id]),"undefined"==typeof d.id){if(!(d.name&&d.name in i.oids))throw{message:"Extension ID not specified.",extension:d};d.id=i.oids[d.name]}if("undefined"==typeof d.value){if("keyUsage"===d.name){var f=0,g=0,k=0;d.digitalSignature&&(g|=128,f=7),d.nonRepudiation&&(g|=64,f=6),d.keyEncipherment&&(g|=32,f=5),d.dataEncipherment&&(g|=16,f=4),d.keyAgreement&&(g|=8,f=3),d.keyCertSign&&(g|=4,f=2),d.cRLSign&&(g|=2,f=1),d.encipherOnly&&(g|=1,f=0),d.decipherOnly&&(k|=128,f=7);var l=String.fromCharCode(f);0!==k?l+=String.fromCharCode(g)+String.fromCharCode(k):0!==g&&(l+=String.fromCharCode(g)),d.value=h.create(h.Class.UNIVERSAL,h.Type.BITSTRING,!1,l)}else if("basicConstraints"===d.name)d.value=h.create(h.Class.UNIVERSAL,h.Type.SEQUENCE,!0,[]),d.cA&&d.value.value.push(h.create(h.Class.UNIVERSAL,h.Type.BOOLEAN,!1,String.fromCharCode(255))),"pathLenConstraint"in d&&d.value.value.push(h.create(h.Class.UNIVERSAL,h.Type.INTEGER,!1,h.integerToDer(d.pathLenConstraint).getBytes()));else if("extKeyUsage"===d.name){d.value=h.create(h.Class.UNIVERSAL,h.Type.SEQUENCE,!0,[]);var m=d.value.value;for(var n in d)d[n]===!0&&(n in j?m.push(h.create(h.Class.UNIVERSAL,h.Type.OID,!1,h.oidToDer(j[n]).getBytes())):-1!==n.indexOf(".")&&m.push(h.create(h.Class.UNIVERSAL,h.Type.OID,!1,h.oidToDer(n).getBytes())))}else if("nsCertType"===d.name){var f=0,g=0;d.client&&(g|=128,f=7),d.server&&(g|=64,f=6),d.email&&(g|=32,f=5),d.objsign&&(g|=16,f=4),d.reserved&&(g|=8,f=3),d.sslCA&&(g|=4,f=2),d.emailCA&&(g|=2,f=1),d.objCA&&(g|=1,f=0);var l=String.fromCharCode(f);0!==g&&(l+=String.fromCharCode(g)),d.value=h.create(h.Class.UNIVERSAL,h.Type.BITSTRING,!1,l)}else if("subjectAltName"===d.name||"issuerAltName"===d.name){d.value=h.create(h.Class.UNIVERSAL,h.Type.SEQUENCE,!0,[]);for(var o,p=0;p<d.altNames.length;++p){o=d.altNames[p];var l=o.value;if(7===o.type&&o.ip){if(l=a.util.bytesFromIP(o.ip),null===l)throw{message:'Extension "ip" value is not a valid IPv4 or IPv6 address.',extension:d}}else 8===o.type&&(l=h.oidToDer(o.oid?h.oidToDer(o.oid):l));d.value.value.push(h.create(h.Class.CONTEXT_SPECIFIC,o.type,!1,l))}}else if("subjectKeyIdentifier"===d.name){var q=c.generateSubjectKeyIdentifier();d.subjectKeyIdentifier=q.toHex(),d.value=h.create(h.Class.UNIVERSAL,h.Type.OCTETSTRING,!1,q.getBytes())}if("undefined"==typeof d.value)throw{message:"Extension value not specified.",extension:d}}}c.extensions=b},c.getExtension=function(a){"string"==typeof a&&(a={name:a});for(var b,d=null,e=0;null===d&&e<c.extensions.length;++e)b=c.extensions[e],a.id&&b.id===a.id?d=b:a.name&&b.name===a.name&&(d=b);return d},c.sign=function(b,d){c.md=d||a.md.sha1.create();var e=j[c.md.algorithm+"WithRSAEncryption"];if(!e)throw{message:"Could not compute certificate digest. Unknown message digest algorithm OID.",algorithm:c.md.algorithm};c.signatureOid=c.siginfo.algorithmOid=e,c.tbsCertificate=i.getTBSCertificate(c);var f=h.toDer(c.tbsCertificate);c.md.update(f.getBytes()),c.signature=b.sign(c.md)},c.verify=function(b){var d=!1;if(!c.issued(b)){var e=b.issuer,f=c.subject;throw{message:"The parent certificate did not issue the given child certificate; the child certificate's issuer does not match the parent's subject.",expectedIssuer:e.attributes,actualIssuer:f.attributes}}var g=b.md;if(null===g){if(b.signatureOid in j){var k=j[b.signatureOid];switch(k){case"sha1WithRSAEncryption":g=a.md.sha1.create();break;case"md5WithRSAEncryption":g=a.md.md5.create();break;case"sha256WithRSAEncryption":g=a.md.sha256.create();break;case"RSASSA-PSS":g=a.md.sha256.create()}}if(null===g)throw{message:"Could not compute certificate digest. Unknown signature OID.",signatureOid:b.signatureOid};var l=b.tbsCertificate||i.getTBSCertificate(b),m=h.toDer(l);g.update(m.getBytes())}if(null!==g){var n=void 0;switch(b.signatureOid){case j.sha1WithRSAEncryption:n=void 0;break;case j["RSASSA-PSS"]:var o,p;if(o=j[b.signatureParameters.mgf.hash.algorithmOid],void 0===o||void 0===a.md[o])throw{message:"Unsupported MGF hash function.",oid:b.signatureParameters.mgf.hash.algorithmOid,name:o};if(p=j[b.signatureParameters.mgf.algorithmOid],void 0===p||void 0===a.mgf[p])throw{message:"Unsupported MGF function.",oid:b.signatureParameters.mgf.algorithmOid,name:p};if(p=a.mgf[p].create(a.md[o].create()),o=j[b.signatureParameters.hash.algorithmOid],void 0===o||void 0===a.md[o])throw{message:"Unsupported RSASSA-PSS hash function.",oid:b.signatureParameters.hash.algorithmOid,name:o};n=a.pss.create(a.md[o].create(),p,b.signatureParameters.saltLength)}d=c.publicKey.verify(g.digest().getBytes(),b.signature,n)}return d},c.isIssuer=function(a){var b=!1,d=c.issuer,e=a.subject;if(d.hash&&e.hash)b=d.hash===e.hash;else if(d.attributes.length===e.attributes.length){b=!0;for(var f,g,h=0;b&&h<d.attributes.length;++h)f=d.attributes[h],g=e.attributes[h],(f.type!==g.type||f.value!==g.value)&&(b=!1)}return b},c.issued=function(a){return a.isIssuer(c)},c.generateSubjectKeyIdentifier=function(){var b=h.toDer(i.publicKeyToRSAPublicKey(c.publicKey)),d=a.md.sha1.create();return d.update(b.getBytes()),d.digest()},c.verifySubjectKeyIdentifier=function(){for(var b=j.subjectKeyIdentifier,d=0;d<c.extensions.length;++d){var e=c.extensions[d];if(e.id===b){var f=c.generateSubjectKeyIdentifier().getBytes();return a.util.hexToBytes(e.subjectKeyIdentifier)===f}}return!1},c},i.certificateFromAsn1=function(c,d){var f={},g=[];if(!h.validate(c,m,f,g))throw{message:"Cannot read X.509 certificate. ASN.1 object is not an X509v3 Certificate.",errors:g};if("string"!=typeof f.certSignature){for(var k="\x00",l=0;l<f.certSignature.length;++l)k+=h.toDer(f.certSignature[l]).getBytes();f.certSignature=k}var n=h.derToOid(f.publicKeyOid);if(n!==i.oids.rsaEncryption)throw{message:"Cannot read public key. OID is not RSA."};var o=i.createCertificate();o.version=f.certVersion?f.certVersion.charCodeAt(0):0;var p=a.util.createBuffer(f.certSerialNumber);o.serialNumber=p.toHex(),o.signatureOid=a.asn1.derToOid(f.certSignatureOid),o.signatureParameters=r(o.signatureOid,f.certSignatureParams,!0),o.siginfo.algorithmOid=a.asn1.derToOid(f.certinfoSignatureOid),o.siginfo.parameters=r(o.siginfo.algorithmOid,f.certinfoSignatureParams,!1);var s=a.util.createBuffer(f.certSignature);++s.read,o.signature=s.getBytes();var t=[];if(void 0!==f.certValidity1UTCTime&&t.push(h.utcTimeToDate(f.certValidity1UTCTime)),void 0!==f.certValidity2GeneralizedTime&&t.push(h.generalizedTimeToDate(f.certValidity2GeneralizedTime)),void 0!==f.certValidity3UTCTime&&t.push(h.utcTimeToDate(f.certValidity3UTCTime)),void 0!==f.certValidity4GeneralizedTime&&t.push(h.generalizedTimeToDate(f.certValidity4GeneralizedTime)),t.length>2)throw{message:"Cannot read notBefore/notAfter validity times; more than two times were provided in the certificate."};if(t.length<2)throw{message:"Cannot read notBefore/notAfter validity times; they were not provided as either UTCTime or GeneralizedTime."};if(o.validity.notBefore=t[0],o.validity.notAfter=t[1],o.tbsCertificate=f.tbsCertificate,d){if(o.md=null,o.signatureOid in j){var n=j[o.signatureOid];switch(n){case"sha1WithRSAEncryption":o.md=a.md.sha1.create();break;case"md5WithRSAEncryption":o.md=a.md.md5.create();break;case"sha256WithRSAEncryption":o.md=a.md.sha256.create();break;case"RSASSA-PSS":o.md=a.md.sha256.create()}}if(null===o.md)throw{message:"Could not compute certificate digest. Unknown signature OID.",signatureOid:o.signatureOid};var u=h.toDer(o.tbsCertificate);o.md.update(u.getBytes())}var v=a.md.sha1.create();o.issuer.getField=function(a){return b(o.issuer,a)},o.issuer.addField=function(a){e([a]),o.issuer.attributes.push(a)},o.issuer.attributes=i.RDNAttributesAsArray(f.certIssuer,v),f.certIssuerUniqueId&&(o.issuer.uniqueId=f.certIssuerUniqueId),o.issuer.hash=v.digest().toHex();var w=a.md.sha1.create();return o.subject.getField=function(a){return b(o.subject,a)},o.subject.addField=function(a){e([a]),o.subject.attributes.push(a)},o.subject.attributes=i.RDNAttributesAsArray(f.certSubject,w),f.certSubjectUniqueId&&(o.subject.uniqueId=f.certSubjectUniqueId),o.subject.hash=w.digest().toHex(),o.extensions=f.certExtensions?q(f.certExtensions):[],o.publicKey=i.publicKeyFromAsn1(f.subjectPublicKeyInfo),o},i.certificationRequestFromAsn1=function(c,d){var f={},g=[];if(!h.validate(c,p,f,g))throw{message:"Cannot read PKCS#10 certificate request. ASN.1 object is not a PKCS#10 CertificationRequest.",errors:g};if("string"!=typeof f.csrSignature){for(var k="\x00",l=0;l<f.csrSignature.length;++l)k+=h.toDer(f.csrSignature[l]).getBytes();f.csrSignature=k}var m=h.derToOid(f.publicKeyOid);if(m!==i.oids.rsaEncryption)throw{message:"Cannot read public key. OID is not RSA."};var n=i.createCertificationRequest();n.version=f.csrVersion?f.csrVersion.charCodeAt(0):0,n.signatureOid=a.asn1.derToOid(f.csrSignatureOid),n.signatureParameters=r(n.signatureOid,f.csrSignatureParams,!0),n.siginfo.algorithmOid=a.asn1.derToOid(f.csrSignatureOid),n.siginfo.parameters=r(n.siginfo.algorithmOid,f.csrSignatureParams,!1);var o=a.util.createBuffer(f.csrSignature);if(++o.read,n.signature=o.getBytes(),n.certificationRequestInfo=f.certificationRequestInfo,d){if(n.md=null,n.signatureOid in j){var m=j[n.signatureOid];switch(m){case"sha1WithRSAEncryption":n.md=a.md.sha1.create();break;case"md5WithRSAEncryption":n.md=a.md.md5.create();break;case"sha256WithRSAEncryption":n.md=a.md.sha256.create();break;case"RSASSA-PSS":n.md=a.md.sha256.create()}}if(null===n.md)throw{message:"Could not compute certification request digest. Unknown signature OID.",signatureOid:n.signatureOid};var q=h.toDer(n.certificationRequestInfo);n.md.update(q.getBytes())}var s=a.md.sha1.create();return n.subject.getField=function(a){return b(n.subject,a)},n.subject.addField=function(a){e([a]),n.subject.attributes.push(a)},n.subject.attributes=i.RDNAttributesAsArray(f.certificationRequestInfoSubject,s),n.subject.hash=s.digest().toHex(),n.publicKey=i.publicKeyFromAsn1(f.subjectPublicKeyInfo),n.getAttribute=function(a){return b(n.attributes,a)},n.addAttribute=function(a){e([a]),n.attributes.push(a)},n.attributes=i.CRIAttributesAsArray(f.certificationRequestInfoAttributes),n},i.createCertificationRequest=function(){var c={};return c.version=0,c.signatureOid=null,c.signature=null,c.siginfo={},c.siginfo.algorithmOid=null,c.subject={},c.subject.getField=function(a){return b(c.subject,a)},c.subject.addField=function(a){e([a]),c.subject.attributes.push(a)},c.subject.attributes=[],c.subject.hash=null,c.publicKey=null,c.attributes=[],c.getAttribute=function(a){return b(c.attributes,a)},c.addAttribute=function(a){e([a]),c.attributes.push(a)},c.md=null,c.setSubject=function(a){e(a),c.subject.attributes=a,c.subject.hash=null},c.setAttributes=function(a){e(a),c.attributes=a},c.sign=function(b,d){c.md=d||a.md.sha1.create();var e=j[c.md.algorithm+"WithRSAEncryption"];if(!e)throw{message:"Could not compute certification request digest. Unknown message digest algorithm OID.",algorithm:c.md.algorithm};c.signatureOid=c.siginfo.algorithmOid=e,c.certificationRequestInfo=i.getCertificationRequestInfo(c);
var f=h.toDer(c.certificationRequestInfo);c.md.update(f.getBytes()),c.signature=b.sign(c.md)},c.verify=function(){var b=!1,d=c.md;if(null===d){if(c.signatureOid in j){var e=j[c.signatureOid];switch(e){case"sha1WithRSAEncryption":d=a.md.sha1.create();break;case"md5WithRSAEncryption":d=a.md.md5.create();break;case"sha256WithRSAEncryption":d=a.md.sha256.create();break;case"RSASSA-PSS":d=a.md.sha256.create()}}if(null===d)throw{message:"Could not compute certification request digest. Unknown signature OID.",signatureOid:c.signatureOid};var f=c.certificationRequestInfo||i.getCertificationRequestInfo(c),g=h.toDer(f);d.update(g.getBytes())}if(null!==d){var k;switch(c.signatureOid){case j.sha1WithRSAEncryption:break;case j["RSASSA-PSS"]:var l,m;if(l=j[c.signatureParameters.mgf.hash.algorithmOid],void 0===l||void 0===a.md[l])throw{message:"Unsupported MGF hash function.",oid:c.signatureParameters.mgf.hash.algorithmOid,name:l};if(m=j[c.signatureParameters.mgf.algorithmOid],void 0===m||void 0===a.mgf[m])throw{message:"Unsupported MGF function.",oid:c.signatureParameters.mgf.algorithmOid,name:m};if(m=a.mgf[m].create(a.md[l].create()),l=j[c.signatureParameters.hash.algorithmOid],void 0===l||void 0===a.md[l])throw{message:"Unsupported RSASSA-PSS hash function.",oid:c.signatureParameters.hash.algorithmOid,name:l};k=a.pss.create(a.md[l].create(),m,c.signatureParameters.saltLength)}b=c.publicKey.verify(d.digest().getBytes(),c.signature,k)}return b},c},i.getTBSCertificate=function(b){var e=h.create(h.Class.UNIVERSAL,h.Type.SEQUENCE,!0,[h.create(h.Class.CONTEXT_SPECIFIC,0,!0,[h.create(h.Class.UNIVERSAL,h.Type.INTEGER,!1,h.integerToDer(b.version).getBytes())]),h.create(h.Class.UNIVERSAL,h.Type.INTEGER,!1,a.util.hexToBytes(b.serialNumber)),h.create(h.Class.UNIVERSAL,h.Type.SEQUENCE,!0,[h.create(h.Class.UNIVERSAL,h.Type.OID,!1,h.oidToDer(b.siginfo.algorithmOid).getBytes()),f(b.siginfo.algorithmOid,b.siginfo.parameters)]),c(b.issuer),h.create(h.Class.UNIVERSAL,h.Type.SEQUENCE,!0,[h.create(h.Class.UNIVERSAL,h.Type.UTCTIME,!1,h.dateToUtcTime(b.validity.notBefore)),h.create(h.Class.UNIVERSAL,h.Type.UTCTIME,!1,h.dateToUtcTime(b.validity.notAfter))]),c(b.subject),i.publicKeyToAsn1(b.publicKey)]);return b.issuer.uniqueId&&e.value.push(h.create(h.Class.CONTEXT_SPECIFIC,1,!0,[h.create(h.Class.UNIVERSAL,h.Type.BITSTRING,!1,String.fromCharCode(0)+b.issuer.uniqueId)])),b.subject.uniqueId&&e.value.push(h.create(h.Class.CONTEXT_SPECIFIC,2,!0,[h.create(h.Class.UNIVERSAL,h.Type.BITSTRING,!1,String.fromCharCode(0)+b.subject.uniqueId)])),b.extensions.length>0&&e.value.push(d(b.extensions)),e},i.getCertificationRequestInfo=function(a){var b=h.create(h.Class.UNIVERSAL,h.Type.SEQUENCE,!0,[h.create(h.Class.UNIVERSAL,h.Type.INTEGER,!1,h.integerToDer(a.version).getBytes()),c(a.subject),i.publicKeyToAsn1(a.publicKey),g(a)]);return b},i.distinguishedNameToAsn1=function(a){return c(a)},i.certificateToAsn1=function(a){var b=a.tbsCertificate||i.getTBSCertificate(a);return h.create(h.Class.UNIVERSAL,h.Type.SEQUENCE,!0,[b,h.create(h.Class.UNIVERSAL,h.Type.SEQUENCE,!0,[h.create(h.Class.UNIVERSAL,h.Type.OID,!1,h.oidToDer(a.signatureOid).getBytes()),f(a.signatureOid,a.signatureParameters)]),h.create(h.Class.UNIVERSAL,h.Type.BITSTRING,!1,String.fromCharCode(0)+a.signature)])},i.certificationRequestToAsn1=function(a){var b=a.certificationRequestInfo||i.getCertificationRequestInfo(a);return h.create(h.Class.UNIVERSAL,h.Type.SEQUENCE,!0,[b,h.create(h.Class.UNIVERSAL,h.Type.SEQUENCE,!0,[h.create(h.Class.UNIVERSAL,h.Type.OID,!1,h.oidToDer(a.signatureOid).getBytes()),f(a.signatureOid,a.signatureParameters)]),h.create(h.Class.UNIVERSAL,h.Type.BITSTRING,!1,String.fromCharCode(0)+a.signature)])},i.createCaStore=function(b){var d={certs:{}};if(d.getIssuer=function(b){var e=null;if(!b.issuer.hash){var f=a.md.sha1.create();b.issuer.attributes=i.RDNAttributesAsArray(c(b.issuer),f),b.issuer.hash=f.digest().toHex()}if(b.issuer.hash in d.certs&&(e=d.certs[b.issuer.hash],a.util.isArray(e)))throw{message:"Resolving multiple issuer matches not implemented yet."};return e},d.addCertificate=function(b){if("string"==typeof b&&(b=a.pki.certificateFromPem(b)),!b.subject.hash){var e=a.md.sha1.create();b.subject.attributes=i.RDNAttributesAsArray(c(b.subject),e),b.subject.hash=e.digest().toHex()}if(b.subject.hash in d.certs){var f=d.certs[b.subject.hash];a.util.isArray(f)||(f=[f]),f.push(b)}else d.certs[b.subject.hash]=b},b)for(var e=0;e<b.length;++e){var f=b[e];d.addCertificate(f)}return d},i.certificateError={bad_certificate:"forge.pki.BadCertificate",unsupported_certificate:"forge.pki.UnsupportedCertificate",certificate_revoked:"forge.pki.CertificateRevoked",certificate_expired:"forge.pki.CertificateExpired",certificate_unknown:"forge.pki.CertificateUnknown",unknown_ca:"forge.pki.UnknownCertificateAuthority"},i.verifyCertificateChain=function(b,c,d){c=c.slice(0);var e=c.slice(0),f=new Date,g=!0,h=null,j=0,k=null;do{var l=c.shift();if(f<l.validity.notBefore||f>l.validity.notAfter)h={message:"Certificate is not valid yet or has expired.",error:i.certificateError.certificate_expired,notBefore:l.validity.notBefore,notAfter:l.validity.notAfter,now:f};else{var m=!1;if(c.length>0){k=c[0];try{m=k.verify(l)}catch(n){}}else{var o=b.getIssuer(l);if(null===o)h={message:"Certificate is not trusted.",error:i.certificateError.unknown_ca};else for(a.util.isArray(o)||(o=[o]);!m&&o.length>0;){k=o.shift();try{m=k.verify(l)}catch(n){}}}null===h&&!m&&(h={message:"Certificate signature is invalid.",error:i.certificateError.bad_certificate})}if(null===h&&!l.isIssuer(k)&&(h={message:"Certificate issuer is invalid.",error:i.certificateError.bad_certificate}),null===h)for(var p={keyUsage:!0,basicConstraints:!0},q=0;null===h&&q<l.extensions.length;++q){var r=l.extensions[q];r.critical&&!(r.name in p)&&(h={message:"Certificate has an unsupported critical extension.",error:i.certificateError.unsupported_certificate})}if(!g||0===c.length&&!k){var s=l.getExtension("basicConstraints"),t=l.getExtension("keyUsage");if(null!==t&&(!t.keyCertSign||null===s)&&(h={message:"Certificate keyUsage or basicConstraints conflict or indicate that the certificate is not a CA. If the certificate is the only one in the chain or isn't the first then the certificate must be a valid CA.",error:i.certificateError.bad_certificate}),null===h&&null!==s&&!s.cA&&(h={message:"Certificate basicConstraints indicates the certificate is not a CA.",error:i.certificateError.bad_certificate}),null===h&&null!==t&&"pathLenConstraint"in s){for(var u=0,q=1;q<c.length-1;++q)c[q].isIssuer(c[q])&&++u;var v=s.pathLenConstraint+1;c.length-u>v&&(h={message:"Certificate basicConstraints pathLenConstraint violated.",error:i.certificateError.bad_certificate})}}var w=null===h?!0:h.error,x=d?d(w,j,e):w;if(x!==!0)throw w===!0&&(h={message:"The application rejected the certificate.",error:i.certificateError.bad_certificate}),(x||0===x)&&("object"!=typeof x||a.util.isArray(x)?"string"==typeof x&&(h.error=x):(x.message&&(h.message=x.message),x.error&&(h.error=x.error))),h;h=null,g=!1,++j}while(c.length>0);return!0}}var c="x509";if("function"!=typeof e){if("object"!=typeof b||!b.exports)return"undefined"==typeof forge&&(forge={}),a(forge);var f=!0;e=function(a,c){c(d,b)}}var g,h=function(b,d){d.exports=function(d){var e=g.map(function(a){return b(a)}).concat(a);if(d=d||{},d.defined=d.defined||{},d.defined[c])return d[c];d.defined[c]=!0;for(var f=0;f<e.length;++f)e[f](d);return d.pki}},i=e;(e=function(a,b){return g="string"==typeof a?b.slice(2):a.slice(2),f?(delete e,i.apply(null,Array.prototype.slice.call(arguments,0))):(e=i,e.apply(null,Array.prototype.slice.call(arguments,0)))})("js/x509",["require","module","./aes","./asn1","./des","./md","./mgf","./oids","./pem","./pss","./rsa","./util"],function(){h.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function a(a){function b(a,b,c,d){for(var e=[],f=0;f<a.length;f++)for(var g=0;g<a[f].safeBags.length;g++){var h=a[f].safeBags[g];(void 0===d||h.type===d)&&void 0!==h.attributes[b]&&h.attributes[b].indexOf(c)>=0&&e.push(h)}return e}function c(a,b,c,f){if(b=g.fromDer(b,c),b.tagClass!==g.Class.UNIVERSAL||b.type!==g.Type.SEQUENCE||b.constructed!==!0)throw{message:"PKCS#12 AuthenticatedSafe expected to be a SEQUENCE OF ContentInfo"};for(var i=0;i<b.value.length;i++){var k=b.value[i],l={},m=[];if(!g.validate(k,j,l,m))throw{message:"Cannot read ContentInfo.",errors:m};var n={encrypted:!1},o=null,p=l.content.value[0];switch(g.derToOid(l.contentType)){case h.oids.data:if(p.tagClass!==g.Class.UNIVERSAL||p.type!==g.Type.OCTETSTRING)throw{message:"PKCS#12 SafeContents Data is not an OCTET STRING."};o=p.value;break;case h.oids.encryptedData:if(void 0===f)throw{message:"Found PKCS#12 Encrypted SafeContents Data but no password available."};o=d(p,f),n.encrypted=!0;break;default:throw{message:"Unsupported PKCS#12 contentType.",contentType:g.derToOid(l.contentType)}}n.safeBags=e(o,c,f),a.safeContents.push(n)}}function d(b,c){var d={},e=[];if(!g.validate(b,a.pkcs7.asn1.encryptedDataValidator,d,e))throw{message:"Cannot read EncryptedContentInfo. ",errors:e};var f=g.derToOid(d.contentType);if(f!==h.oids.data)throw{message:"PKCS#12 EncryptedContentInfo ContentType is not Data.",oid:f};f=g.derToOid(d.encAlgorithm);var i=h.pbe.getCipher(f,d.encParameter,c),j=a.util.createBuffer(d.encryptedContent);if(i.update(j),!i.finish())throw{message:"Failed to decrypt PKCS#12 SafeContents."};return i.output.getBytes()}function e(a,b,c){if(a=g.fromDer(a,b),a.tagClass!==g.Class.UNIVERSAL||a.type!==g.Type.SEQUENCE||a.constructed!==!0)throw{message:"PKCS#12 SafeContents expected to be a SEQUENCE OF SafeBag"};for(var d=[],e=0;e<a.value.length;e++){var i=a.value[e],j={},k=[];if(!g.validate(i,l,j,k))throw{message:"Cannot read SafeBag.",errors:k};var m={type:g.derToOid(j.bagId),attributes:f(j.bagAttributes)};d.push(m);var o,p,q=j.bagValue.value[0];switch(m.type){case h.oids.pkcs8ShroudedKeyBag:if(void 0===c)throw{message:"Found PKCS#8 ShroudedKeyBag but no password available."};if(q=h.decryptPrivateKeyInfo(q,c),null===q)throw{message:"Unable to decrypt PKCS#8 ShroudedKeyBag, wrong password?"};case h.oids.keyBag:m.key=h.privateKeyFromAsn1(q);continue;case h.oids.certBag:o=n,p=function(){if(g.derToOid(j.certId)!==h.oids.x509Certificate)throw{message:"Unsupported certificate type, only X.509 supported.",oid:g.derToOid(j.certId)};m.cert=h.certificateFromAsn1(g.fromDer(j.cert,b),!0)};break;default:throw{message:"Unsupported PKCS#12 SafeBag type.",oid:m.type}}if(void 0!==o&&!g.validate(q,o,j,k))throw{message:"Cannot read PKCS#12 "+o.name,errors:k};p()}return d}function f(a){var b={};if(void 0!==a)for(var c=0;c<a.length;++c){var d={},e=[];if(!g.validate(a[c],m,d,e))throw{message:"Cannot read PKCS#12 BagAttribute.",errors:e};var f=g.derToOid(d.oid);if(void 0!==h.oids[f]){b[h.oids[f]]=[];for(var i=0;i<d.values.length;++i)b[h.oids[f]].push(d.values[i].value)}}return b}var g=a.asn1,h=a.pki,i=a.pkcs12=a.pkcs12||{},j={name:"ContentInfo",tagClass:g.Class.UNIVERSAL,type:g.Type.SEQUENCE,constructed:!0,value:[{name:"ContentInfo.contentType",tagClass:g.Class.UNIVERSAL,type:g.Type.OID,constructed:!1,capture:"contentType"},{name:"ContentInfo.content",tagClass:g.Class.CONTEXT_SPECIFIC,constructed:!0,captureAsn1:"content"}]},k={name:"PFX",tagClass:g.Class.UNIVERSAL,type:g.Type.SEQUENCE,constructed:!0,value:[{name:"PFX.version",tagClass:g.Class.UNIVERSAL,type:g.Type.INTEGER,constructed:!1,capture:"version"},j,{name:"PFX.macData",tagClass:g.Class.UNIVERSAL,type:g.Type.SEQUENCE,constructed:!0,optional:!0,captureAsn1:"mac",value:[{name:"PFX.macData.mac",tagClass:g.Class.UNIVERSAL,type:g.Type.SEQUENCE,constructed:!0,value:[{name:"PFX.macData.mac.digestAlgorithm",tagClass:g.Class.UNIVERSAL,type:g.Type.SEQUENCE,constructed:!0,value:[{name:"PFX.macData.mac.digestAlgorithm.algorithm",tagClass:g.Class.UNIVERSAL,type:g.Type.OID,constructed:!1,capture:"macAlgorithm"},{name:"PFX.macData.mac.digestAlgorithm.parameters",tagClass:g.Class.UNIVERSAL,captureAsn1:"macAlgorithmParameters"}]},{name:"PFX.macData.mac.digest",tagClass:g.Class.UNIVERSAL,type:g.Type.OCTETSTRING,constructed:!1,capture:"macDigest"}]},{name:"PFX.macData.macSalt",tagClass:g.Class.UNIVERSAL,type:g.Type.OCTETSTRING,constructed:!1,capture:"macSalt"},{name:"PFX.macData.iterations",tagClass:g.Class.UNIVERSAL,type:g.Type.INTEGER,constructed:!1,optional:!0,capture:"macIterations"}]}]},l={name:"SafeBag",tagClass:g.Class.UNIVERSAL,type:g.Type.SEQUENCE,constructed:!0,value:[{name:"SafeBag.bagId",tagClass:g.Class.UNIVERSAL,type:g.Type.OID,constructed:!1,capture:"bagId"},{name:"SafeBag.bagValue",tagClass:g.Class.CONTEXT_SPECIFIC,constructed:!0,captureAsn1:"bagValue"},{name:"SafeBag.bagAttributes",tagClass:g.Class.UNIVERSAL,type:g.Type.SET,constructed:!0,optional:!0,capture:"bagAttributes"}]},m={name:"Attribute",tagClass:g.Class.UNIVERSAL,type:g.Type.SEQUENCE,constructed:!0,value:[{name:"Attribute.attrId",tagClass:g.Class.UNIVERSAL,type:g.Type.OID,constructed:!1,capture:"oid"},{name:"Attribute.attrValues",tagClass:g.Class.UNIVERSAL,type:g.Type.SET,constructed:!0,capture:"values"}]},n={name:"CertBag",tagClass:g.Class.UNIVERSAL,type:g.Type.SEQUENCE,constructed:!0,value:[{name:"CertBag.certId",tagClass:g.Class.UNIVERSAL,type:g.Type.OID,constructed:!1,capture:"certId"},{name:"CertBag.certValue",tagClass:g.Class.CONTEXT_SPECIFIC,constructed:!0,value:[{name:"CertBag.certValue[0]",tagClass:g.Class.UNIVERSAL,type:g.Class.OCTETSTRING,constructed:!1,capture:"cert"}]}]};i.pkcs12FromAsn1=function(d,e,f){"string"==typeof e?(f=e,e=!0):void 0===e&&(e=!0);var j={},l=[];if(!g.validate(d,k,j,l))throw{message:"Cannot read PKCS#12 PFX. ASN.1 object is not an PKCS#12 PFX.",errors:l};var m={version:j.version.charCodeAt(0),safeContents:[],getBags:function(c){var d,e={};return"localKeyId"in c?d=c.localKeyId:"localKeyIdHex"in c&&(d=a.util.hexToBytes(c.localKeyIdHex)),void 0!==d&&(e.localKeyId=b(m.safeContents,"localKeyId",d,c.bagType)),"friendlyName"in c&&(e.friendlyName=b(m.safeContents,"friendlyName",c.friendlyName,c.bagType)),e},getBagsByFriendlyName:function(a,c){return b(m.safeContents,"friendlyName",a,c)},getBagsByLocalKeyId:function(a,c){return b(m.safeContents,"localKeyId",a,c)}};if(3!==j.version.charCodeAt(0))throw{message:"PKCS#12 PFX of version other than 3 not supported.",version:j.version.charCodeAt(0)};if(g.derToOid(j.contentType)!==h.oids.data)throw{message:"Only PKCS#12 PFX in password integrity mode supported.",oid:g.derToOid(j.contentType)};var n=j.content.value[0];if(n.tagClass!==g.Class.UNIVERSAL||n.type!==g.Type.OCTETSTRING)throw{message:"PKCS#12 authSafe content data is not an OCTET STRING."};if(j.mac){var o=null,p=0,q=g.derToOid(j.macAlgorithm);switch(q){case h.oids.sha1:o=a.md.sha1.create(),p=20;break;case h.oids.sha256:o=a.md.sha256.create(),p=32;break;case h.oids.sha384:o=a.md.sha384.create(),p=48;break;case h.oids.sha512:o=a.md.sha512.create(),p=64;break;case h.oids.md5:o=a.md.md5.create(),p=16}if(null===o)throw{message:"PKCS#12 uses unsupported MAC algorithm: "+q};var r=new a.util.ByteBuffer(j.macSalt),s="macIterations"in j?parseInt(a.util.bytesToHex(j.macIterations),16):1,t=i.generateKey(f||"",r,3,s,p,o),u=a.hmac.create();u.start(o,t),u.update(n.value);var v=u.getMac();if(v.getBytes()!==j.macDigest)throw{message:"PKCS#12 MAC could not be verified. Invalid password?"}}return c(m,n.value,e,f),m},i.toPkcs12Asn1=function(b,c,d,e){e=e||{},e.saltSize=e.saltSize||8,e.count=e.count||2048,e.algorithm=e.algorithm||e.encAlgorithm||"aes128","useMac"in e||(e.useMac=!0),"localKeyId"in e||(e.localKeyId=null),"generateLocalKeyId"in e||(e.generateLocalKeyId=!0);var f,j=e.localKeyId;if(null!==j)j=a.util.hexToBytes(j);else if(e.generateLocalKeyId)if(c){var k=a.util.isArray(c)?c[0]:c;"string"==typeof k&&(k=h.certificateFromPem(k));var l=a.md.sha1.create();l.update(g.toDer(h.certificateToAsn1(k)).getBytes()),j=l.digest().getBytes()}else j=a.random.getBytes(20);var m=[];null!==j&&m.push(g.create(g.Class.UNIVERSAL,g.Type.SEQUENCE,!0,[g.create(g.Class.UNIVERSAL,g.Type.OID,!1,g.oidToDer(h.oids.localKeyId).getBytes()),g.create(g.Class.UNIVERSAL,g.Type.SET,!0,[g.create(g.Class.UNIVERSAL,g.Type.OCTETSTRING,!1,j)])])),"friendlyName"in e&&m.push(g.create(g.Class.UNIVERSAL,g.Type.SEQUENCE,!0,[g.create(g.Class.UNIVERSAL,g.Type.OID,!1,g.oidToDer(h.oids.friendlyName).getBytes()),g.create(g.Class.UNIVERSAL,g.Type.SET,!0,[g.create(g.Class.UNIVERSAL,g.Type.BMPSTRING,!1,e.friendlyName)])])),m.length>0&&(f=g.create(g.Class.UNIVERSAL,g.Type.SET,!0,m));var n=[],o=[];null!==c&&(o=a.util.isArray(c)?c:[c]);for(var p=[],q=0;q<o.length;++q){c=o[q],"string"==typeof c&&(c=h.certificateFromPem(c));var r=0===q?f:void 0,s=h.certificateToAsn1(c),t=g.create(g.Class.UNIVERSAL,g.Type.SEQUENCE,!0,[g.create(g.Class.UNIVERSAL,g.Type.OID,!1,g.oidToDer(h.oids.certBag).getBytes()),g.create(g.Class.CONTEXT_SPECIFIC,0,!0,[g.create(g.Class.UNIVERSAL,g.Type.SEQUENCE,!0,[g.create(g.Class.UNIVERSAL,g.Type.OID,!1,g.oidToDer(h.oids.x509Certificate).getBytes()),g.create(g.Class.CONTEXT_SPECIFIC,0,!0,[g.create(g.Class.UNIVERSAL,g.Type.OCTETSTRING,!1,g.toDer(s).getBytes())])])]),r]);p.push(t)}if(p.length>0){var u=g.create(g.Class.UNIVERSAL,g.Type.SEQUENCE,!0,p),v=g.create(g.Class.UNIVERSAL,g.Type.SEQUENCE,!0,[g.create(g.Class.UNIVERSAL,g.Type.OID,!1,g.oidToDer(h.oids.data).getBytes()),g.create(g.Class.CONTEXT_SPECIFIC,0,!0,[g.create(g.Class.UNIVERSAL,g.Type.OCTETSTRING,!1,g.toDer(u).getBytes())])]);n.push(v)}var w=null;if(null!==b){var x=h.wrapRsaPrivateKey(h.privateKeyToAsn1(b));w=null===d?g.create(g.Class.UNIVERSAL,g.Type.SEQUENCE,!0,[g.create(g.Class.UNIVERSAL,g.Type.OID,!1,g.oidToDer(h.oids.keyBag).getBytes()),g.create(g.Class.CONTEXT_SPECIFIC,0,!0,[x]),f]):g.create(g.Class.UNIVERSAL,g.Type.SEQUENCE,!0,[g.create(g.Class.UNIVERSAL,g.Type.OID,!1,g.oidToDer(h.oids.pkcs8ShroudedKeyBag).getBytes()),g.create(g.Class.CONTEXT_SPECIFIC,0,!0,[h.encryptPrivateKeyInfo(x,d,e)]),f]);var y=g.create(g.Class.UNIVERSAL,g.Type.SEQUENCE,!0,[w]),z=g.create(g.Class.UNIVERSAL,g.Type.SEQUENCE,!0,[g.create(g.Class.UNIVERSAL,g.Type.OID,!1,g.oidToDer(h.oids.data).getBytes()),g.create(g.Class.CONTEXT_SPECIFIC,0,!0,[g.create(g.Class.UNIVERSAL,g.Type.OCTETSTRING,!1,g.toDer(y).getBytes())])]);n.push(z)}var A,B=g.create(g.Class.UNIVERSAL,g.Type.SEQUENCE,!0,n);if(e.useMac){var l=a.md.sha1.create(),C=new a.util.ByteBuffer(a.random.getBytes(e.saltSize)),D=e.count,b=i.generateKey(d||"",C,3,D,20),E=a.hmac.create();E.start(l,b),E.update(g.toDer(B).getBytes());var F=E.getMac();A=g.create(g.Class.UNIVERSAL,g.Type.SEQUENCE,!0,[g.create(g.Class.UNIVERSAL,g.Type.SEQUENCE,!0,[g.create(g.Class.UNIVERSAL,g.Type.SEQUENCE,!0,[g.create(g.Class.UNIVERSAL,g.Type.OID,!1,g.oidToDer(h.oids.sha1).getBytes()),g.create(g.Class.UNIVERSAL,g.Type.NULL,!1,"")]),g.create(g.Class.UNIVERSAL,g.Type.OCTETSTRING,!1,F.getBytes())]),g.create(g.Class.UNIVERSAL,g.Type.OCTETSTRING,!1,C.getBytes()),g.create(g.Class.UNIVERSAL,g.Type.INTEGER,!1,g.integerToDer(D).getBytes())])}return g.create(g.Class.UNIVERSAL,g.Type.SEQUENCE,!0,[g.create(g.Class.UNIVERSAL,g.Type.INTEGER,!1,g.integerToDer(3).getBytes()),g.create(g.Class.UNIVERSAL,g.Type.SEQUENCE,!0,[g.create(g.Class.UNIVERSAL,g.Type.OID,!1,g.oidToDer(h.oids.data).getBytes()),g.create(g.Class.CONTEXT_SPECIFIC,0,!0,[g.create(g.Class.UNIVERSAL,g.Type.OCTETSTRING,!1,g.toDer(B).getBytes())])]),A])},i.generateKey=a.pbe.generatePkcs12Key}var c="pkcs12";if("function"!=typeof e){if("object"!=typeof b||!b.exports)return"undefined"==typeof forge&&(forge={}),a(forge);var f=!0;e=function(a,c){c(d,b)}}var g,h=function(b,d){d.exports=function(d){var e=g.map(function(a){return b(a)}).concat(a);if(d=d||{},d.defined=d.defined||{},d.defined[c])return d[c];d.defined[c]=!0;for(var f=0;f<e.length;++f)e[f](d);return d[c]}},i=e;(e=function(a,b){return g="string"==typeof a?b.slice(2):a.slice(2),f?(delete e,i.apply(null,Array.prototype.slice.call(arguments,0))):(e=i,e.apply(null,Array.prototype.slice.call(arguments,0)))})("js/pkcs12",["require","module","./asn1","./hmac","./oids","./pkcs7asn1","./pbe","./random","./rsa","./sha1","./util","./x509"],function(){h.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function a(a){var b=a.asn1,c=a.pki=a.pki||{};c.pemToDer=function(b){var c=a.pem.decode(b)[0];if(c.procType&&"ENCRYPTED"===c.procType.type)throw{message:"Could not convert PEM to DER; PEM is encrypted."};return a.util.createBuffer(c.body)},c.privateKeyFromPem=function(d){var e=a.pem.decode(d)[0];if("PRIVATE KEY"!==e.type&&"RSA PRIVATE KEY"!==e.type)throw{message:'Could not convert private key from PEM; PEM header type is not "PRIVATE KEY" or "RSA PRIVATE KEY".',headerType:e.type};if(e.procType&&"ENCRYPTED"===e.procType.type)throw{message:"Could not convert private key from PEM; PEM is encrypted."};var f=b.fromDer(e.body);return c.privateKeyFromAsn1(f)},c.privateKeyToPem=function(d,e){var f={type:"RSA PRIVATE KEY",body:b.toDer(c.privateKeyToAsn1(d)).getBytes()};return a.pem.encode(f,{maxline:e})}}var c="pki";if("function"!=typeof e){if("object"!=typeof b||!b.exports)return"undefined"==typeof forge&&(forge={}),a(forge);var f=!0;e=function(a,c){c(d,b)}}var g,h=function(b,d){d.exports=function(d){var e=g.map(function(a){return b(a)}).concat(a);if(d=d||{},d.defined=d.defined||{},d.defined[c])return d[c];d.defined[c]=!0;for(var f=0;f<e.length;++f)e[f](d);return d[c]}},i=e;(e=function(a,b){return g="string"==typeof a?b.slice(2):a.slice(2),f?(delete e,i.apply(null,Array.prototype.slice.call(arguments,0))):(e=i,e.apply(null,Array.prototype.slice.call(arguments,0)))})("js/pki",["require","module","./asn1","./oids","./pbe","./pem","./pbkdf2","./pkcs12","./pss","./rsa","./util","./x509"],function(){h.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function a(a){var b=function(b,c,d,e){var f=a.util.createBuffer(),g=b.length>>1,h=g+(1&b.length),i=b.substr(0,h),j=b.substr(g,h),k=a.util.createBuffer(),l=a.hmac.create();d=c+d;var m=Math.ceil(e/16),n=Math.ceil(e/20);l.start("MD5",i);var o=a.util.createBuffer();k.putBytes(d);for(var p=0;m>p;++p)l.start(null,null),l.update(k.getBytes()),k.putBuffer(l.digest()),l.start(null,null),l.update(k.bytes()+d),o.putBuffer(l.digest());l.start("SHA1",j);var q=a.util.createBuffer();k.clear(),k.putBytes(d);for(var p=0;n>p;++p)l.start(null,null),l.update(k.getBytes()),k.putBuffer(l.digest()),l.start(null,null),l.update(k.bytes()+d),q.putBuffer(l.digest());return f.putBytes(a.util.xorBytes(o.getBytes(),q.getBytes(),e)),f},c=function(b,c,d){var e=a.hmac.create();e.start("SHA1",b);var f=a.util.createBuffer();return f.putInt32(c[0]),f.putInt32(c[1]),f.putByte(d.type),f.putByte(d.version.major),f.putByte(d.version.minor),f.putInt16(d.length),f.putBytes(d.fragment.bytes()),e.update(f.getBytes()),e.digest().getBytes()},d=function(b,c){var d=!1;try{var e=b.deflate(c.fragment.getBytes());c.fragment=a.util.createBuffer(e),c.length=e.length,d=!0}catch(f){}return d},e=function(b,c){var d=!1;try{var e=b.inflate(c.fragment.getBytes());c.fragment=a.util.createBuffer(e),c.length=e.length,d=!0}catch(f){}return d},f=function(b,c){var d=0;switch(c){case 1:d=b.getByte();break;case 2:d=b.getInt16();break;case 3:d=b.getInt24();break;case 4:d=b.getInt32()}return a.util.createBuffer(b.getBytes(d))},g=function(a,b,c){a.putInt(c.length(),b<<3),a.putBuffer(c)},h={};h.Version={major:3,minor:1},h.MaxFragment=15360,h.ConnectionEnd={server:0,client:1},h.PRFAlgorithm={tls_prf_sha256:0},h.BulkCipherAlgorithm={none:null,rc4:0,des3:1,aes:2},h.CipherType={stream:0,block:1,aead:2},h.MACAlgorithm={none:null,hmac_md5:0,hmac_sha1:1,hmac_sha256:2,hmac_sha384:3,hmac_sha512:4},h.CompressionMethod={none:0,deflate:1},h.ContentType={change_cipher_spec:20,alert:21,handshake:22,application_data:23},h.HandshakeType={hello_request:0,client_hello:1,server_hello:2,certificate:11,server_key_exchange:12,certificate_request:13,server_hello_done:14,certificate_verify:15,client_key_exchange:16,finished:20},h.Alert={},h.Alert.Level={warning:1,fatal:2},h.Alert.Description={close_notify:0,unexpected_message:10,bad_record_mac:20,decryption_failed:21,record_overflow:22,decompression_failure:30,handshake_failure:40,bad_certificate:42,unsupported_certificate:43,certificate_revoked:44,certificate_expired:45,certificate_unknown:46,illegal_parameter:47,unknown_ca:48,access_denied:49,decode_error:50,decrypt_error:51,export_restriction:60,protocol_version:70,insufficient_security:71,internal_error:80,user_canceled:90,no_renegotiation:100},h.CipherSuites={},h.getCipherSuite=function(a){var b=null;for(var c in h.CipherSuites){var d=h.CipherSuites[c];if(d.id[0]===a.charCodeAt(0)&&d.id[1]===a.charCodeAt(1)){b=d;break}}return b},h.handleUnexpected=function(a){var b=!a.open&&a.entity===h.ConnectionEnd.client;b||a.error(a,{message:"Unexpected message. Received TLS record out of order.",send:!0,alert:{level:h.Alert.Level.fatal,description:h.Alert.Description.unexpected_message}})},h.handleHelloRequest=function(a){!a.handshaking&&a.handshakes>0&&(h.queue(a,h.createAlert({level:h.Alert.Level.warning,description:h.Alert.Description.no_renegotiation})),h.flush(a)),a.process()},h.parseHelloMessage=function(b,c,d){var e=null,g=b.entity===h.ConnectionEnd.client;if(38>d)b.error(b,{message:g?"Invalid ServerHello message. Message too short.":"Invalid ClientHello message. Message too short.",send:!0,alert:{level:h.Alert.Level.fatal,description:h.Alert.Description.illegal_parameter}});else{var i=c.fragment,j=i.length();if(e={version:{major:i.getByte(),minor:i.getByte()},random:a.util.createBuffer(i.getBytes(32)),session_id:f(i,1),extensions:[]},g?(e.cipher_suite=i.getBytes(2),e.compression_method=i.getByte()):(e.cipher_suites=f(i,2),e.compression_methods=f(i,1)),j=d-(j-i.length()),j>0){for(var k=f(i,2);k.length()>0;)e.extensions.push({type:[k.getByte(),k.getByte()],data:f(k,2)});if(!g)for(var l=0;l<e.extensions.length;++l){var m=e.extensions[l];if(0===m.type[0]&&0===m.type[1])for(var n=f(m.data,2);n.length()>0;){var o=n.getByte();if(0!==o)break;b.session.serverNameList.push(f(n,2).getBytes())}}}if((e.version.major!==h.Version.major||e.version.minor!==h.Version.minor)&&b.error(b,{message:"Incompatible TLS version.",send:!0,alert:{level:h.Alert.Level.fatal,description:h.Alert.Description.protocol_version}}),g)b.session.cipherSuite=h.getCipherSuite(e.cipher_suite);else for(var p=a.util.createBuffer(e.cipher_suites.bytes());p.length()>0&&(b.session.cipherSuite=h.getCipherSuite(p.getBytes(2)),null===b.session.cipherSuite););if(null===b.session.cipherSuite)return b.error(b,{message:"No cipher suites in common.",send:!0,alert:{level:h.Alert.Level.fatal,description:h.Alert.Description.handshake_failure},cipherSuite:a.util.bytesToHex(e.cipher_suite)});b.session.compressionMethod=g?e.compression_method:h.CompressionMethod.none}return e},h.createSecurityParameters=function(a,b){var c=a.entity===h.ConnectionEnd.client,d=b.random.bytes(),e=c?a.session.sp.client_random:d,f=c?d:h.createRandom().getBytes();a.session.sp={entity:a.entity,prf_algorithm:h.PRFAlgorithm.tls_prf_sha256,bulk_cipher_algorithm:null,cipher_type:null,enc_key_length:null,block_length:null,fixed_iv_length:null,record_iv_length:null,mac_algorithm:null,mac_length:null,mac_key_length:null,compression_algorithm:a.session.compressionMethod,pre_master_secret:null,master_secret:null,client_random:e,server_random:f}},h.handleServerHello=function(a,b,c){var d=h.parseHelloMessage(a,b,c);if(!a.fail){var e=d.session_id.bytes();e.length>0&&e===a.session.id?(a.expect=n,a.session.resuming=!0,a.session.sp.server_random=d.random.bytes()):(a.expect=j,a.session.resuming=!1,h.createSecurityParameters(a,d)),a.session.id=e,a.process()}},h.handleClientHello=function(b,c,d){var e=h.parseHelloMessage(b,c,d);if(!b.fail){var f=e.session_id.bytes(),g=null;b.sessionCache&&(g=b.sessionCache.getSession(f),null===g&&(f="")),0===f.length&&(f=a.random.getBytes(32)),b.session.id=f,b.session.clientHelloVersion=e.version,b.session.sp=g?g.sp:{},null!==g?(b.expect=v,b.session.resuming=!0,b.session.sp.client_random=e.random.bytes()):(b.expect=b.verifyClient!==!1?s:t,b.session.resuming=!1,h.createSecurityParameters(b,e)),b.open=!0,h.queue(b,h.createRecord({type:h.ContentType.handshake,data:h.createServerHello(b)})),b.session.resuming?(h.queue(b,h.createRecord({type:h.ContentType.change_cipher_spec,data:h.createChangeCipherSpec()})),b.state.pending=h.createConnectionState(b),b.state.current.write=b.state.pending.write,h.queue(b,h.createRecord({type:h.ContentType.handshake,data:h.createFinished(b)}))):(h.queue(b,h.createRecord({type:h.ContentType.handshake,data:h.createCertificate(b)})),b.fail||(h.queue(b,h.createRecord({type:h.ContentType.handshake,data:h.createServerKeyExchange(b)})),b.verifyClient!==!1&&h.queue(b,h.createRecord({type:h.ContentType.handshake,data:h.createCertificateRequest(b)})),h.queue(b,h.createRecord({type:h.ContentType.handshake,data:h.createServerHelloDone(b)})))),h.flush(b),b.process()}},h.handleCertificate=function(b,c,d){if(3>d)b.error(b,{message:"Invalid Certificate message. Message too short.",send:!0,alert:{level:h.Alert.Level.fatal,description:h.Alert.Description.illegal_parameter}});else{var e,g,i=c.fragment,j={certificate_list:f(i,3)},l=[];try{for(;j.certificate_list.length()>0;)e=f(j.certificate_list,3),g=a.asn1.fromDer(e),e=a.pki.certificateFromAsn1(g,!0),l.push(e)}catch(m){b.error(b,{message:"Could not parse certificate list.",cause:m,send:!0,alert:{level:h.Alert.Level.fatal,description:h.Alert.Description.bad_certificate}})}if(!b.fail){var n=b.entity===h.ConnectionEnd.client;!n&&b.verifyClient!==!0||0!==l.length?0===l.length?b.expect=n?k:t:(n?b.session.serverCertificate=l[0]:b.session.clientCertificate=l[0],h.verifyCertificateChain(b,l)&&(b.expect=n?k:t)):b.error(b,{message:n?"No server certificate provided.":"No client certificate provided.",send:!0,alert:{level:h.Alert.Level.fatal,description:h.Alert.Description.illegal_parameter}}),b.process()}}},h.handleServerKeyExchange=function(a,b,c){c>0?a.error(a,{message:"Invalid key parameters. Only RSA is supported.",send:!0,alert:{level:h.Alert.Level.fatal,description:h.Alert.Description.unsupported_certificate}}):(a.expect=l,a.process())},h.handleClientKeyExchange=function(b,c,d){if(48>d)b.error(b,{message:"Invalid key parameters. Only RSA is supported.",send:!0,alert:{level:h.Alert.Level.fatal,description:h.Alert.Description.unsupported_certificate}});else{var e=c.fragment,g={enc_pre_master_secret:f(e,2).getBytes()},i=null;if(b.getPrivateKey)try{i=b.getPrivateKey(b,b.session.serverCertificate),i=a.pki.privateKeyFromPem(i)}catch(j){b.error(b,{message:"Could not get private key.",cause:j,send:!0,alert:{level:h.Alert.Level.fatal,description:h.Alert.Description.internal_error}})}if(null===i)b.error(b,{message:"No private key set.",send:!0,alert:{level:h.Alert.Level.fatal,description:h.Alert.Description.internal_error}});else try{var k=b.session.sp;k.pre_master_secret=i.decrypt(g.enc_pre_master_secret);var l=b.session.clientHelloVersion;if(l.major!==k.pre_master_secret.charCodeAt(0)||l.minor!==k.pre_master_secret.charCodeAt(1))throw{message:"TLS version rollback attack detected."}}catch(j){k.pre_master_secret=a.random.getBytes(48)}}b.fail||(b.expect=v,null!==b.session.clientCertificate&&(b.expect=u),b.process())},h.handleCertificateRequest=function(a,b,c){if(3>c)a.error(a,{message:"Invalid CertificateRequest. Message too short.",send:!0,alert:{level:h.Alert.Level.fatal,description:h.Alert.Description.illegal_parameter}});else{var d=b.fragment,e={certificate_types:f(d,1),certificate_authorities:f(d,2)};a.session.certificateRequest=e,a.expect=m,a.process()}},h.handleCertificateVerify=function(b,c,d){if(2>d)b.error(b,{message:"Invalid CertificateVerify. Message too short.",send:!0,alert:{level:h.Alert.Level.fatal,description:h.Alert.Description.illegal_parameter}});else{var e=c.fragment;e.read-=4;var g=e.bytes();e.read+=4;var i={signature:f(e,2).getBytes()},j=a.util.createBuffer();j.putBuffer(b.session.md5.digest()),j.putBuffer(b.session.sha1.digest()),j=j.getBytes();
try{var k=b.session.clientCertificate;if(!k.publicKey.verify(j,i.signature,"NONE"))throw{message:"CertificateVerify signature does not match."};b.session.md5.update(g),b.session.sha1.update(g)}catch(l){b.error(b,{message:"Bad signature in CertificateVerify.",send:!0,alert:{level:h.Alert.Level.fatal,description:h.Alert.Description.handshake_failure}})}b.fail||(b.expect=v,b.process())}},h.handleServerHelloDone=function(b,c,d){if(d>0)b.error(b,{message:"Invalid ServerHelloDone message. Invalid length.",send:!0,alert:{level:h.Alert.Level.fatal,description:h.Alert.Description.record_overflow}});else if(null===b.serverCertificate){var e={message:"No server certificate provided. Not enough security.",send:!0,alert:{level:h.Alert.Level.fatal,description:h.Alert.Description.insufficient_security}},f=b.verify(b,e.alert.description,depth,[]);f===!0?e=null:((f||0===f)&&("object"!=typeof f||a.util.isArray(f)?"number"==typeof f&&(e.alert.description=f):(f.message&&(e.message=f.message),f.alert&&(e.alert.description=f.alert))),b.error(b,e))}if(!b.fail&&null!==b.session.certificateRequest&&(c=h.createRecord({type:h.ContentType.handshake,data:h.createCertificate(b)}),h.queue(b,c)),!b.fail){c=h.createRecord({type:h.ContentType.handshake,data:h.createClientKeyExchange(b)}),h.queue(b,c),b.expect=q;var g=function(a,b){null!==a.session.certificateRequest&&null!==a.session.clientCertificate&&h.queue(a,h.createRecord({type:h.ContentType.handshake,data:h.createCertificateVerify(a,b)})),h.queue(a,h.createRecord({type:h.ContentType.change_cipher_spec,data:h.createChangeCipherSpec()})),a.state.pending=h.createConnectionState(a),a.state.current.write=a.state.pending.write,h.queue(a,h.createRecord({type:h.ContentType.handshake,data:h.createFinished(a)})),a.expect=n,h.flush(a),a.process()};null===b.session.certificateRequest||null===b.session.clientCertificate?g(b,null):h.getClientSignature(b,g)}},h.handleChangeCipherSpec=function(a,b){if(1!==b.fragment.getByte())a.error(a,{message:"Invalid ChangeCipherSpec message received.",send:!0,alert:{level:h.Alert.Level.fatal,description:h.Alert.Description.illegal_parameter}});else{var c=a.entity===h.ConnectionEnd.client;(a.session.resuming&&c||!a.session.resuming&&!c)&&(a.state.pending=h.createConnectionState(a)),a.state.current.read=a.state.pending.read,(!a.session.resuming&&c||a.session.resuming&&!c)&&(a.state.pending=null),a.expect=c?o:w,a.process()}},h.handleFinished=function(c,d){var e=d.fragment;e.read-=4;var f=e.bytes();e.read+=4;var g=d.fragment.getBytes();e=a.util.createBuffer(),e.putBuffer(c.session.md5.digest()),e.putBuffer(c.session.sha1.digest());var i=c.entity===h.ConnectionEnd.client,j=i?"server finished":"client finished",k=c.session.sp,l=12,m=b;e=m(k.master_secret,j,e.getBytes(),l),e.getBytes()!==g?c.error(c,{message:"Invalid verify_data in Finished message.",send:!0,alert:{level:h.Alert.Level.fatal,description:h.Alert.Description.decrypt_error}}):(c.session.md5.update(f),c.session.sha1.update(f),(c.session.resuming&&i||!c.session.resuming&&!i)&&(h.queue(c,h.createRecord({type:h.ContentType.change_cipher_spec,data:h.createChangeCipherSpec()})),c.state.current.write=c.state.pending.write,c.state.pending=null,h.queue(c,h.createRecord({type:h.ContentType.handshake,data:h.createFinished(c)}))),c.expect=i?p:x,c.handshaking=!1,++c.handshakes,c.peerCertificate=i?c.session.serverCertificate:c.session.clientCertificate,c.sessionCache?(c.session={id:c.session.id,sp:c.session.sp},c.session.sp.keys=null):c.session=null,h.flush(c),c.isConnected=!0,c.connected(c),c.process())},h.handleAlert=function(a,b){var c,d=b.fragment,e={level:d.getByte(),description:d.getByte()};switch(e.description){case h.Alert.Description.close_notify:c="Connection closed.";break;case h.Alert.Description.unexpected_message:c="Unexpected message.";break;case h.Alert.Description.bad_record_mac:c="Bad record MAC.";break;case h.Alert.Description.decryption_failed:c="Decryption failed.";break;case h.Alert.Description.record_overflow:c="Record overflow.";break;case h.Alert.Description.decompression_failure:c="Decompression failed.";break;case h.Alert.Description.handshake_failure:c="Handshake failure.";break;case h.Alert.Description.bad_certificate:c="Bad certificate.";break;case h.Alert.Description.unsupported_certificate:c="Unsupported certificate.";break;case h.Alert.Description.certificate_revoked:c="Certificate revoked.";break;case h.Alert.Description.certificate_expired:c="Certificate expired.";break;case h.Alert.Description.certificate_unknown:c="Certificate unknown.";break;case h.Alert.Description.illegal_parameter:c="Illegal parameter.";break;case h.Alert.Description.unknown_ca:c="Unknown certificate authority.";break;case h.Alert.Description.access_denied:c="Access denied.";break;case h.Alert.Description.decode_error:c="Decode error.";break;case h.Alert.Description.decrypt_error:c="Decrypt error.";break;case h.Alert.Description.export_restriction:c="Export restriction.";break;case h.Alert.Description.protocol_version:c="Unsupported protocol version.";break;case h.Alert.Description.insufficient_security:c="Insufficient security.";break;case h.Alert.Description.internal_error:c="Internal error.";break;case h.Alert.Description.user_canceled:c="User canceled.";break;case h.Alert.Description.no_renegotiation:c="Renegotiation not supported.";break;default:c="Unknown error."}e.description===h.Alert.Description.close_notify?a.close():(a.error(a,{message:c,send:!1,origin:a.entity===h.ConnectionEnd.client?"server":"client",alert:e}),a.process())},h.handleHandshake=function(b,c){var d=c.fragment,e=d.getByte(),f=d.getInt24();if(f>d.length())b.fragmented=c,c.fragment=a.util.createBuffer(),d.read-=4,b.process();else{b.fragmented=null,d.read-=4;var g=d.bytes(f+4);d.read+=4,e in L[b.entity][b.expect]?(b.entity===h.ConnectionEnd.server&&!b.open&&!b.fail&&(b.handshaking=!0,b.session={serverNameList:[],cipherSuite:null,compressionMethod:null,serverCertificate:null,clientCertificate:null,md5:a.md.md5.create(),sha1:a.md.sha1.create()}),e!==h.HandshakeType.hello_request&&e!==h.HandshakeType.certificate_verify&&e!==h.HandshakeType.finished&&(b.session.md5.update(g),b.session.sha1.update(g)),L[b.entity][b.expect][e](b,c,f)):h.handleUnexpected(b,c)}},h.handleApplicationData=function(a,b){a.data.putBuffer(b.fragment),a.dataReady(a),a.process()};var i=0,j=1,k=2,l=3,m=4,n=5,o=6,p=7,q=8,r=0,s=1,t=2,u=3,v=4,w=5,x=6,y=h.handleUnexpected,z=h.handleChangeCipherSpec,A=h.handleAlert,B=h.handleHandshake,C=h.handleApplicationData,D=[];D[h.ConnectionEnd.client]=[[y,A,B,y],[y,A,B,y],[y,A,B,y],[y,A,B,y],[y,A,B,y],[z,A,y,y],[y,A,B,y],[y,A,B,C],[y,A,B,y]],D[h.ConnectionEnd.server]=[[y,A,B,y],[y,A,B,y],[y,A,B,y],[y,A,B,y],[z,A,y,y],[y,A,B,y],[y,A,B,C],[y,A,B,y]];var E=h.handleHelloRequest,F=h.handleServerHello,G=h.handleCertificate,H=h.handleServerKeyExchange,I=h.handleCertificateRequest,J=h.handleServerHelloDone,K=h.handleFinished,L=[];L[h.ConnectionEnd.client]=[[y,y,F,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y],[E,y,y,y,y,y,y,y,y,y,y,G,H,I,J,y,y,y,y,y,y],[E,y,y,y,y,y,y,y,y,y,y,y,H,I,J,y,y,y,y,y,y],[E,y,y,y,y,y,y,y,y,y,y,y,y,I,J,y,y,y,y,y,y],[E,y,y,y,y,y,y,y,y,y,y,y,y,y,J,y,y,y,y,y,y],[E,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y],[E,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,K],[E,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y],[E,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y]];var M=h.handleClientHello,N=h.handleClientKeyExchange,O=h.handleCertificateVerify;L[h.ConnectionEnd.server]=[[y,M,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y],[y,y,y,y,y,y,y,y,y,y,y,G,y,y,y,y,y,y,y,y,y],[y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,N,y,y,y,y],[y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,O,y,y,y,y,y],[y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y],[y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,K],[y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y],[y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y]],h.generateKeys=function(a,c){var d=b,e=c.client_random+c.server_random;a.session.resuming||(c.master_secret=d(c.pre_master_secret,"master secret",e,48).bytes(),c.pre_master_secret=null),e=c.server_random+c.client_random;var f=2*c.mac_key_length+2*c.enc_key_length+2*c.fixed_iv_length,g=d(c.master_secret,"key expansion",e,f);return{client_write_MAC_key:g.getBytes(c.mac_key_length),server_write_MAC_key:g.getBytes(c.mac_key_length),client_write_key:g.getBytes(c.enc_key_length),server_write_key:g.getBytes(c.enc_key_length),client_write_IV:g.getBytes(c.fixed_iv_length),server_write_IV:g.getBytes(c.fixed_iv_length)}},h.createConnectionState=function(a){var b=a.entity===h.ConnectionEnd.client,c=function(){var a={sequenceNumber:[0,0],macKey:null,macLength:0,macFunction:null,cipherState:null,cipherFunction:function(){return!0},compressionState:null,compressFunction:function(){return!0},updateSequenceNumber:function(){4294967295===a.sequenceNumber[1]?(a.sequenceNumber[1]=0,++a.sequenceNumber[0]):++a.sequenceNumber[1]}};return a},f={read:c(),write:c()};if(f.read.update=function(a,b){return f.read.cipherFunction(b,f.read)?f.read.compressFunction(a,b,f.read)||a.error(a,{message:"Could not decompress record.",send:!0,alert:{level:h.Alert.Level.fatal,description:h.Alert.Description.decompression_failure}}):a.error(a,{message:"Could not decrypt record or bad MAC.",send:!0,alert:{level:h.Alert.Level.fatal,description:h.Alert.Description.bad_record_mac}}),!a.fail},f.write.update=function(a,b){return f.write.compressFunction(a,b,f.write)?f.write.cipherFunction(b,f.write)||a.error(a,{message:"Could not encrypt record.",send:!1,alert:{level:h.Alert.Level.fatal,description:h.Alert.Description.internal_error}}):a.error(a,{message:"Could not compress record.",send:!1,alert:{level:h.Alert.Level.fatal,description:h.Alert.Description.internal_error}}),!a.fail},a.session){var g=a.session.sp;switch(a.session.cipherSuite.initSecurityParameters(g),g.keys=h.generateKeys(a,g),f.read.macKey=b?g.keys.server_write_MAC_key:g.keys.client_write_MAC_key,f.write.macKey=b?g.keys.client_write_MAC_key:g.keys.server_write_MAC_key,a.session.cipherSuite.initConnectionState(f,a,g),g.compression_algorithm){case h.CompressionMethod.none:break;case h.CompressionMethod.deflate:f.read.compressFunction=e,f.write.compressFunction=d;break;default:throw{message:"Unsupported compression algorithm."}}}return f},h.createRandom=function(){var b=new Date,c=+b+6e4*b.getTimezoneOffset(),d=a.util.createBuffer();return d.putInt32(c),d.putBytes(a.random.getBytes(28)),d},h.createRecord=function(a){if(!a.data)return null;var b={type:a.type,version:{major:h.Version.major,minor:h.Version.minor},length:a.data.length(),fragment:a.data};return b},h.createAlert=function(b){var c=a.util.createBuffer();return c.putByte(b.level),c.putByte(b.description),h.createRecord({type:h.ContentType.alert,data:c})},h.createClientHello=function(b){for(var c=a.util.createBuffer(),d=0;d<b.cipherSuites.length;++d){var e=b.cipherSuites[d];c.putByte(e.id[0]),c.putByte(e.id[1])}var f=c.length(),i=a.util.createBuffer();i.putByte(h.CompressionMethod.none);var j=i.length(),k=a.util.createBuffer();if(b.virtualHost){var l=a.util.createBuffer();l.putByte(0),l.putByte(0);var m=a.util.createBuffer();m.putByte(0),g(m,2,a.util.createBuffer(b.virtualHost));var n=a.util.createBuffer();g(n,2,m),g(l,2,n),k.putBuffer(l)}var o=k.length();o>0&&(o+=2);var p=b.session.id,q=p.length+1+2+4+28+2+f+1+j+o,r=a.util.createBuffer();return r.putByte(h.HandshakeType.client_hello),r.putInt24(q),r.putByte(h.Version.major),r.putByte(h.Version.minor),r.putBytes(b.session.sp.client_random),g(r,1,a.util.createBuffer(p)),g(r,2,c),g(r,1,i),o>0&&g(r,2,k),r},h.createServerHello=function(b){var c=b.session.id,d=c.length+1+2+4+28+2+1,e=a.util.createBuffer();return e.putByte(h.HandshakeType.server_hello),e.putInt24(d),e.putByte(h.Version.major),e.putByte(h.Version.minor),e.putBytes(b.session.sp.server_random),g(e,1,a.util.createBuffer(c)),e.putByte(b.session.cipherSuite.id[0]),e.putByte(b.session.cipherSuite.id[1]),e.putByte(b.session.compressionMethod),e},h.createCertificate=function(b){var c=b.entity===h.ConnectionEnd.client,d=null;b.getCertificate&&(d=b.getCertificate(b,c?b.session.certificateRequest:b.session.serverNameList));var e=a.util.createBuffer();if(null!==d)try{a.util.isArray(d)||(d=[d]);for(var f=null,i=0;i<d.length;++i){var j=a.pem.decode(d[i])[0];if("CERTIFICATE"!==j.type&&"X509 CERTIFICATE"!==j.type&&"TRUSTED CERTIFICATE"!==j.type)throw{message:'Could not convert certificate from PEM; PEM header type is not "CERTIFICATE", "X509 CERTIFICATE", or "TRUSTED CERTIFICATE".',headerType:j.type};if(j.procType&&"ENCRYPTED"===j.procType.type)throw{message:"Could not convert certificate from PEM; PEM is encrypted."};var k=a.util.createBuffer(j.body);null===f&&(f=a.asn1.fromDer(k.bytes(),!1));var l=a.util.createBuffer();g(l,3,k),e.putBuffer(l)}d=a.pki.certificateFromAsn1(f),c?b.session.clientCertificate=d:b.session.serverCertificate=d}catch(m){return b.error(b,{message:"Could not send certificate list.",cause:m,send:!0,alert:{level:h.Alert.Level.fatal,description:h.Alert.Description.bad_certificate}})}var n=3+e.length(),o=a.util.createBuffer();return o.putByte(h.HandshakeType.certificate),o.putInt24(n),g(o,3,e),o},h.createClientKeyExchange=function(b){var c=a.util.createBuffer();c.putByte(h.Version.major),c.putByte(h.Version.minor),c.putBytes(a.random.getBytes(46));var d=b.session.sp;d.pre_master_secret=c.getBytes();var e=b.session.serverCertificate.publicKey;c=e.encrypt(d.pre_master_secret);var f=c.length+2,g=a.util.createBuffer();return g.putByte(h.HandshakeType.client_key_exchange),g.putInt24(f),g.putInt16(c.length),g.putBytes(c),g},h.createServerKeyExchange=function(){var b=0,c=a.util.createBuffer();return b>0&&(c.putByte(h.HandshakeType.server_key_exchange),c.putInt24(b)),c},h.getClientSignature=function(b,c){var d=a.util.createBuffer();d.putBuffer(b.session.md5.digest()),d.putBuffer(b.session.sha1.digest()),d=d.getBytes(),b.getSignature=b.getSignature||function(b,c,d){var e=null;if(b.getPrivateKey)try{e=b.getPrivateKey(b,b.session.clientCertificate),e=a.pki.privateKeyFromPem(e)}catch(f){b.error(b,{message:"Could not get private key.",cause:f,send:!0,alert:{level:h.Alert.Level.fatal,description:h.Alert.Description.internal_error}})}null===e?b.error(b,{message:"No private key set.",send:!0,alert:{level:h.Alert.Level.fatal,description:h.Alert.Description.internal_error}}):c=e.sign(c,null),d(b,c)},b.getSignature(b,d,c)},h.createCertificateVerify=function(b,c){var d=c.length+2,e=a.util.createBuffer();return e.putByte(h.HandshakeType.certificate_verify),e.putInt24(d),e.putInt16(c.length),e.putBytes(c),e},h.createCertificateRequest=function(b){var c=a.util.createBuffer();c.putByte(1);var d=a.util.createBuffer();for(var e in b.caStore.certs){var f=b.caStore.certs[e],i=a.pki.distinguishedNameToAsn1(f.subject);d.putBuffer(a.asn1.toDer(i))}var j=1+c.length()+2+d.length(),k=a.util.createBuffer();return k.putByte(h.HandshakeType.certificate_request),k.putInt24(j),g(k,1,c),g(k,2,d),k},h.createServerHelloDone=function(){var b=a.util.createBuffer();return b.putByte(h.HandshakeType.server_hello_done),b.putInt24(0),b},h.createChangeCipherSpec=function(){var b=a.util.createBuffer();return b.putByte(1),b},h.createFinished=function(c){var d=a.util.createBuffer();d.putBuffer(c.session.md5.digest()),d.putBuffer(c.session.sha1.digest());var e=c.entity===h.ConnectionEnd.client,f=c.session.sp,g=12,i=b,j=e?"client finished":"server finished";d=i(f.master_secret,j,d.getBytes(),g);var k=a.util.createBuffer();return k.putByte(h.HandshakeType.finished),k.putInt24(d.length()),k.putBuffer(d),k},h.queue=function(b,c){if(c){if(c.type===h.ContentType.handshake){var d=c.fragment.bytes();b.session.md5.update(d),b.session.sha1.update(d),d=null}var e;if(c.fragment.length()<=h.MaxFragment)e=[c];else{e=[];for(var f=c.fragment.bytes();f.length>h.MaxFragment;)e.push(h.createRecord({type:c.type,data:a.util.createBuffer(f.slice(0,h.MaxFragment))})),f=f.slice(h.MaxFragment);f.length>0&&e.push(h.createRecord({type:c.type,data:a.util.createBuffer(f)}))}for(var g=0;g<e.length&&!b.fail;++g){var i=e[g],j=b.state.current.write;j.update(b,i)&&b.records.push(i)}}},h.flush=function(a){for(var b=0;b<a.records.length;++b){var c=a.records[b];a.tlsData.putByte(c.type),a.tlsData.putByte(c.version.major),a.tlsData.putByte(c.version.minor),a.tlsData.putInt16(c.fragment.length()),a.tlsData.putBuffer(a.records[b].fragment)}return a.records=[],a.tlsDataReady(a)};var P=function(b){switch(b){case!0:return!0;case a.pki.certificateError.bad_certificate:return h.Alert.Description.bad_certificate;case a.pki.certificateError.unsupported_certificate:return h.Alert.Description.unsupported_certificate;case a.pki.certificateError.certificate_revoked:return h.Alert.Description.certificate_revoked;case a.pki.certificateError.certificate_expired:return h.Alert.Description.certificate_expired;case a.pki.certificateError.certificate_unknown:return h.Alert.Description.certificate_unknown;case a.pki.certificateError.unknown_ca:return h.Alert.Description.unknown_ca;default:return h.Alert.Description.bad_certificate}},Q=function(b){switch(b){case!0:return!0;case h.Alert.Description.bad_certificate:return a.pki.certificateError.bad_certificate;case h.Alert.Description.unsupported_certificate:return a.pki.certificateError.unsupported_certificate;case h.Alert.Description.certificate_revoked:return a.pki.certificateError.certificate_revoked;case h.Alert.Description.certificate_expired:return a.pki.certificateError.certificate_expired;case h.Alert.Description.certificate_unknown:return a.pki.certificateError.certificate_unknown;case h.Alert.Description.unknown_ca:return a.pki.certificateError.unknown_ca;default:return a.pki.certificateError.bad_certificate}};h.verifyCertificateChain=function(b,c){try{a.pki.verifyCertificateChain(b.caStore,c,function(c,d,e){var f=(P(c),b.verify(b,c,d,e));if(f!==!0){if("object"==typeof f&&!a.util.isArray(f)){var g={message:"The application rejected the certificate.",send:!0,alert:{level:h.Alert.Level.fatal,description:h.Alert.Description.bad_certificate}};throw f.message&&(g.message=f.message),f.alert&&(g.alert.description=f.alert),g}f!==c&&(f=Q(f))}return f})}catch(d){("object"!=typeof d||a.util.isArray(d))&&(d={send:!0,alert:{level:h.Alert.Level.fatal,description:P(d)}}),"send"in d||(d.send=!0),"alert"in d||(d.alert={level:h.Alert.Level.fatal,description:P(d.error)}),b.error(b,d)}return!b.fail},h.createSessionCache=function(b,c){var d=null;if(b&&b.getSession&&b.setSession&&b.order)d=b;else{d={},d.cache=b||{},d.capacity=Math.max(c||100,1),d.order=[];for(var e in b)d.order.length<=c?d.order.push(e):delete b[e];d.getSession=function(b){var c=null,e=null;if(b?e=a.util.bytesToHex(b):d.order.length>0&&(e=d.order[0]),null!==e&&e in d.cache){c=d.cache[e],delete d.cache[e];for(var f in d.order)if(d.order[f]===e){d.order.splice(f,1);break}}return c},d.setSession=function(b,c){if(d.order.length===d.capacity){var e=d.order.shift();delete d.cache[e]}var e=a.util.bytesToHex(b);d.order.push(e),d.cache[e]=c}}return d},h.createConnection=function(b){var c=null;c=b.caStore?a.util.isArray(b.caStore)?a.pki.createCaStore(b.caStore):b.caStore:a.pki.createCaStore();var d=b.cipherSuites||null;if(null===d){d=[];for(var e in h.CipherSuites)d.push(h.CipherSuites[e])}var f=b.server?h.ConnectionEnd.server:h.ConnectionEnd.client,g=b.sessionCache?h.createSessionCache(b.sessionCache):null,j={entity:f,sessionId:b.sessionId,caStore:c,sessionCache:g,cipherSuites:d,connected:b.connected,virtualHost:b.virtualHost||null,verifyClient:b.verifyClient||!1,verify:b.verify||function(a,b){return b},getCertificate:b.getCertificate||null,getPrivateKey:b.getPrivateKey||null,getSignature:b.getSignature||null,input:a.util.createBuffer(),tlsData:a.util.createBuffer(),data:a.util.createBuffer(),tlsDataReady:b.tlsDataReady,dataReady:b.dataReady,closed:b.closed,error:function(a,c){c.origin=c.origin||(a.entity===h.ConnectionEnd.client?"client":"server"),c.send&&(h.queue(a,h.createAlert(c.alert)),h.flush(a));var d=c.fatal!==!1;d&&(a.fail=!0),b.error(a,c),d&&a.close(!1)},deflate:b.deflate||null,inflate:b.inflate||null};j.reset=function(a){j.record=null,j.session=null,j.peerCertificate=null,j.state={pending:null,current:null},j.expect=j.entity===h.ConnectionEnd.client?i:r,j.fragmented=null,j.records=[],j.open=!1,j.handshakes=0,j.handshaking=!1,j.isConnected=!1,j.fail=!a&&"undefined"!=typeof a,j.input.clear(),j.tlsData.clear(),j.data.clear(),j.state.current=h.createConnectionState(j)},j.reset();var k=function(a,b){var c=b.type-h.ContentType.change_cipher_spec,d=D[a.entity][a.expect];c in d?d[c](a,b):h.handleUnexpected(a,b)},l=function(b){var c=0,d=b.input,e=d.length();return 5>e?c=5-e:(b.record={type:d.getByte(),version:{major:d.getByte(),minor:d.getByte()},length:d.getInt16(),fragment:a.util.createBuffer(),ready:!1},(b.record.version.major!==h.Version.major||b.record.version.minor!==h.Version.minor)&&b.error(b,{message:"Incompatible TLS version.",send:!0,alert:{level:h.Alert.Level.fatal,description:h.Alert.Description.protocol_version}})),c},m=function(a){var b=0,c=a.input,d=c.length();if(d<a.record.length)b=a.record.length-d;else{a.record.fragment.putBytes(c.getBytes(a.record.length)),c.compact();var e=a.state.current.read;e.update(a,a.record)&&(null!==a.fragmented&&(a.fragmented.type===a.record.type?(a.fragmented.fragment.putBuffer(a.record.fragment),a.record=a.fragmented):a.error(a,{message:"Invalid fragmented record.",send:!0,alert:{level:h.Alert.Level.fatal,description:h.Alert.Description.unexpected_message}})),a.record.ready=!0)}return b};return j.handshake=function(b){if(j.entity!==h.ConnectionEnd.client)j.error(j,{message:"Cannot initiate handshake as a server.",fatal:!1});else if(j.handshaking)j.error(j,{message:"Handshake already in progress.",fatal:!1});else{j.fail&&!j.open&&0===j.handshakes&&(j.fail=!1),j.handshaking=!0,b=b||"";var c=null;b.length>0&&(j.sessionCache&&(c=j.sessionCache.getSession(b)),null===c&&(b="")),0===b.length&&j.sessionCache&&(c=j.sessionCache.getSession(),null!==c&&(b=c.id)),j.session={id:b,cipherSuite:null,compressionMethod:null,serverCertificate:null,certificateRequest:null,clientCertificate:null,sp:c?c.sp:{},md5:a.md.md5.create(),sha1:a.md.sha1.create()},j.session.sp.client_random=h.createRandom().getBytes(),j.open=!0,h.queue(j,h.createRecord({type:h.ContentType.handshake,data:h.createClientHello(j)})),h.flush(j)}},j.process=function(a){var b=0;return a&&j.input.putBytes(a),j.fail||(null!==j.record&&j.record.ready&&j.record.fragment.isEmpty()&&(j.record=null),null===j.record&&(b=l(j)),!j.fail&&null!==j.record&&!j.record.ready&&(b=m(j)),!j.fail&&null!==j.record&&j.record.ready&&k(j,j.record)),b},j.prepare=function(b){return h.queue(j,h.createRecord({type:h.ContentType.application_data,data:a.util.createBuffer(b)})),h.flush(j)},j.close=function(a){!j.fail&&j.sessionCache&&j.session&&j.sessionCache.setSession(j.session.id,j.session),j.open&&(j.open=!1,j.input.clear(),(j.isConnected||j.handshaking)&&(j.isConnected=j.handshaking=!1,h.queue(j,h.createAlert({level:h.Alert.Level.warning,description:h.Alert.Description.close_notify})),h.flush(j)),j.closed(j)),j.reset(a)},j},a.tls=a.tls||{};for(var R in h)"function"!=typeof h[R]&&(a.tls[R]=h[R]);a.tls.prf_tls1=b,a.tls.hmac_sha1=c,a.tls.createSessionCache=h.createSessionCache,a.tls.createConnection=h.createConnection}var c="tls";if("function"!=typeof e){if("object"!=typeof b||!b.exports)return"undefined"==typeof forge&&(forge={}),a(forge);var f=!0;e=function(a,c){c(d,b)}}var g,h=function(b,d){d.exports=function(d){var e=g.map(function(a){return b(a)}).concat(a);if(d=d||{},d.defined=d.defined||{},d.defined[c])return d[c];d.defined[c]=!0;for(var f=0;f<e.length;++f)e[f](d);return d[c]}},i=e;(e=function(a,b){return g="string"==typeof a?b.slice(2):a.slice(2),f?(delete e,i.apply(null,Array.prototype.slice.call(arguments,0))):(e=i,e.apply(null,Array.prototype.slice.call(arguments,0)))})("js/tls",["require","module","./asn1","./hmac","./md","./pem","./pki","./random","./util"],function(){h.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function a(a){function b(b,d,e){var h=d.entity===a.tls.ConnectionEnd.client;b.read.cipherState={init:!1,cipher:a.aes.createDecryptionCipher(h?e.keys.server_write_key:e.keys.client_write_key),iv:h?e.keys.server_write_IV:e.keys.client_write_IV},b.write.cipherState={init:!1,cipher:a.aes.createEncryptionCipher(h?e.keys.client_write_key:e.keys.server_write_key),iv:h?e.keys.client_write_IV:e.keys.server_write_IV},b.read.cipherFunction=f,b.write.cipherFunction=c,b.read.macLength=b.write.macLength=e.mac_length,b.read.macFunction=b.write.macFunction=g.hmac_sha1}function c(b,c){var e=!1,f=c.macFunction(c.macKey,c.sequenceNumber,b);b.fragment.putBytes(f),c.updateSequenceNumber();var g;g=b.version.minor>1?a.random.getBytes(16):c.cipherState.init?null:c.cipherState.iv,c.cipherState.init=!0;var h=c.cipherState.cipher;return h.start(g),b.version.minor>1&&h.output.putBytes(g),h.update(b.fragment),h.finish(d)&&(b.fragment=h.output,b.length=b.fragment.length(),e=!0),e}function d(a,b,c){if(!c){var d=a-b.length()%a;b.fillWithByte(d-1,d)}return!0}function e(a,b,c){var d=!0;if(c){for(var e=b.length(),f=b.last(),g=e-1-f;e-1>g;++g)d=d&&b.at(g)==f;d&&b.truncate(f+1)}return d}function f(b,c){var d=!1,f=c.cipherState.init?null:c.cipherState.iv;c.cipherState.init=!0;var g=c.cipherState.cipher;g.start(f),g.update(b.fragment),d=g.finish(e);for(var h=c.macLength,i="",j=0;h>j;++j)i+=String.fromCharCode(0);var k=g.output.length();k>=h?(b.fragment=g.output.getBytes(k-h),i=g.output.getBytes(h)):b.fragment=g.output.getBytes(),b.fragment=a.util.createBuffer(b.fragment),b.length=b.fragment.length();var l=c.macFunction(c.macKey,c.sequenceNumber,b);return c.updateSequenceNumber(),d=l===i&&d}var g=a.tls;g.CipherSuites.TLS_RSA_WITH_AES_128_CBC_SHA={id:[0,47],name:"TLS_RSA_WITH_AES_128_CBC_SHA",initSecurityParameters:function(a){a.bulk_cipher_algorithm=g.BulkCipherAlgorithm.aes,a.cipher_type=g.CipherType.block,a.enc_key_length=16,a.block_length=16,a.fixed_iv_length=16,a.record_iv_length=16,a.mac_algorithm=g.MACAlgorithm.hmac_sha1,a.mac_length=20,a.mac_key_length=20},initConnectionState:b},g.CipherSuites.TLS_RSA_WITH_AES_256_CBC_SHA={id:[0,53],name:"TLS_RSA_WITH_AES_256_CBC_SHA",initSecurityParameters:function(a){a.bulk_cipher_algorithm=g.BulkCipherAlgorithm.aes,a.cipher_type=g.CipherType.block,a.enc_key_length=32,a.block_length=16,a.fixed_iv_length=16,a.record_iv_length=16,a.mac_algorithm=g.MACAlgorithm.hmac_sha1,a.mac_length=20,a.mac_key_length=20},initConnectionState:b}}var c="aesCipherSuites";if("function"!=typeof e){if("object"!=typeof b||!b.exports)return"undefined"==typeof forge&&(forge={}),a(forge);var f=!0;e=function(a,c){c(d,b)}}var g,h=function(b,d){d.exports=function(d){var e=g.map(function(a){return b(a)}).concat(a);if(d=d||{},d.defined=d.defined||{},d.defined[c])return d[c];d.defined[c]=!0;for(var f=0;f<e.length;++f)e[f](d);return d[c]}},i=e;(e=function(a,b){return g="string"==typeof a?b.slice(2):a.slice(2),f?(delete e,i.apply(null,Array.prototype.slice.call(arguments,0))):(e=i,e.apply(null,Array.prototype.slice.call(arguments,0)))})("js/aesCipherSuites",["require","module","./aes","./tls"],function(){h.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function a(a){a.debug=a.debug||{},a.debug.storage={},a.debug.get=function(b,c){var d;return"undefined"==typeof b?d=a.debug.storage:b in a.debug.storage&&(d="undefined"==typeof c?a.debug.storage[b]:a.debug.storage[b][c]),d},a.debug.set=function(b,c,d){b in a.debug.storage||(a.debug.storage[b]={}),a.debug.storage[b][c]=d},a.debug.clear=function(b,c){"undefined"==typeof b?a.debug.storage={}:b in a.debug.storage&&("undefined"==typeof c?delete a.debug.storage[b]:delete a.debug.storage[b][c])}}var c="debug";if("function"!=typeof e){if("object"!=typeof b||!b.exports)return"undefined"==typeof forge&&(forge={}),a(forge);var f=!0;e=function(a,c){c(d,b)}}var g,h=function(b,d){d.exports=function(d){var e=g.map(function(a){return b(a)}).concat(a);if(d=d||{},d.defined=d.defined||{},d.defined[c])return d[c];d.defined[c]=!0;for(var f=0;f<e.length;++f)e[f](d);return d[c]}},i=e;(e=function(a,b){return g="string"==typeof a?b.slice(2):a.slice(2),f?(delete e,i.apply(null,Array.prototype.slice.call(arguments,0))):(e=i,e.apply(null,Array.prototype.slice.call(arguments,0)))})("js/debug",["require","module"],function(){h.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function a(a){a.log=a.log||{},a.log.levels=["none","error","warning","info","debug","verbose","max"];var b={},c=[],d=null;a.log.LEVEL_LOCKED=2,a.log.NO_LEVEL_CHECK=4,a.log.INTERPOLATE=8;for(var e=0;e<a.log.levels.length;++e){var f=a.log.levels[e];b[f]={index:e,name:f.toUpperCase()}}a.log.logMessage=function(d){for(var e=b[d.level].index,f=0;f<c.length;++f){var g=c[f];if(g.flags&a.log.NO_LEVEL_CHECK)g.f(d);else{var h=b[g.level].index;h>=e&&g.f(g,d)}}},a.log.prepareStandard=function(a){"standard"in a||(a.standard=b[a.level].name+" ["+a.category+"] "+a.message)},a.log.prepareFull=function(b){if(!("full"in b)){var c=[b.message];c=c.concat([]||b.arguments),b.full=a.util.format.apply(this,c)}},a.log.prepareStandardFull=function(b){"standardFull"in b||(a.log.prepareStandard(b),b.standardFull=b.standard)};for(var g=["error","warning","info","debug","verbose"],e=0;e<g.length;++e)(function(b){a.log[b]=function(c,d){var e=Array.prototype.slice.call(arguments).slice(2),f={timestamp:new Date,level:b,category:c,message:d,arguments:e};a.log.logMessage(f)}})(g[e]);if(a.log.makeLogger=function(b){var c={flags:0,f:b};return a.log.setLevel(c,"none"),c},a.log.setLevel=function(b,c){var d=!1;if(b&&!(b.flags&a.log.LEVEL_LOCKED))for(var e=0;e<a.log.levels.length;++e){var f=a.log.levels[e];if(c==f){b.level=c,d=!0;break}}return d},a.log.lock=function(b,c){"undefined"==typeof c||c?b.flags|=a.log.LEVEL_LOCKED:b.flags&=~a.log.LEVEL_LOCKED},a.log.addLogger=function(a){c.push(a)},"undefined"!=typeof console&&"log"in console){var h;if(console.error&&console.warn&&console.info&&console.debug){var i={error:console.error,warning:console.warn,info:console.info,debug:console.debug,verbose:console.debug},j=function(b,c){a.log.prepareStandard(c);var d=i[c.level],e=[c.standard];e=e.concat(c.arguments.slice()),d.apply(console,e)};h=a.log.makeLogger(j)}else{var j=function(b,c){a.log.prepareStandardFull(c),console.log(c.standardFull)};h=a.log.makeLogger(j)}a.log.setLevel(h,"debug"),a.log.addLogger(h),d=h}else console={log:function(){}};if(null!==d){var k=a.util.getQueryVariables();if("console.level"in k&&a.log.setLevel(d,k["console.level"].slice(-1)[0]),"console.lock"in k){var l=k["console.lock"].slice(-1)[0];"true"==l&&a.log.lock(d)}}a.log.consoleLogger=d}var c="log";if("function"!=typeof e){if("object"!=typeof b||!b.exports)return"undefined"==typeof forge&&(forge={}),a(forge);var f=!0;e=function(a,c){c(d,b)}}var g,h=function(b,d){d.exports=function(d){var e=g.map(function(a){return b(a)}).concat(a);if(d=d||{},d.defined=d.defined||{},d.defined[c])return d[c];d.defined[c]=!0;for(var f=0;f<e.length;++f)e[f](d);return d[c]}},i=e;(e=function(a,b){return g="string"==typeof a?b.slice(2):a.slice(2),f?(delete e,i.apply(null,Array.prototype.slice.call(arguments,0))):(e=i,e.apply(null,Array.prototype.slice.call(arguments,0)))})("js/log",["require","module","./util"],function(){h.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function a(a){var b=a.asn1,c=a.pkcs7=a.pkcs7||{};c.messageFromPem=function(d){var e=a.pem.decode(d)[0];if("PKCS7"!==e.type)throw{message:'Could not convert PKCS#7 message from PEM; PEM header type is not "PKCS#7".',headerType:e.type};if(e.procType&&"ENCRYPTED"===e.procType.type)throw{message:"Could not convert PKCS#7 message from PEM; PEM is encrypted."};var f=b.fromDer(e.body);return c.messageFromAsn1(f)},c.messageToPem=function(c,d){var e={type:"PKCS7",body:b.toDer(c.toAsn1()).getBytes()};return a.pem.encode(e,{maxline:d})},c.messageFromAsn1=function(d){var e={},f=[];if(!b.validate(d,c.asn1.contentInfoValidator,e,f))throw{message:"Cannot read PKCS#7 message. ASN.1 object is not an PKCS#7 ContentInfo.",errors:f};
var g,h=b.derToOid(e.contentType);switch(h){case a.pki.oids.envelopedData:g=c.createEnvelopedData();break;case a.pki.oids.encryptedData:g=c.createEncryptedData();break;case a.pki.oids.signedData:g=c.createSignedData();break;default:throw{message:"Cannot read PKCS#7 message. ContentType with OID "+h+" is not (yet) supported."}}return g.fromAsn1(e.content.value[0]),g};var d=function(d){var e={},f=[];if(!b.validate(d,c.asn1.recipientInfoValidator,e,f))throw{message:"Cannot read PKCS#7 message. ASN.1 object is not an PKCS#7 EnvelopedData.",errors:f};return{version:e.version.charCodeAt(0),issuer:a.pki.RDNAttributesAsArray(e.issuer),serialNumber:a.util.createBuffer(e.serial).toHex(),encryptedContent:{algorithm:b.derToOid(e.encAlgorithm),parameter:e.encParameter.value,content:e.encKey}}},e=function(c){return b.create(b.Class.UNIVERSAL,b.Type.SEQUENCE,!0,[b.create(b.Class.UNIVERSAL,b.Type.INTEGER,!1,b.integerToDer(c.version).getBytes()),b.create(b.Class.UNIVERSAL,b.Type.SEQUENCE,!0,[a.pki.distinguishedNameToAsn1({attributes:c.issuer}),b.create(b.Class.UNIVERSAL,b.Type.INTEGER,!1,a.util.hexToBytes(c.serialNumber))]),b.create(b.Class.UNIVERSAL,b.Type.SEQUENCE,!0,[b.create(b.Class.UNIVERSAL,b.Type.OID,!1,b.oidToDer(c.encryptedContent.algorithm).getBytes()),b.create(b.Class.UNIVERSAL,b.Type.NULL,!1,"")]),b.create(b.Class.UNIVERSAL,b.Type.OCTETSTRING,!1,c.encryptedContent.content)])},f=function(a){for(var b=[],c=0;c<a.length;c++)b.push(d(a[c]));return b},g=function(a){for(var b=[],c=0;c<a.length;c++)b.push(e(a[c]));return b},h=function(c){return[b.create(b.Class.UNIVERSAL,b.Type.OID,!1,b.oidToDer(a.pki.oids.data).getBytes()),b.create(b.Class.UNIVERSAL,b.Type.SEQUENCE,!0,[b.create(b.Class.UNIVERSAL,b.Type.OID,!1,b.oidToDer(c.algorithm).getBytes()),b.create(b.Class.UNIVERSAL,b.Type.OCTETSTRING,!1,c.parameter.getBytes())]),b.create(b.Class.CONTEXT_SPECIFIC,0,!0,[b.create(b.Class.UNIVERSAL,b.Type.OCTETSTRING,!1,c.content.getBytes())])]},i=function(c,d,e){var f={},g=[];if(!b.validate(d,e,f,g))throw{message:"Cannot read PKCS#7 message. ASN.1 object is not a supported PKCS#7 message.",errors:g};var h=b.derToOid(f.contentType);if(h!==a.pki.oids.data)throw{message:"Unsupported PKCS#7 message. Only wrapped ContentType Data supported."};if(f.encryptedContent){var i="";if(a.util.isArray(f.encryptedContent))for(var j=0;j<f.encryptedContent.length;++j){if(f.encryptedContent[j].type!==b.Type.OCTETSTRING)throw{message:"Malformed PKCS#7 message, expecting encrypted content constructed of only OCTET STRING objects."};i+=f.encryptedContent[j].value}else i=f.encryptedContent;c.encryptedContent={algorithm:b.derToOid(f.encAlgorithm),parameter:a.util.createBuffer(f.encParameter.value),content:a.util.createBuffer(i)}}if(f.content){var i="";if(a.util.isArray(f.content))for(var j=0;j<f.content.length;++j){if(f.content[j].type!==b.Type.OCTETSTRING)throw{message:"Malformed PKCS#7 message, expecting content constructed of only OCTET STRING objects."};i+=f.content[j].value}else i=f.content;c.content=a.util.createBuffer(i)}return c.version=f.version.charCodeAt(0),c.rawCapture=f,f},j=function(b){if(void 0===b.encryptedContent.key)throw{message:"Symmetric key not available."};if(void 0===b.content){var c;switch(b.encryptedContent.algorithm){case a.pki.oids["aes128-CBC"]:case a.pki.oids["aes192-CBC"]:case a.pki.oids["aes256-CBC"]:c=a.aes.createDecryptionCipher(b.encryptedContent.key);break;case a.pki.oids.desCBC:case a.pki.oids["des-EDE3-CBC"]:c=a.des.createDecryptionCipher(b.encryptedContent.key);break;default:throw{message:"Unsupported symmetric cipher, OID "+b.encryptedContent.algorithm}}if(c.start(b.encryptedContent.parameter),c.update(b.encryptedContent.content),!c.finish())throw{message:"Symmetric decryption failed."};b.content=c.output}};c.createSignedData=function(){var d=null;return d={type:a.pki.oids.signedData,version:1,certificates:[],crls:[],digestAlgorithmIdentifiers:[],contentInfo:null,signerInfos:[],fromAsn1:function(b){i(d,b,c.asn1.signedDataValidator),d.certificates=[],d.crls=[],d.digestAlgorithmIdentifiers=[],d.contentInfo=null,d.signerInfos=[];for(var e=d.rawCapture.certificates.value,f=0;f<e.length;++f)d.certificates.push(a.pki.certificateFromAsn1(e[f]))},toAsn1:function(){if("content"in d)throw"Signing PKCS#7 content not yet implemented.";d.contentInfo||d.sign();for(var c=[],e=0;e<d.certificates.length;++e)c.push(a.pki.certificateToAsn1(d.certificates[0]));var f=[];return b.create(b.Class.UNIVERSAL,b.Type.SEQUENCE,!0,[b.create(b.Class.UNIVERSAL,b.Type.OID,!1,b.oidToDer(d.type).getBytes()),b.create(b.Class.CONTEXT_SPECIFIC,0,!0,[b.create(b.Class.UNIVERSAL,b.Type.SEQUENCE,!0,[b.create(b.Class.UNIVERSAL,b.Type.INTEGER,!1,b.integerToDer(d.version).getBytes()),b.create(b.Class.UNIVERSAL,b.Type.SET,!0,d.digestAlgorithmIdentifiers),d.contentInfo,b.create(b.Class.CONTEXT_SPECIFIC,0,!0,c),b.create(b.Class.CONTEXT_SPECIFIC,1,!0,f),b.create(b.Class.UNIVERSAL,b.Type.SET,!0,d.signerInfos)])])])},sign:function(){if("content"in d)throw"PKCS#7 signing not yet implemented.";"object"!=typeof d.content&&(d.contentInfo=b.create(b.Class.UNIVERSAL,b.Type.SEQUENCE,!0,[b.create(b.Class.UNIVERSAL,b.Type.OID,!1,b.oidToDer(a.pki.oids.data).getBytes())]),"content"in d&&d.contentInfo.value.push(b.create(b.Class.CONTEXT_SPECIFIC,0,!0,[b.create(b.Class.UNIVERSAL,b.Type.OCTETSTRING,!1,d.content)])))},verify:function(){throw"PKCS#7 signature verification not yet implemented."},addCertificate:function(b){"string"==typeof b&&(b=a.pki.certificateFromPem(b)),d.certificates.push(b)},addCertificateRevokationList:function(){throw"PKCS#7 CRL support not yet implemented."}}},c.createEncryptedData=function(){var b=null;return b={type:a.pki.oids.encryptedData,version:0,encryptedContent:{algorithm:a.pki.oids["aes256-CBC"]},fromAsn1:function(a){i(b,a,c.asn1.encryptedDataValidator)},decrypt:function(a){void 0!==a&&(b.encryptedContent.key=a),j(b)}}},c.createEnvelopedData=function(){var d=null;return d={type:a.pki.oids.envelopedData,version:0,recipients:[],encryptedContent:{algorithm:a.pki.oids["aes256-CBC"]},fromAsn1:function(a){var b=i(d,a,c.asn1.envelopedDataValidator);d.recipients=f(b.recipientInfos.value)},toAsn1:function(){return b.create(b.Class.UNIVERSAL,b.Type.SEQUENCE,!0,[b.create(b.Class.UNIVERSAL,b.Type.OID,!1,b.oidToDer(d.type).getBytes()),b.create(b.Class.CONTEXT_SPECIFIC,0,!0,[b.create(b.Class.UNIVERSAL,b.Type.SEQUENCE,!0,[b.create(b.Class.UNIVERSAL,b.Type.INTEGER,!1,b.integerToDer(d.version).getBytes()),b.create(b.Class.UNIVERSAL,b.Type.SET,!0,g(d.recipients)),b.create(b.Class.UNIVERSAL,b.Type.SEQUENCE,!0,h(d.encryptedContent))])])])},findRecipient:function(a){for(var b=a.issuer.attributes,c=0;c<d.recipients.length;++c){var e=d.recipients[c],f=e.issuer;if(e.serialNumber===a.serialNumber&&f.length===b.length){for(var g=!0,h=0;h<b.length;++h)if(f[h].type!==b[h].type||f[h].value!==b[h].value){g=!1;break}if(g)return e}}return null},decrypt:function(b,c){if(void 0===d.encryptedContent.key&&void 0!==b&&void 0!==c)switch(b.encryptedContent.algorithm){case a.pki.oids.rsaEncryption:case a.pki.oids.desCBC:var e=c.decrypt(b.encryptedContent.content);d.encryptedContent.key=a.util.createBuffer(e);break;default:throw{message:"Unsupported asymmetric cipher, OID "+b.encryptedContent.algorithm}}j(d)},addRecipient:function(b){d.recipients.push({version:0,issuer:b.subject.attributes,serialNumber:b.serialNumber,encryptedContent:{algorithm:a.pki.oids.rsaEncryption,key:b.publicKey}})},encrypt:function(b,c){if(void 0===d.encryptedContent.content){c=c||d.encryptedContent.algorithm,b=b||d.encryptedContent.key;var e,f,g;switch(c){case a.pki.oids["aes128-CBC"]:e=16,f=16,g=a.aes.createEncryptionCipher;break;case a.pki.oids["aes192-CBC"]:e=24,f=16,g=a.aes.createEncryptionCipher;break;case a.pki.oids["aes256-CBC"]:e=32,f=16,g=a.aes.createEncryptionCipher;break;case a.pki.oids["des-EDE3-CBC"]:e=24,f=8,g=a.des.createEncryptionCipher;break;default:throw{message:"Unsupported symmetric cipher, OID "+c}}if(void 0===b)b=a.util.createBuffer(a.random.getBytes(e));else if(b.length()!=e)throw{message:"Symmetric key has wrong length, got "+b.length()+" bytes, expected "+e};d.encryptedContent.algorithm=c,d.encryptedContent.key=b,d.encryptedContent.parameter=a.util.createBuffer(a.random.getBytes(f));var h=g(b);if(h.start(d.encryptedContent.parameter.copy()),h.update(d.content),!h.finish())throw{message:"Symmetric encryption failed."};d.encryptedContent.content=h.output}for(var i=0;i<d.recipients.length;i++){var j=d.recipients[i];if(void 0===j.encryptedContent.content)switch(j.encryptedContent.algorithm){case a.pki.oids.rsaEncryption:j.encryptedContent.content=j.encryptedContent.key.encrypt(d.encryptedContent.key.data);break;default:throw{message:"Unsupported asymmetric cipher, OID "+j.encryptedContent.algorithm}}}}}}}var c="pkcs7";if("function"!=typeof e){if("object"!=typeof b||!b.exports)return"undefined"==typeof forge&&(forge={}),a(forge);var f=!0;e=function(a,c){c(d,b)}}var g,h=function(b,d){d.exports=function(d){var e=g.map(function(a){return b(a)}).concat(a);if(d=d||{},d.defined=d.defined||{},d.defined[c])return d[c];d.defined[c]=!0;for(var f=0;f<e.length;++f)e[f](d);return d[c]}},i=e;(e=function(a,b){return g="string"==typeof a?b.slice(2):a.slice(2),f?(delete e,i.apply(null,Array.prototype.slice.call(arguments,0))):(e=i,e.apply(null,Array.prototype.slice.call(arguments,0)))})("js/pkcs7",["require","module","./aes","./asn1","./des","./oids","./pem","./pkcs7asn1","./random","./util","./x509"],function(){h.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function a(a){var b="forge.task",c=0,d={},e=0;a.debug.set(b,"tasks",d);var f={};a.debug.set(b,"queues",f);var g="?",h=30,i=20,j="ready",k="running",l="blocked",m="sleeping",n="done",o="error",p="stop",q="start",r="block",s="unblock",t="sleep",u="wakeup",v="cancel",w="fail",x={};x[j]={},x[j][p]=j,x[j][q]=k,x[j][v]=n,x[j][w]=o,x[k]={},x[k][p]=j,x[k][q]=k,x[k][r]=l,x[k][s]=k,x[k][t]=m,x[k][u]=k,x[k][v]=n,x[k][w]=o,x[l]={},x[l][p]=l,x[l][q]=l,x[l][r]=l,x[l][s]=l,x[l][t]=l,x[l][u]=l,x[l][v]=n,x[l][w]=o,x[m]={},x[m][p]=m,x[m][q]=m,x[m][r]=m,x[m][s]=m,x[m][t]=m,x[m][u]=m,x[m][v]=n,x[m][w]=o,x[n]={},x[n][p]=n,x[n][q]=n,x[n][r]=n,x[n][s]=n,x[n][t]=n,x[n][u]=n,x[n][v]=n,x[n][w]=o,x[o]={},x[o][p]=o,x[o][q]=o,x[o][r]=o,x[o][s]=o,x[o][t]=o,x[o][u]=o,x[o][v]=o,x[o][w]=o;var y=function(f){this.id=-1,this.name=f.name||g,this.parent=f.parent||null,this.run=f.run,this.subtasks=[],this.error=!1,this.state=j,this.blocks=0,this.timeoutId=null,this.swapTime=null,this.userData=null,this.id=e++,d[this.id]=this,c>=1&&a.log.verbose(b,"[%s][%s] init",this.id,this.name,this)};y.prototype.debug=function(c){c=c||"",a.log.debug(b,c,"[%s][%s] task:",this.id,this.name,this,"subtasks:",this.subtasks.length,"queue:",f)},y.prototype.next=function(a,b){"function"==typeof a&&(b=a,a=this.name);var c=new y({run:b,name:a,parent:this});return c.state=k,c.type=this.type,c.successCallback=this.successCallback||null,c.failureCallback=this.failureCallback||null,this.subtasks.push(c),this},y.prototype.parallel=function(b,c){return a.util.isArray(b)&&(c=b,b=this.name),this.next(b,function(d){var e=d;e.block(c.length);for(var f=function(b,d){a.task.start({type:b,run:function(a){c[d](a)},success:function(){e.unblock()},failure:function(){e.unblock()}})},g=0;g<c.length;g++){var h=b+"__parallel-"+d.id+"-"+g,i=g;f(h,i)}})},y.prototype.stop=function(){this.state=x[this.state][p]},y.prototype.start=function(){this.error=!1,this.state=x[this.state][q],this.state===k&&(this.start=new Date,this.run(this),A(this,0))},y.prototype.block=function(a){a="undefined"==typeof a?1:a,this.blocks+=a,this.blocks>0&&(this.state=x[this.state][r])},y.prototype.unblock=function(a){return a="undefined"==typeof a?1:a,this.blocks-=a,0===this.blocks&&this.state!==n&&(this.state=k,A(this,0)),this.blocks},y.prototype.sleep=function(a){a="undefined"==typeof a?0:a,this.state=x[this.state][t];var b=this;this.timeoutId=setTimeout(function(){b.timeoutId=null,b.state=k,A(b,0)},a)},y.prototype.wait=function(a){a.wait(this)},y.prototype.wakeup=function(){this.state===m&&(cancelTimeout(this.timeoutId),this.timeoutId=null,this.state=k,A(this,0))},y.prototype.cancel=function(){this.state=x[this.state][v],this.permitsNeeded=0,null!==this.timeoutId&&(cancelTimeout(this.timeoutId),this.timeoutId=null),this.subtasks=[]},y.prototype.fail=function(a){if(this.error=!0,B(this,!0),a)a.error=this.error,a.swapTime=this.swapTime,a.userData=this.userData,A(a,0);else{if(null!==this.parent){for(var b=this.parent;null!==b.parent;)b.error=this.error,b.swapTime=this.swapTime,b.userData=this.userData,b=b.parent;B(b,!0)}this.failureCallback&&this.failureCallback(this)}};var z=function(a){a.error=!1,a.state=x[a.state][q],setTimeout(function(){a.state===k&&(a.swapTime=+new Date,a.run(a),A(a,0))},0)},A=function(a,b){var c=b>h||+new Date-a.swapTime>i,d=function(b){if(b++,a.state===k)if(c&&(a.swapTime=+new Date),a.subtasks.length>0){var d=a.subtasks.shift();d.error=a.error,d.swapTime=a.swapTime,d.userData=a.userData,d.run(d),d.error||A(d,b)}else B(a),a.error||null!==a.parent&&(a.parent.error=a.error,a.parent.swapTime=a.swapTime,a.parent.userData=a.userData,A(a.parent,b))};c?setTimeout(d,0):d(b)},B=function(e,g){e.state=n,delete d[e.id],c>=1&&a.log.verbose(b,"[%s][%s] finish",e.id,e.name,e),null===e.parent&&(e.type in f?0===f[e.type].length?a.log.error(b,"[%s][%s] task queue empty [%s]",e.id,e.name,e.type):f[e.type][0]!==e?a.log.error(b,"[%s][%s] task not first in queue [%s]",e.id,e.name,e.type):(f[e.type].shift(),0===f[e.type].length?(c>=1&&a.log.verbose(b,"[%s][%s] delete queue [%s]",e.id,e.name,e.type),delete f[e.type]):(c>=1&&a.log.verbose(b,"[%s][%s] queue start next [%s] remain:%s",e.id,e.name,e.type,f[e.type].length),f[e.type][0].start())):a.log.error(b,"[%s][%s] task queue missing [%s]",e.id,e.name,e.type),g||(e.error&&e.failureCallback?e.failureCallback(e):!e.error&&e.successCallback&&e.successCallback(e)))};a.task=a.task||{},a.task.start=function(d){var e=new y({run:d.run,name:d.name||g});e.type=d.type,e.successCallback=d.success||null,e.failureCallback=d.failure||null,e.type in f?f[d.type].push(e):(c>=1&&a.log.verbose(b,"[%s][%s] create queue [%s]",e.id,e.name,e.type),f[e.type]=[e],z(e))},a.task.cancel=function(a){a in f&&(f[a]=[f[a][0]])},a.task.createCondition=function(){var a={tasks:{}};return a.wait=function(b){b.id in a.tasks||(b.block(),a.tasks[b.id]=b)},a.notify=function(){var b=a.tasks;a.tasks={};for(var c in b)b[c].unblock()},a}}var c="task";if("function"!=typeof e){if("object"!=typeof b||!b.exports)return"undefined"==typeof forge&&(forge={}),a(forge);var f=!0;e=function(a,c){c(d,b)}}var g,h=function(b,d){d.exports=function(d){var e=g.map(function(a){return b(a)}).concat(a);if(d=d||{},d.defined=d.defined||{},d.defined[c])return d[c];d.defined[c]=!0;for(var f=0;f<e.length;++f)e[f](d);return d[c]}},i=e;(e=function(a,b){return g="string"==typeof a?b.slice(2):a.slice(2),f?(delete e,i.apply(null,Array.prototype.slice.call(arguments,0))):(e=i,e.apply(null,Array.prototype.slice.call(arguments,0)))})("js/task",["require","module","./debug","./log","./util"],function(){h.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){var a="forge";if("function"!=typeof e){if("object"!=typeof b||!b.exports)return void("undefined"==typeof forge&&(forge={disableNativeCode:!1}));var c=!0;e=function(a,c){c(d,b)}}var f,g=function(b,c){c.exports=function(c){var d=f.map(function(a){return b(a)});if(c=c||{},c.defined=c.defined||{},c.defined[a])return c[a];c.defined[a]=!0;for(var e=0;e<d.length;++e)d[e](c);return c},c.exports.disableNativeCode=!1,c.exports(c.exports)},h=e;(e=function(a,b){return f="string"==typeof a?b.slice(2):a.slice(2),c?(delete e,h.apply(null,Array.prototype.slice.call(arguments,0))):(e=h,e.apply(null,Array.prototype.slice.call(arguments,0)))})("js/forge",["require","module","./aes","./aesCipherSuites","./asn1","./debug","./des","./hmac","./log","./pbkdf2","./pem","./pkcs7","./pkcs1","./pkcs12","./pki","./prng","./pss","./random","./rc2","./task","./tls","./util","./md","./mgf1"],function(){g.apply(null,Array.prototype.slice.call(arguments,0))})}(),window.forge=d("js/forge")}()}).call(this,a("sycGbZ"))},{sycGbZ:51}],6:[function(a,b,c){(function(b){function d(a,b){return a.length>=b?a:d("0"+a,b)}var e=a("crypto"),f=a("jsbn"),g=a("./lib/ec.js").ECPointFp;c.ECCurves=a("./lib/sec.js"),c.ECKey=function(a,c,h){var i,j=a(),k=j.getN(),l=Math.floor(k.bitLength()/8);if(c)if(h){if(c.length!=2*l+1)return!1;var a=j.getCurve(),m=c.slice(1,l+1),n=c.slice(l+1);this.P=new g(a,a.fromBigInteger(new f(m.toString("hex"),16)),a.fromBigInteger(new f(n.toString("hex"),16)))}else{if(c.length!=l)return!1;i=new f(c.toString("hex"),16)}else{var o=k.subtract(f.ONE),p=new f(e.randomBytes(k.bitLength()));i=p.mod(o).add(f.ONE),this.P=j.getG().multiply(i)}if(this.P){var q=d(this.P.getX().toBigInteger().toString(16),2*l)+d(this.P.getY().toBigInteger().toString(16),2*l);this.PublicKey=new b("04"+q,"hex")}i&&(this.PrivateKey=new b(d(i.toString(16),2*l),"hex"),this.deriveSharedSecret=function(a){if(!a||!a.P)return!1;var c=a.P.multiply(i);return new b(d(c.getX().toBigInteger().toString(16),2*l),"hex")})}}).call(this,a("buffer").Buffer)},{"./lib/ec.js":7,"./lib/sec.js":8,buffer:29,crypto:35,jsbn:9}],7:[function(a,b,c){function d(a,b){this.x=b,this.q=a}function e(a){return a==this?!0:this.q.equals(a.q)&&this.x.equals(a.x)}function f(){return this.x}function g(){return new d(this.q,this.x.negate().mod(this.q))}function h(a){return new d(this.q,this.x.add(a.toBigInteger()).mod(this.q))}function i(a){return new d(this.q,this.x.subtract(a.toBigInteger()).mod(this.q))}function j(a){return new d(this.q,this.x.multiply(a.toBigInteger()).mod(this.q))}function k(){return new d(this.q,this.x.square().mod(this.q))}function l(a){return new d(this.q,this.x.multiply(a.toBigInteger().modInverse(this.q)).mod(this.q))}function m(a,b,c,d){this.curve=a,this.x=b,this.y=c,this.z=null==d?G.ONE:d,this.zinv=null}function n(){null==this.zinv&&(this.zinv=this.z.modInverse(this.curve.q));var a=this.x.toBigInteger().multiply(this.zinv);return this.curve.reduce(a),this.curve.fromBigInteger(a)}function o(){null==this.zinv&&(this.zinv=this.z.modInverse(this.curve.q));var a=this.y.toBigInteger().multiply(this.zinv);return this.curve.reduce(a),this.curve.fromBigInteger(a)}function p(a){if(a==this)return!0;if(this.isInfinity())return a.isInfinity();if(a.isInfinity())return this.isInfinity();var b,c;return b=a.y.toBigInteger().multiply(this.z).subtract(this.y.toBigInteger().multiply(a.z)).mod(this.curve.q),b.equals(G.ZERO)?(c=a.x.toBigInteger().multiply(this.z).subtract(this.x.toBigInteger().multiply(a.z)).mod(this.curve.q),c.equals(G.ZERO)):!1}function q(){return null==this.x&&null==this.y?!0:this.z.equals(G.ZERO)&&!this.y.toBigInteger().equals(G.ZERO)}function r(){return new m(this.curve,this.x,this.y.negate(),this.z)}function s(a){if(this.isInfinity())return a;if(a.isInfinity())return this;var b=a.y.toBigInteger().multiply(this.z).subtract(this.y.toBigInteger().multiply(a.z)).mod(this.curve.q),c=a.x.toBigInteger().multiply(this.z).subtract(this.x.toBigInteger().multiply(a.z)).mod(this.curve.q);if(G.ZERO.equals(c))return G.ZERO.equals(b)?this.twice():this.curve.getInfinity();var d=new G("3"),e=this.x.toBigInteger(),f=this.y.toBigInteger(),g=(a.x.toBigInteger(),a.y.toBigInteger(),c.square()),h=g.multiply(c),i=e.multiply(g),j=b.square().multiply(this.z),k=j.subtract(i.shiftLeft(1)).multiply(a.z).subtract(h).multiply(c).mod(this.curve.q),l=i.multiply(d).multiply(b).subtract(f.multiply(h)).subtract(j.multiply(b)).multiply(a.z).add(b.multiply(h)).mod(this.curve.q),n=h.multiply(this.z).multiply(a.z).mod(this.curve.q);return new m(this.curve,this.curve.fromBigInteger(k),this.curve.fromBigInteger(l),n)}function t(){if(this.isInfinity())return this;if(0==this.y.toBigInteger().signum())return this.curve.getInfinity();var a=new G("3"),b=this.x.toBigInteger(),c=this.y.toBigInteger(),d=c.multiply(this.z),e=d.multiply(c).mod(this.curve.q),f=this.curve.a.toBigInteger(),g=b.square().multiply(a);G.ZERO.equals(f)||(g=g.add(this.z.square().multiply(f))),g=g.mod(this.curve.q);var h=g.square().subtract(b.shiftLeft(3).multiply(e)).shiftLeft(1).multiply(d).mod(this.curve.q),i=g.multiply(a).multiply(b).subtract(e.shiftLeft(1)).shiftLeft(2).multiply(e).subtract(g.square().multiply(g)).mod(this.curve.q),j=d.square().multiply(d).shiftLeft(3).mod(this.curve.q);return new m(this.curve,this.curve.fromBigInteger(h),this.curve.fromBigInteger(i),j)}function u(a){if(this.isInfinity())return this;if(0==a.signum())return this.curve.getInfinity();var b,c=a,d=c.multiply(new G("3")),e=this.negate(),f=this;for(b=d.bitLength()-2;b>0;--b){f=f.twice();var g=d.testBit(b),h=c.testBit(b);g!=h&&(f=f.add(g?this:e))}return f}function v(a,b,c){var d;d=a.bitLength()>c.bitLength()?a.bitLength()-1:c.bitLength()-1;for(var e=this.curve.getInfinity(),f=this.add(b);d>=0;)e=e.twice(),a.testBit(d)?e=e.add(c.testBit(d)?f:this):c.testBit(d)&&(e=e.add(b)),--d;return e}function w(a,b,c){this.q=a,this.a=this.fromBigInteger(b),this.b=this.fromBigInteger(c),this.infinity=new m(this,null,null),this.reducer=new H(this.q)}function x(){return this.q}function y(){return this.a}function z(){return this.b}function A(a){return a==this?!0:this.q.equals(a.q)&&this.a.equals(a.a)&&this.b.equals(a.b)}function B(){return this.infinity}function C(a){return new d(this.q,a)}function D(a){this.reducer.reduce(a)}function E(a){switch(parseInt(a.substr(0,2),16)){case 0:return this.infinity;case 2:case 3:return null;case 4:case 6:case 7:var b=(a.length-2)/2,c=a.substr(2,b),d=a.substr(b+2,b);return new m(this,this.fromBigInteger(new G(c,16)),this.fromBigInteger(new G(d,16)));default:return null}}function F(a){if(a.isInfinity())return"00";var b=a.getX().toBigInteger().toString(16),c=a.getY().toBigInteger().toString(16),d=this.getQ().toString(16).length;for(d%2!=0&&d++;b.length<d;)b="0"+b;for(;c.length<d;)c="0"+c;return"04"+b+c}var G=a("jsbn"),H=G.prototype.Barrett;d.prototype.equals=e,d.prototype.toBigInteger=f,d.prototype.negate=g,d.prototype.add=h,d.prototype.subtract=i,d.prototype.multiply=j,d.prototype.square=k,d.prototype.divide=l,m.prototype.getX=n,m.prototype.getY=o,m.prototype.equals=p,m.prototype.isInfinity=q,m.prototype.negate=r,m.prototype.add=s,m.prototype.twice=t,m.prototype.multiply=u,m.prototype.multiplyTwo=v,w.prototype.getQ=x,w.prototype.getA=y,w.prototype.getB=z,w.prototype.equals=A,w.prototype.getInfinity=B,w.prototype.fromBigInteger=C,w.prototype.reduce=D,w.prototype.decodePointHex=E,w.prototype.encodePointHex=F;var c={ECCurveFp:w,ECPointFp:m,ECFieldElementFp:d};b.exports=c},{jsbn:9}],8:[function(a,b){function c(a,b,c,d){this.curve=a,this.g=b,this.n=c,this.h=d}function d(){return this.curve}function e(){return this.g}function f(){return this.n}function g(){return this.h}function h(a){return new p(a,16)}function i(){var a=h("FFFFFFFDFFFFFFFFFFFFFFFFFFFFFFFF"),b=h("FFFFFFFDFFFFFFFFFFFFFFFFFFFFFFFC"),d=h("E87579C11079F43DD824993C2CEE5ED3"),e=h("FFFFFFFE0000000075A30D1B9038A115"),f=p.ONE,g=new q(a,b,d),i=g.decodePointHex("04161FF7528B899B2D0C28607CA52C5B86CF5AC8395BAFEB13C02DA292DDED7A83");return new c(g,i,e,f)}function j(){var a=h("FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFAC73"),b=p.ZERO,d=h("7"),e=h("0100000000000000000001B8FA16DFAB9ACA16B6B3"),f=p.ONE,g=new q(a,b,d),i=g.decodePointHex("043B4C382CE37AA192A4019E763036F4F5DD4D7EBB938CF935318FDCED6BC28286531733C3F03C4FEE");return new c(g,i,e,f)}function k(){var a=h("FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF7FFFFFFF"),b=h("FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF7FFFFFFC"),d=h("1C97BEFC54BD7A8B65ACF89F81D4D4ADC565FA45"),e=h("0100000000000000000001F4C8F927AED3CA752257"),f=p.ONE,g=new q(a,b,d),i=g.decodePointHex("044A96B5688EF573284664698968C38BB913CBFC8223A628553168947D59DCC912042351377AC5FB32");return new c(g,i,e,f)}function l(){var a=h("FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFEE37"),b=p.ZERO,d=h("3"),e=h("FFFFFFFFFFFFFFFFFFFFFFFE26F2FC170F69466A74DEFD8D"),f=p.ONE,g=new q(a,b,d),i=g.decodePointHex("04DB4FF10EC057E9AE26B07D0280B7F4341DA5D1B1EAE06C7D9B2F2F6D9C5628A7844163D015BE86344082AA88D95E2F9D");return new c(g,i,e,f)}function m(){var a=h("FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFFFFFFFFFF"),b=h("FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFFFFFFFFFC"),d=h("64210519E59C80E70FA7E9AB72243049FEB8DEECC146B9B1"),e=h("FFFFFFFFFFFFFFFFFFFFFFFF99DEF836146BC9B1B4D22831"),f=p.ONE,g=new q(a,b,d),i=g.decodePointHex("04188DA80EB03090F67CBF20EB43A18800F4FF0AFD82FF101207192B95FFC8DA78631011ED6B24CDD573F977A11E794811");return new c(g,i,e,f)}function n(){var a=h("FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF000000000000000000000001"),b=h("FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFFFFFFFFFFFFFFFFFE"),d=h("B4050A850C04B3ABF54132565044B0B7D7BFD8BA270B39432355FFB4"),e=h("FFFFFFFFFFFFFFFFFFFFFFFFFFFF16A2E0B8F03E13DD29455C5C2A3D"),f=p.ONE,g=new q(a,b,d),i=g.decodePointHex("04B70E0CBD6BB4BF7F321390B94A03C1D356C21122343280D6115C1D21BD376388B5F723FB4C22DFE6CD4375A05A07476444D5819985007E34");return new c(g,i,e,f)}function o(){var a=h("FFFFFFFF00000001000000000000000000000000FFFFFFFFFFFFFFFFFFFFFFFF"),b=h("FFFFFFFF00000001000000000000000000000000FFFFFFFFFFFFFFFFFFFFFFFC"),d=h("5AC635D8AA3A93E7B3EBBD55769886BC651D06B0CC53B0F63BCE3C3E27D2604B"),e=h("FFFFFFFF00000000FFFFFFFFFFFFFFFFBCE6FAADA7179E84F3B9CAC2FC632551"),f=p.ONE,g=new q(a,b,d),i=g.decodePointHex("046B17D1F2E12C4247F8BCE6E563A440F277037D812DEB33A0F4A13945D898C2964FE342E2FE1A7F9B8EE7EB4A7C0F9E162BCE33576B315ECECBB6406837BF51F5");return new c(g,i,e,f)}var p=a("jsbn"),q=a("./ec.js").ECCurveFp;c.prototype.getCurve=d,c.prototype.getG=e,c.prototype.getN=f,c.prototype.getH=g,b.exports={secp128r1:i,secp160k1:j,secp160r1:k,secp192k1:l,secp192r1:m,secp224r1:n,secp256r1:o}},{"./ec.js":7,jsbn:9}],9:[function(a,b,c){(function(){function a(a,b,c){null!=a&&("number"==typeof a?this.fromNumber(a,b,c):null==b&&"string"!=typeof a?this.fromString(a,256):this.fromString(a,b))}function d(){return new a(null)}function e(a,b,c,d,e,f){for(;--f>=0;){var g=b*this[a++]+c[d]+e;e=Math.floor(g/67108864),c[d++]=67108863&g}return e}function f(a,b,c,d,e,f){for(var g=32767&b,h=b>>15;--f>=0;){var i=32767&this[a],j=this[a++]>>15,k=h*i+j*g;i=g*i+((32767&k)<<15)+c[d]+(1073741823&e),e=(i>>>30)+(k>>>15)+h*j+(e>>>30),c[d++]=1073741823&i}return e}function g(a,b,c,d,e,f){for(var g=16383&b,h=b>>14;--f>=0;){var i=16383&this[a],j=this[a++]>>14,k=h*i+j*g;i=g*i+((16383&k)<<14)+c[d]+e,e=(i>>28)+(k>>14)+h*j,c[d++]=268435455&i}return e}function h(a){return hc.charAt(a)}function i(a,b){var c=ic[a.charCodeAt(b)];return null==c?-1:c}function j(a){for(var b=this.t-1;b>=0;--b)a[b]=this[b];a.t=this.t,a.s=this.s}function k(a){this.t=1,this.s=0>a?-1:0,a>0?this[0]=a:-1>a?this[0]=a+DV:this.t=0}function l(a){var b=d();return b.fromInt(a),b}function m(b,c){var d;if(16==c)d=4;else if(8==c)d=3;else if(256==c)d=8;else if(2==c)d=1;else if(32==c)d=5;else{if(4!=c)return void this.fromRadix(b,c);d=2}this.t=0,this.s=0;for(var e=b.length,f=!1,g=0;--e>=0;){var h=8==d?255&b[e]:i(b,e);0>h?"-"==b.charAt(e)&&(f=!0):(f=!1,0==g?this[this.t++]=h:g+d>this.DB?(this[this.t-1]|=(h&(1<<this.DB-g)-1)<<g,this[this.t++]=h>>this.DB-g):this[this.t-1]|=h<<g,g+=d,g>=this.DB&&(g-=this.DB))}8==d&&0!=(128&b[0])&&(this.s=-1,g>0&&(this[this.t-1]|=(1<<this.DB-g)-1<<g)),this.clamp(),f&&a.ZERO.subTo(this,this)}function n(){for(var a=this.s&this.DM;this.t>0&&this[this.t-1]==a;)--this.t}function o(a){if(this.s<0)return"-"+this.negate().toString(a);var b;if(16==a)b=4;else if(8==a)b=3;else if(2==a)b=1;else if(32==a)b=5;else{if(4!=a)return this.toRadix(a);b=2}var c,d=(1<<b)-1,e=!1,f="",g=this.t,i=this.DB-g*this.DB%b;if(g-->0)for(i<this.DB&&(c=this[g]>>i)>0&&(e=!0,f=h(c));g>=0;)b>i?(c=(this[g]&(1<<i)-1)<<b-i,c|=this[--g]>>(i+=this.DB-b)):(c=this[g]>>(i-=b)&d,0>=i&&(i+=this.DB,--g)),c>0&&(e=!0),e&&(f+=h(c));return e?f:"0"}function p(){var b=d();return a.ZERO.subTo(this,b),b}function q(){return this.s<0?this.negate():this}function r(a){var b=this.s-a.s;if(0!=b)return b;var c=this.t;if(b=c-a.t,0!=b)return this.s<0?-b:b;for(;--c>=0;)if(0!=(b=this[c]-a[c]))return b;return 0}function s(a){var b,c=1;return 0!=(b=a>>>16)&&(a=b,c+=16),0!=(b=a>>8)&&(a=b,c+=8),0!=(b=a>>4)&&(a=b,c+=4),0!=(b=a>>2)&&(a=b,c+=2),0!=(b=a>>1)&&(a=b,c+=1),c}function t(){return this.t<=0?0:this.DB*(this.t-1)+s(this[this.t-1]^this.s&this.DM)}function u(a,b){var c;for(c=this.t-1;c>=0;--c)b[c+a]=this[c];for(c=a-1;c>=0;--c)b[c]=0;b.t=this.t+a,b.s=this.s}function v(a,b){for(var c=a;c<this.t;++c)b[c-a]=this[c];b.t=Math.max(this.t-a,0),b.s=this.s}function w(a,b){var c,d=a%this.DB,e=this.DB-d,f=(1<<e)-1,g=Math.floor(a/this.DB),h=this.s<<d&this.DM;for(c=this.t-1;c>=0;--c)b[c+g+1]=this[c]>>e|h,h=(this[c]&f)<<d;for(c=g-1;c>=0;--c)b[c]=0;b[g]=h,b.t=this.t+g+1,b.s=this.s,b.clamp()}function x(a,b){b.s=this.s;var c=Math.floor(a/this.DB);if(c>=this.t)return void(b.t=0);var d=a%this.DB,e=this.DB-d,f=(1<<d)-1;b[0]=this[c]>>d;for(var g=c+1;g<this.t;++g)b[g-c-1]|=(this[g]&f)<<e,b[g-c]=this[g]>>d;d>0&&(b[this.t-c-1]|=(this.s&f)<<e),b.t=this.t-c,b.clamp()}function y(a,b){for(var c=0,d=0,e=Math.min(a.t,this.t);e>c;)d+=this[c]-a[c],b[c++]=d&this.DM,d>>=this.DB;if(a.t<this.t){for(d-=a.s;c<this.t;)d+=this[c],b[c++]=d&this.DM,d>>=this.DB;d+=this.s}else{for(d+=this.s;c<a.t;)d-=a[c],b[c++]=d&this.DM,d>>=this.DB;d-=a.s}b.s=0>d?-1:0,-1>d?b[c++]=this.DV+d:d>0&&(b[c++]=d),b.t=c,b.clamp()}function z(b,c){var d=this.abs(),e=b.abs(),f=d.t;for(c.t=f+e.t;--f>=0;)c[f]=0;for(f=0;f<e.t;++f)c[f+d.t]=d.am(0,e[f],c,f,0,d.t);c.s=0,c.clamp(),this.s!=b.s&&a.ZERO.subTo(c,c)}function A(a){for(var b=this.abs(),c=a.t=2*b.t;--c>=0;)a[c]=0;for(c=0;c<b.t-1;++c){var d=b.am(c,b[c],a,2*c,0,1);(a[c+b.t]+=b.am(c+1,2*b[c],a,2*c+1,d,b.t-c-1))>=b.DV&&(a[c+b.t]-=b.DV,a[c+b.t+1]=1)}a.t>0&&(a[a.t-1]+=b.am(c,b[c],a,2*c,0,1)),a.s=0,a.clamp()}function B(b,c,e){var f=b.abs();if(!(f.t<=0)){var g=this.abs();if(g.t<f.t)return null!=c&&c.fromInt(0),void(null!=e&&this.copyTo(e));null==e&&(e=d());var h=d(),i=this.s,j=b.s,k=this.DB-s(f[f.t-1]);k>0?(f.lShiftTo(k,h),g.lShiftTo(k,e)):(f.copyTo(h),g.copyTo(e));var l=h.t,m=h[l-1];if(0!=m){var n=m*(1<<this.F1)+(l>1?h[l-2]>>this.F2:0),o=this.FV/n,p=(1<<this.F1)/n,q=1<<this.F2,r=e.t,t=r-l,u=null==c?d():c;for(h.dlShiftTo(t,u),e.compareTo(u)>=0&&(e[e.t++]=1,e.subTo(u,e)),a.ONE.dlShiftTo(l,u),u.subTo(h,h);h.t<l;)h[h.t++]=0;for(;--t>=0;){var v=e[--r]==m?this.DM:Math.floor(e[r]*o+(e[r-1]+q)*p);if((e[r]+=h.am(0,v,e,t,0,l))<v)for(h.dlShiftTo(t,u),e.subTo(u,e);e[r]<--v;)e.subTo(u,e)}null!=c&&(e.drShiftTo(l,c),i!=j&&a.ZERO.subTo(c,c)),e.t=l,e.clamp(),k>0&&e.rShiftTo(k,e),0>i&&a.ZERO.subTo(e,e)}}}function C(b){var c=d();return this.abs().divRemTo(b,null,c),this.s<0&&c.compareTo(a.ZERO)>0&&b.subTo(c,c),c}function D(a){this.m=a}function E(a){return a.s<0||a.compareTo(this.m)>=0?a.mod(this.m):a}function F(a){return a}function G(a){a.divRemTo(this.m,null,a)}function H(a,b,c){a.multiplyTo(b,c),this.reduce(c)}function I(a,b){a.squareTo(b),this.reduce(b)}function J(){if(this.t<1)return 0;var a=this[0];if(0==(1&a))return 0;var b=3&a;return b=b*(2-(15&a)*b)&15,b=b*(2-(255&a)*b)&255,b=b*(2-((65535&a)*b&65535))&65535,b=b*(2-a*b%this.DV)%this.DV,b>0?this.DV-b:-b}function K(a){this.m=a,this.mp=a.invDigit(),this.mpl=32767&this.mp,this.mph=this.mp>>15,this.um=(1<<a.DB-15)-1,this.mt2=2*a.t}function L(b){var c=d();return b.abs().dlShiftTo(this.m.t,c),c.divRemTo(this.m,null,c),b.s<0&&c.compareTo(a.ZERO)>0&&this.m.subTo(c,c),c}function M(a){var b=d();return a.copyTo(b),this.reduce(b),b}function N(a){for(;a.t<=this.mt2;)a[a.t++]=0;for(var b=0;b<this.m.t;++b){var c=32767&a[b],d=c*this.mpl+((c*this.mph+(a[b]>>15)*this.mpl&this.um)<<15)&a.DM;for(c=b+this.m.t,a[c]+=this.m.am(0,d,a,b,0,this.m.t);a[c]>=a.DV;)a[c]-=a.DV,a[++c]++}a.clamp(),a.drShiftTo(this.m.t,a),a.compareTo(this.m)>=0&&a.subTo(this.m,a)}function O(a,b){a.squareTo(b),this.reduce(b)}function P(a,b,c){a.multiplyTo(b,c),this.reduce(c)}function Q(){return 0==(this.t>0?1&this[0]:this.s)}function R(b,c){if(b>4294967295||1>b)return a.ONE;var e=d(),f=d(),g=c.convert(this),h=s(b)-1;
for(g.copyTo(e);--h>=0;)if(c.sqrTo(e,f),(b&1<<h)>0)c.mulTo(f,g,e);else{var i=e;e=f,f=i}return c.revert(e)}function S(a,b){var c;return c=256>a||b.isEven()?new D(b):new K(b),this.exp(a,c)}function T(){var a=d();return this.copyTo(a),a}function U(){if(this.s<0){if(1==this.t)return this[0]-this.DV;if(0==this.t)return-1}else{if(1==this.t)return this[0];if(0==this.t)return 0}return(this[1]&(1<<32-this.DB)-1)<<this.DB|this[0]}function V(){return 0==this.t?this.s:this[0]<<24>>24}function W(){return 0==this.t?this.s:this[0]<<16>>16}function X(a){return Math.floor(Math.LN2*this.DB/Math.log(a))}function Y(){return this.s<0?-1:this.t<=0||1==this.t&&this[0]<=0?0:1}function Z(a){if(null==a&&(a=10),0==this.signum()||2>a||a>36)return"0";var b=this.chunkSize(a),c=Math.pow(a,b),e=l(c),f=d(),g=d(),h="";for(this.divRemTo(e,f,g);f.signum()>0;)h=(c+g.intValue()).toString(a).substr(1)+h,f.divRemTo(e,f,g);return g.intValue().toString(a)+h}function $(b,c){this.fromInt(0),null==c&&(c=10);for(var d=this.chunkSize(c),e=Math.pow(c,d),f=!1,g=0,h=0,j=0;j<b.length;++j){var k=i(b,j);0>k?"-"==b.charAt(j)&&0==this.signum()&&(f=!0):(h=c*h+k,++g>=d&&(this.dMultiply(e),this.dAddOffset(h,0),g=0,h=0))}g>0&&(this.dMultiply(Math.pow(c,g)),this.dAddOffset(h,0)),f&&a.ZERO.subTo(this,this)}function _(b,c,d){if("number"==typeof c)if(2>b)this.fromInt(1);else for(this.fromNumber(b,d),this.testBit(b-1)||this.bitwiseTo(a.ONE.shiftLeft(b-1),hb,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(c);)this.dAddOffset(2,0),this.bitLength()>b&&this.subTo(a.ONE.shiftLeft(b-1),this);else{var e=new Array,f=7&b;e.length=(b>>3)+1,c.nextBytes(e),f>0?e[0]&=(1<<f)-1:e[0]=0,this.fromString(e,256)}}function ab(){var a=this.t,b=new Array;b[0]=this.s;var c,d=this.DB-a*this.DB%8,e=0;if(a-->0)for(d<this.DB&&(c=this[a]>>d)!=(this.s&this.DM)>>d&&(b[e++]=c|this.s<<this.DB-d);a>=0;)8>d?(c=(this[a]&(1<<d)-1)<<8-d,c|=this[--a]>>(d+=this.DB-8)):(c=this[a]>>(d-=8)&255,0>=d&&(d+=this.DB,--a)),0!=(128&c)&&(c|=-256),0==e&&(128&this.s)!=(128&c)&&++e,(e>0||c!=this.s)&&(b[e++]=c);return b}function bb(a){return 0==this.compareTo(a)}function cb(a){return this.compareTo(a)<0?this:a}function db(a){return this.compareTo(a)>0?this:a}function eb(a,b,c){var d,e,f=Math.min(a.t,this.t);for(d=0;f>d;++d)c[d]=b(this[d],a[d]);if(a.t<this.t){for(e=a.s&this.DM,d=f;d<this.t;++d)c[d]=b(this[d],e);c.t=this.t}else{for(e=this.s&this.DM,d=f;d<a.t;++d)c[d]=b(e,a[d]);c.t=a.t}c.s=b(this.s,a.s),c.clamp()}function fb(a,b){return a&b}function gb(a){var b=d();return this.bitwiseTo(a,fb,b),b}function hb(a,b){return a|b}function ib(a){var b=d();return this.bitwiseTo(a,hb,b),b}function jb(a,b){return a^b}function kb(a){var b=d();return this.bitwiseTo(a,jb,b),b}function lb(a,b){return a&~b}function mb(a){var b=d();return this.bitwiseTo(a,lb,b),b}function nb(){for(var a=d(),b=0;b<this.t;++b)a[b]=this.DM&~this[b];return a.t=this.t,a.s=~this.s,a}function ob(a){var b=d();return 0>a?this.rShiftTo(-a,b):this.lShiftTo(a,b),b}function pb(a){var b=d();return 0>a?this.lShiftTo(-a,b):this.rShiftTo(a,b),b}function qb(a){if(0==a)return-1;var b=0;return 0==(65535&a)&&(a>>=16,b+=16),0==(255&a)&&(a>>=8,b+=8),0==(15&a)&&(a>>=4,b+=4),0==(3&a)&&(a>>=2,b+=2),0==(1&a)&&++b,b}function rb(){for(var a=0;a<this.t;++a)if(0!=this[a])return a*this.DB+qb(this[a]);return this.s<0?this.t*this.DB:-1}function sb(a){for(var b=0;0!=a;)a&=a-1,++b;return b}function tb(){for(var a=0,b=this.s&this.DM,c=0;c<this.t;++c)a+=sb(this[c]^b);return a}function ub(a){var b=Math.floor(a/this.DB);return b>=this.t?0!=this.s:0!=(this[b]&1<<a%this.DB)}function vb(b,c){var d=a.ONE.shiftLeft(b);return this.bitwiseTo(d,c,d),d}function wb(a){return this.changeBit(a,hb)}function xb(a){return this.changeBit(a,lb)}function yb(a){return this.changeBit(a,jb)}function zb(a,b){for(var c=0,d=0,e=Math.min(a.t,this.t);e>c;)d+=this[c]+a[c],b[c++]=d&this.DM,d>>=this.DB;if(a.t<this.t){for(d+=a.s;c<this.t;)d+=this[c],b[c++]=d&this.DM,d>>=this.DB;d+=this.s}else{for(d+=this.s;c<a.t;)d+=a[c],b[c++]=d&this.DM,d>>=this.DB;d+=a.s}b.s=0>d?-1:0,d>0?b[c++]=d:-1>d&&(b[c++]=this.DV+d),b.t=c,b.clamp()}function Ab(a){var b=d();return this.addTo(a,b),b}function Bb(a){var b=d();return this.subTo(a,b),b}function Cb(a){var b=d();return this.multiplyTo(a,b),b}function Db(){var a=d();return this.squareTo(a),a}function Eb(a){var b=d();return this.divRemTo(a,b,null),b}function Fb(a){var b=d();return this.divRemTo(a,null,b),b}function Gb(a){var b=d(),c=d();return this.divRemTo(a,b,c),new Array(b,c)}function Hb(a){this[this.t]=this.am(0,a-1,this,0,0,this.t),++this.t,this.clamp()}function Ib(a,b){if(0!=a){for(;this.t<=b;)this[this.t++]=0;for(this[b]+=a;this[b]>=this.DV;)this[b]-=this.DV,++b>=this.t&&(this[this.t++]=0),++this[b]}}function Jb(){}function Kb(a){return a}function Lb(a,b,c){a.multiplyTo(b,c)}function Mb(a,b){a.squareTo(b)}function Nb(a){return this.exp(a,new Jb)}function Ob(a,b,c){var d=Math.min(this.t+a.t,b);for(c.s=0,c.t=d;d>0;)c[--d]=0;var e;for(e=c.t-this.t;e>d;++d)c[d+this.t]=this.am(0,a[d],c,d,0,this.t);for(e=Math.min(a.t,b);e>d;++d)this.am(0,a[d],c,d,0,b-d);c.clamp()}function Pb(a,b,c){--b;var d=c.t=this.t+a.t-b;for(c.s=0;--d>=0;)c[d]=0;for(d=Math.max(b-this.t,0);d<a.t;++d)c[this.t+d-b]=this.am(b-d,a[d],c,0,0,this.t+d-b);c.clamp(),c.drShiftTo(1,c)}function Qb(b){this.r2=d(),this.q3=d(),a.ONE.dlShiftTo(2*b.t,this.r2),this.mu=this.r2.divide(b),this.m=b}function Rb(a){if(a.s<0||a.t>2*this.m.t)return a.mod(this.m);if(a.compareTo(this.m)<0)return a;var b=d();return a.copyTo(b),this.reduce(b),b}function Sb(a){return a}function Tb(a){for(a.drShiftTo(this.m.t-1,this.r2),a.t>this.m.t+1&&(a.t=this.m.t+1,a.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);a.compareTo(this.r2)<0;)a.dAddOffset(1,this.m.t+1);for(a.subTo(this.r2,a);a.compareTo(this.m)>=0;)a.subTo(this.m,a)}function Ub(a,b){a.squareTo(b),this.reduce(b)}function Vb(a,b,c){a.multiplyTo(b,c),this.reduce(c)}function Wb(a,b){var c,e,f=a.bitLength(),g=l(1);if(0>=f)return g;c=18>f?1:48>f?3:144>f?4:768>f?5:6,e=8>f?new D(b):b.isEven()?new Qb(b):new K(b);var h=new Array,i=3,j=c-1,k=(1<<c)-1;if(h[1]=e.convert(this),c>1){var m=d();for(e.sqrTo(h[1],m);k>=i;)h[i]=d(),e.mulTo(m,h[i-2],h[i]),i+=2}var n,o,p=a.t-1,q=!0,r=d();for(f=s(a[p])-1;p>=0;){for(f>=j?n=a[p]>>f-j&k:(n=(a[p]&(1<<f+1)-1)<<j-f,p>0&&(n|=a[p-1]>>this.DB+f-j)),i=c;0==(1&n);)n>>=1,--i;if((f-=i)<0&&(f+=this.DB,--p),q)h[n].copyTo(g),q=!1;else{for(;i>1;)e.sqrTo(g,r),e.sqrTo(r,g),i-=2;i>0?e.sqrTo(g,r):(o=g,g=r,r=o),e.mulTo(r,h[n],g)}for(;p>=0&&0==(a[p]&1<<f);)e.sqrTo(g,r),o=g,g=r,r=o,--f<0&&(f=this.DB-1,--p)}return e.revert(g)}function Xb(a){var b=this.s<0?this.negate():this.clone(),c=a.s<0?a.negate():a.clone();if(b.compareTo(c)<0){var d=b;b=c,c=d}var e=b.getLowestSetBit(),f=c.getLowestSetBit();if(0>f)return b;for(f>e&&(f=e),f>0&&(b.rShiftTo(f,b),c.rShiftTo(f,c));b.signum()>0;)(e=b.getLowestSetBit())>0&&b.rShiftTo(e,b),(e=c.getLowestSetBit())>0&&c.rShiftTo(e,c),b.compareTo(c)>=0?(b.subTo(c,b),b.rShiftTo(1,b)):(c.subTo(b,c),c.rShiftTo(1,c));return f>0&&c.lShiftTo(f,c),c}function Yb(a){if(0>=a)return 0;var b=this.DV%a,c=this.s<0?a-1:0;if(this.t>0)if(0==b)c=this[0]%a;else for(var d=this.t-1;d>=0;--d)c=(b*c+this[d])%a;return c}function Zb(b){var c=b.isEven();if(this.isEven()&&c||0==b.signum())return a.ZERO;for(var d=b.clone(),e=this.clone(),f=l(1),g=l(0),h=l(0),i=l(1);0!=d.signum();){for(;d.isEven();)d.rShiftTo(1,d),c?(f.isEven()&&g.isEven()||(f.addTo(this,f),g.subTo(b,g)),f.rShiftTo(1,f)):g.isEven()||g.subTo(b,g),g.rShiftTo(1,g);for(;e.isEven();)e.rShiftTo(1,e),c?(h.isEven()&&i.isEven()||(h.addTo(this,h),i.subTo(b,i)),h.rShiftTo(1,h)):i.isEven()||i.subTo(b,i),i.rShiftTo(1,i);d.compareTo(e)>=0?(d.subTo(e,d),c&&f.subTo(h,f),g.subTo(i,g)):(e.subTo(d,e),c&&h.subTo(f,h),i.subTo(g,i))}return 0!=e.compareTo(a.ONE)?a.ZERO:i.compareTo(b)>=0?i.subtract(b):i.signum()<0?(i.addTo(b,i),i.signum()<0?i.add(b):i):i}function $b(a){var b,c=this.abs();if(1==c.t&&c[0]<=jc[jc.length-1]){for(b=0;b<jc.length;++b)if(c[0]==jc[b])return!0;return!1}if(c.isEven())return!1;for(b=1;b<jc.length;){for(var d=jc[b],e=b+1;e<jc.length&&kc>d;)d*=jc[e++];for(d=c.modInt(d);e>b;)if(d%jc[b++]==0)return!1}return c.millerRabin(a)}function _b(b){var c=this.subtract(a.ONE),e=c.getLowestSetBit();if(0>=e)return!1;var f=c.shiftRight(e);b=b+1>>1,b>jc.length&&(b=jc.length);for(var g=d(),h=0;b>h;++h){g.fromInt(jc[Math.floor(Math.random()*jc.length)]);var i=g.modPow(f,this);if(0!=i.compareTo(a.ONE)&&0!=i.compareTo(c)){for(var j=1;j++<e&&0!=i.compareTo(c);)if(i=i.modPowInt(2,this),0==i.compareTo(a.ONE))return!1;if(0!=i.compareTo(c))return!1}}return!0}var ac,bc=0xdeadbeefcafe,cc=15715070==(16777215&bc),dc="undefined"!=typeof navigator;dc&&cc&&"Microsoft Internet Explorer"==navigator.appName?(a.prototype.am=f,ac=30):dc&&cc&&"Netscape"!=navigator.appName?(a.prototype.am=e,ac=26):(a.prototype.am=g,ac=28),a.prototype.DB=ac,a.prototype.DM=(1<<ac)-1,a.prototype.DV=1<<ac;var ec=52;a.prototype.FV=Math.pow(2,ec),a.prototype.F1=ec-ac,a.prototype.F2=2*ac-ec;var fc,gc,hc="0123456789abcdefghijklmnopqrstuvwxyz",ic=new Array;for(fc="0".charCodeAt(0),gc=0;9>=gc;++gc)ic[fc++]=gc;for(fc="a".charCodeAt(0),gc=10;36>gc;++gc)ic[fc++]=gc;for(fc="A".charCodeAt(0),gc=10;36>gc;++gc)ic[fc++]=gc;D.prototype.convert=E,D.prototype.revert=F,D.prototype.reduce=G,D.prototype.mulTo=H,D.prototype.sqrTo=I,K.prototype.convert=L,K.prototype.revert=M,K.prototype.reduce=N,K.prototype.mulTo=P,K.prototype.sqrTo=O,a.prototype.copyTo=j,a.prototype.fromInt=k,a.prototype.fromString=m,a.prototype.clamp=n,a.prototype.dlShiftTo=u,a.prototype.drShiftTo=v,a.prototype.lShiftTo=w,a.prototype.rShiftTo=x,a.prototype.subTo=y,a.prototype.multiplyTo=z,a.prototype.squareTo=A,a.prototype.divRemTo=B,a.prototype.invDigit=J,a.prototype.isEven=Q,a.prototype.exp=R,a.prototype.toString=o,a.prototype.negate=p,a.prototype.abs=q,a.prototype.compareTo=r,a.prototype.bitLength=t,a.prototype.mod=C,a.prototype.modPowInt=S,a.ZERO=l(0),a.ONE=l(1),Jb.prototype.convert=Kb,Jb.prototype.revert=Kb,Jb.prototype.mulTo=Lb,Jb.prototype.sqrTo=Mb,Qb.prototype.convert=Rb,Qb.prototype.revert=Sb,Qb.prototype.reduce=Tb,Qb.prototype.mulTo=Vb,Qb.prototype.sqrTo=Ub;var jc=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509,521,523,541,547,557,563,569,571,577,587,593,599,601,607,613,617,619,631,641,643,647,653,659,661,673,677,683,691,701,709,719,727,733,739,743,751,757,761,769,773,787,797,809,811,821,823,827,829,839,853,857,859,863,877,881,883,887,907,911,919,929,937,941,947,953,967,971,977,983,991,997],kc=(1<<26)/jc[jc.length-1];a.prototype.chunkSize=X,a.prototype.toRadix=Z,a.prototype.fromRadix=$,a.prototype.fromNumber=_,a.prototype.bitwiseTo=eb,a.prototype.changeBit=vb,a.prototype.addTo=zb,a.prototype.dMultiply=Hb,a.prototype.dAddOffset=Ib,a.prototype.multiplyLowerTo=Ob,a.prototype.multiplyUpperTo=Pb,a.prototype.modInt=Yb,a.prototype.millerRabin=_b,a.prototype.clone=T,a.prototype.intValue=U,a.prototype.byteValue=V,a.prototype.shortValue=W,a.prototype.signum=Y,a.prototype.toByteArray=ab,a.prototype.equals=bb,a.prototype.min=cb,a.prototype.max=db,a.prototype.and=gb,a.prototype.or=ib,a.prototype.xor=kb,a.prototype.andNot=mb,a.prototype.not=nb,a.prototype.shiftLeft=ob,a.prototype.shiftRight=pb,a.prototype.getLowestSetBit=rb,a.prototype.bitCount=tb,a.prototype.testBit=ub,a.prototype.setBit=wb,a.prototype.clearBit=xb,a.prototype.flipBit=yb,a.prototype.add=Ab,a.prototype.subtract=Bb,a.prototype.multiply=Cb,a.prototype.divide=Eb,a.prototype.remainder=Fb,a.prototype.divideAndRemainder=Gb,a.prototype.modPow=Wb,a.prototype.modInverse=Zb,a.prototype.pow=Nb,a.prototype.gcd=Xb,a.prototype.isProbablePrime=$b,a.prototype.square=Db,a.prototype.Barrett=Qb,"undefined"!=typeof c?c=b.exports=a:this.BigInteger=a}).call(this)},{}],10:[function(a,b,c){var d=a("./cs2a.js"),e=a("ecc-jsbn");a("./forge.min.js"),d.crypt(e,forge),Object.keys(d).forEach(function(a){c[a]=d[a]})},{"./cs2a.js":11,"./forge.min.js":12,"ecc-jsbn":13}],11:[function(a,b,c){(function(b){var d,e=a("crypto"),f=a("sjcl");c.install=function(a){d=a,a.CSets["2a"]=c};var g;c.crypt=function(a,b){e.ecc=a,g=b},c.genkey=function(a,b,c){var d=g.rsa.createKeyPairGenerationState(2048,65537),e=function(){if(g.rsa.stepKeyPairGenerationState(d,100)){var f=g.asn1.toDer(g.pki.publicKeyToAsn1(d.keys.publicKey)).bytes();a["2a"]=g.util.encode64(f),a["2a_secret"]=g.util.encode64(g.asn1.toDer(g.pki.privateKeyToAsn1(d.keys.privateKey)).bytes()),b()}else c&&c(),setTimeout(e,10)};setTimeout(e)},c.loadkey=function(a,c,d){c.length>300&&(c="-"==c.substr(0,1)?g.asn1.toDer(g.pki.publicKeyToAsn1(g.pki.publicKeyFromPem(key))).bytes():g.util.decode64(c)),a.key=c;var e=g.pki.publicKeyFromAsn1(g.asn1.fromDer(c));if(a.encrypt=function(a){return new b(e.encrypt(a.toString("binary"),"RSA-OAEP"),"binary")},a.verify=function(a,b){return e.verify(a.toString("binary"),b.toString("binary"))},d){var f="-"==d.substr(0,1)?g.pki.privateKeyFromPem(d):g.pki.privateKeyFromAsn1(g.asn1.fromDer(g.util.decode64(d)));a.sign=function(a){var c=g.md.sha256.create();return c.update(a.toString("binary")),new b(f.sign(c),"binary")},a.decrypt=function(a){return new b(f.decrypt(a.toString("binary"),"RSA-OAEP"),"binary")}}return!1},c.openize=function(a,c,g){c.ecc||(c.ecc=new e.ecc.ECKey(e.ecc.ECCurves.secp256r1));var h=c.ecc.PublicKey.slice(1),i=b.isBuffer(g)?g:d.pencode(g,a.cs["2a"].key),j=e.createHash("sha256").update(h).digest("hex"),k=new f.cipher.aes(f.codec.hex.toBits(j)),l=f.codec.hex.toBits("00000000000000000000000000000001"),m=f.mode.gcm.encrypt(k,f.codec.hex.toBits(i.toString("hex")),l,[],128),n=new b(f.codec.hex.fromBits(m),"hex"),o=a.cs["2a"].sign(n);c.lineOut||(c.lineOut="");var j=e.createHash("sha256").update(b.concat([h,new b(c.lineOut,"hex")])).digest("hex"),k=new f.cipher.aes(f.codec.hex.toBits(j)),m=f.mode.gcm.encrypt(k,f.codec.hex.toBits(o.toString("hex")),l,[],32),p=new b(f.codec.hex.fromBits(m),"hex"),q=c.encrypt(h),r=b.concat([q,p,n]),s=d.pencode(42,r);return s},c.deopenize=function(a,g){var h={verify:!1},i=g.body.slice(0,256),j=g.body.slice(256,516),k=g.body.slice(516),l=a.cs["2a"].decrypt(i);if(!l)return h;try{h.linepub=new e.ecc.ECKey(e.ecc.ECCurves.secp256r1,b.concat([new b("04","hex"),l]),!0)}catch(m){}if(!h.linepub)return h;var n=e.createHash("sha256").update(l).digest("hex"),o=new f.cipher.aes(f.codec.hex.toBits(n)),p=f.codec.hex.toBits("00000000000000000000000000000001"),q=f.mode.gcm.decrypt(o,f.codec.hex.toBits(k.toString("hex")),p,[],128),r=new b(f.codec.hex.fromBits(q),"hex"),s=d.pdecode(r);if(!s||!s.body)return h;h.js=s.js,h.inner=s;var t,u={};if(g.from)u=g.from,t="";else{if(h.key=s.body,c.loadkey(u,s.body))return h;t=s.js.line}var n=e.createHash("sha256").update(b.concat([l,new b(t,"hex")])).digest("hex"),o=new f.cipher.aes(f.codec.hex.toBits(n)),q=f.mode.gcm.decrypt(o,f.codec.hex.toBits(j.toString("hex")),p,[],32),v=new b(f.codec.hex.fromBits(q),"hex");return h.verify=u.verify(k,v),h},c.openline=function(a,c){var d=a.ecc.deriveSharedSecret(c.linepub);a.lineInB=new b(a.lineIn,"hex");var g=e.createHash("sha256").update(d).update(new b(a.lineOut,"hex")).update(new b(a.lineIn,"hex")).digest("hex");a.encKey=new f.cipher.aes(f.codec.hex.toBits(g));var g=e.createHash("sha256").update(d).update(new b(a.lineIn,"hex")).update(new b(a.lineOut,"hex")).digest("hex");return a.decKey=new f.cipher.aes(f.codec.hex.toBits(g)),!0},c.lineize=function(a,c){var g=e.randomBytes(16),h=d.pencode(c.js,c.body),i=f.mode.gcm.encrypt(a.encKey,f.codec.hex.toBits(h.toString("hex")),f.codec.hex.toBits(g.toString("hex")),[],128),j=new b(f.codec.hex.fromBits(i),"hex"),k=b.concat([a.lineInB,g,j]);return d.pencode(null,k)},c.delineize=function(a,c){if(!c.body)return"missing body";c.body=c.body.slice(16);var e=f.codec.hex.toBits(c.body.slice(0,16).toString("hex"));try{var g=f.mode.gcm.decrypt(a.decKey,f.codec.hex.toBits(c.body.slice(16).toString("hex")),e,[],128)}catch(h){return h}if(!g)return"no cipher output";var i=d.pdecode(new b(f.codec.hex.fromBits(g),"hex"));return i?(c.js=i.js,c.body=i.body,!1):"invalid decrypted packet"}}).call(this,a("buffer").Buffer)},{buffer:29,crypto:35,sjcl:17}],12:[function(a,b){b.exports=a(5)},{sycGbZ:51}],13:[function(a,b){b.exports=a(6)},{"./lib/ec.js":14,"./lib/sec.js":15,buffer:29,crypto:35,jsbn:16}],14:[function(a,b){b.exports=a(7)},{jsbn:16}],15:[function(a,b){b.exports=a(8)},{"./ec.js":14,jsbn:16}],16:[function(a,b){b.exports=a(9)},{}],17:[function(a,b){"use strict";function c(a){throw a}function d(a,b,d){4!==b.length&&c(new m.exception.invalid("invalid aes block size"));var e=a.b[d],f=b[0]^e[0],g=b[d?3:1]^e[1],h=b[2]^e[2];b=b[d?1:3]^e[3];var i,j,k,l,n=e.length/4-2,o=4,p=[0,0,0,0];i=a.k[d],a=i[0];var q=i[1],r=i[2],s=i[3],t=i[4];for(l=0;n>l;l++)i=a[f>>>24]^q[g>>16&255]^r[h>>8&255]^s[255&b]^e[o],j=a[g>>>24]^q[h>>16&255]^r[b>>8&255]^s[255&f]^e[o+1],k=a[h>>>24]^q[b>>16&255]^r[f>>8&255]^s[255&g]^e[o+2],b=a[b>>>24]^q[f>>16&255]^r[g>>8&255]^s[255&h]^e[o+3],o+=4,f=i,g=j,h=k;for(l=0;4>l;l++)p[d?3&-l:l]=t[f>>>24]<<24^t[g>>16&255]<<16^t[h>>8&255]<<8^t[255&b]^e[o++],i=f,f=g,g=h,h=b,b=i;return p}function e(a,b){var c,d,e,f=b.slice(0),g=a.r,h=a.b,i=g[0],j=g[1],k=g[2],l=g[3],m=g[4],n=g[5],o=g[6],p=g[7];for(c=0;64>c;c++)16>c?d=f[c]:(d=f[c+1&15],e=f[c+14&15],d=f[15&c]=(d>>>7^d>>>18^d>>>3^d<<25^d<<14)+(e>>>17^e>>>19^e>>>10^e<<15^e<<13)+f[15&c]+f[c+9&15]|0),d=d+p+(m>>>6^m>>>11^m>>>25^m<<26^m<<21^m<<7)+(o^m&(n^o))+h[c],p=o,o=n,n=m,m=l+d|0,l=k,k=j,j=i,i=d+(j&k^l&(j^k))+(j>>>2^j>>>13^j>>>22^j<<30^j<<19^j<<10)|0;g[0]=g[0]+i|0,g[1]=g[1]+j|0,g[2]=g[2]+k|0,g[3]=g[3]+l|0,g[4]=g[4]+m|0,g[5]=g[5]+n|0,g[6]=g[6]+o|0,g[7]=g[7]+p|0}function f(a,b){var c,d=m.random.w[a],e=[];for(c in d)d.hasOwnProperty(c)&&e.push(d[c]);for(c=0;c<e.length;c++)e[c](b)}function g(a){window&&window.performance&&"function"==typeof window.performance.now?m.random.addEntropy(window.performance.now(),a,"loadtime"):m.random.addEntropy((new Date).valueOf(),a,"loadtime")}function h(a){a.b=i(a).concat(i(a)),a.A=new m.cipher.aes(a.b)}function i(a){for(var b=0;4>b&&(a.f[b]=a.f[b]+1|0,!a.f[b]);b++);return a.A.encrypt(a.f)}function j(a,b){return function(){b.apply(a,arguments)}}var k=void 0,l=!1,m={cipher:{},hash:{},keyexchange:{},mode:{},misc:{},codec:{},exception:{corrupt:function(a){this.toString=function(){return"CORRUPT: "+this.message},this.message=a},invalid:function(a){this.toString=function(){return"INVALID: "+this.message},this.message=a},bug:function(a){this.toString=function(){return"BUG: "+this.message},this.message=a},notReady:function(a){this.toString=function(){return"NOT READY: "+this.message},this.message=a}}};"undefined"!=typeof b&&b.exports&&(b.exports=m),m.cipher.aes=function(a){this.k[0][0][0]||this.D();var b,d,e,f,g=this.k[0][4],h=this.k[1];b=a.length;var i=1;for(4!==b&&6!==b&&8!==b&&c(new m.exception.invalid("invalid aes key size")),this.b=[e=a.slice(0),f=[]],a=b;4*b+28>a;a++)d=e[a-1],(0===a%b||8===b&&4===a%b)&&(d=g[d>>>24]<<24^g[d>>16&255]<<16^g[d>>8&255]<<8^g[255&d],0===a%b&&(d=d<<8^d>>>24^i<<24,i=i<<1^283*(i>>7))),e[a]=e[a-b]^d;for(b=0;a;b++,a--)d=e[3&b?a:a-4],f[b]=4>=a||4>b?d:h[0][g[d>>>24]]^h[1][g[d>>16&255]]^h[2][g[d>>8&255]]^h[3][g[255&d]]},m.cipher.aes.prototype={encrypt:function(a){return d(this,a,0)},decrypt:function(a){return d(this,a,1)},k:[[[],[],[],[],[]],[[],[],[],[],[]]],D:function(){var a,b,c,d,e,f,g,h=this.k[0],i=this.k[1],j=h[4],k=i[4],l=[],m=[];for(a=0;256>a;a++)m[(l[a]=a<<1^283*(a>>7))^a]=a;for(b=c=0;!j[b];b^=d||1,c=m[c]||1)for(f=c^c<<1^c<<2^c<<3^c<<4,f=f>>8^255&f^99,j[b]=f,k[f]=b,e=l[a=l[d=l[b]]],g=16843009*e^65537*a^257*d^16843008*b,e=257*l[f]^16843008*f,a=0;4>a;a++)h[a][b]=e=e<<24^e>>>8,i[a][f]=g=g<<24^g>>>8;for(a=0;5>a;a++)h[a]=h[a].slice(0),i[a]=i[a].slice(0)}},m.bitArray={bitSlice:function(a,b,c){return a=m.bitArray.P(a.slice(b/32),32-(31&b)).slice(1),c===k?a:m.bitArray.clamp(a,c-b)},extract:function(a,b,c){var d=Math.floor(-b-c&31);return(-32&(b+c-1^b)?a[b/32|0]<<32-d^a[b/32+1|0]>>>d:a[b/32|0]>>>d)&(1<<c)-1},concat:function(a,b){if(0===a.length||0===b.length)return a.concat(b);var c=a[a.length-1],d=m.bitArray.getPartial(c);return 32===d?a.concat(b):m.bitArray.P(b,d,0|c,a.slice(0,a.length-1))},bitLength:function(a){var b=a.length;return 0===b?0:32*(b-1)+m.bitArray.getPartial(a[b-1])},clamp:function(a,b){if(32*a.length<b)return a;a=a.slice(0,Math.ceil(b/32));var c=a.length;return b&=31,c>0&&b&&(a[c-1]=m.bitArray.partial(b,a[c-1]&2147483648>>b-1,1)),a},partial:function(a,b,c){return 32===a?b:(c?0|b:b<<32-a)+1099511627776*a},getPartial:function(a){return Math.round(a/1099511627776)||32},equal:function(a,b){if(m.bitArray.bitLength(a)!==m.bitArray.bitLength(b))return l;var c,d=0;for(c=0;c<a.length;c++)d|=a[c]^b[c];return 0===d},P:function(a,b,c,d){var e;for(e=0,d===k&&(d=[]);b>=32;b-=32)d.push(c),c=0;if(0===b)return d.concat(a);for(e=0;e<a.length;e++)d.push(c|a[e]>>>b),c=a[e]<<32-b;return e=a.length?a[a.length-1]:0,a=m.bitArray.getPartial(e),d.push(m.bitArray.partial(b+a&31,b+a>32?c:d.pop(),1)),d},l:function(a,b){return[a[0]^b[0],a[1]^b[1],a[2]^b[2],a[3]^b[3]]}},m.codec.utf8String={fromBits:function(a){var b,c,d="",e=m.bitArray.bitLength(a);for(b=0;e/8>b;b++)0===(3&b)&&(c=a[b/4]),d+=String.fromCharCode(c>>>24),c<<=8;return decodeURIComponent(escape(d))},toBits:function(a){a=unescape(encodeURIComponent(a));var b,c=[],d=0;for(b=0;b<a.length;b++)d=d<<8|a.charCodeAt(b),3===(3&b)&&(c.push(d),d=0);return 3&b&&c.push(m.bitArray.partial(8*(3&b),d)),c}},m.codec.hex={fromBits:function(a){var b,c="";for(b=0;b<a.length;b++)c+=((0|a[b])+0xf00000000000).toString(16).substr(4);return c.substr(0,m.bitArray.bitLength(a)/4)},toBits:function(a){var b,c,d=[];for(a=a.replace(/\s|0x/g,""),c=a.length,a+="00000000",b=0;b<a.length;b+=8)d.push(0^parseInt(a.substr(b,8),16));return m.bitArray.clamp(d,4*c)}},m.codec.base64={J:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",fromBits:function(a,b,c){var d="",e=0,f=m.codec.base64.J,g=0,h=m.bitArray.bitLength(a);for(c&&(f=f.substr(0,62)+"-_"),c=0;6*d.length<h;)d+=f.charAt((g^a[c]>>>e)>>>26),6>e?(g=a[c]<<6-e,e+=26,c++):(g<<=6,e-=6);for(;3&d.length&&!b;)d+="=";return d},toBits:function(a,b){a=a.replace(/\s|=/g,"");var d,e,f=[],g=0,h=m.codec.base64.J,i=0;for(b&&(h=h.substr(0,62)+"-_"),d=0;d<a.length;d++)e=h.indexOf(a.charAt(d)),0>e&&c(new m.exception.invalid("this isn't base64!")),g>26?(g-=26,f.push(i^e>>>g),i=e<<32-g):(g+=6,i^=e<<32-g);return 56&g&&f.push(m.bitArray.partial(56&g,i,1)),f}},m.codec.base64url={fromBits:function(a){return m.codec.base64.fromBits(a,1,1)},toBits:function(a){return m.codec.base64.toBits(a,1)}},m.hash.sha256=function(a){this.b[0]||this.D(),a?(this.r=a.r.slice(0),this.o=a.o.slice(0),this.h=a.h):this.reset()},m.hash.sha256.hash=function(a){return(new m.hash.sha256).update(a).finalize()},m.hash.sha256.prototype={blockSize:512,reset:function(){return this.r=this.N.slice(0),this.o=[],this.h=0,this},update:function(a){"string"==typeof a&&(a=m.codec.utf8String.toBits(a));var b,c=this.o=m.bitArray.concat(this.o,a);for(b=this.h,a=this.h=b+m.bitArray.bitLength(a),b=512+b&-512;a>=b;b+=512)e(this,c.splice(0,16));return this},finalize:function(){var a,b=this.o,c=this.r,b=m.bitArray.concat(b,[m.bitArray.partial(1,1)]);for(a=b.length+2;15&a;a++)b.push(0);for(b.push(Math.floor(this.h/4294967296)),b.push(0|this.h);b.length;)e(this,b.splice(0,16));return this.reset(),c},N:[],b:[],D:function(){function a(a){return 4294967296*(a-Math.floor(a))|0}var b,c=0,d=2;a:for(;64>c;d++){for(b=2;d>=b*b;b++)if(0===d%b)continue a;8>c&&(this.N[c]=a(Math.pow(d,.5))),this.b[c]=a(Math.pow(d,1/3)),c++}}},m.mode.ccm={name:"ccm",encrypt:function(a,b,d,e,f){var g,h=b.slice(0),i=m.bitArray,j=i.bitLength(d)/8,k=i.bitLength(h)/8;for(f=f||64,e=e||[],7>j&&c(new m.exception.invalid("ccm: iv must be at least 7 bytes")),g=2;4>g&&k>>>8*g;g++);return 15-j>g&&(g=15-j),d=i.clamp(d,8*(15-g)),b=m.mode.ccm.L(a,b,d,e,f,g),h=m.mode.ccm.p(a,h,d,b,f,g),i.concat(h.data,h.tag)},decrypt:function(a,b,d,e,f){f=f||64,e=e||[];var g=m.bitArray,h=g.bitLength(d)/8,i=g.bitLength(b),j=g.clamp(b,i-f),k=g.bitSlice(b,i-f),i=(i-f)/8;for(7>h&&c(new m.exception.invalid("ccm: iv must be at least 7 bytes")),b=2;4>b&&i>>>8*b;b++);return 15-h>b&&(b=15-h),d=g.clamp(d,8*(15-b)),j=m.mode.ccm.p(a,j,d,k,f,b),a=m.mode.ccm.L(a,j.data,d,e,f,b),g.equal(j.tag,a)||c(new m.exception.corrupt("ccm: tag doesn't match")),j.data},L:function(a,b,d,e,f,g){var h=[],i=m.bitArray,j=i.l;if(f/=8,(f%2||4>f||f>16)&&c(new m.exception.invalid("ccm: invalid tag length")),(4294967295<e.length||4294967295<b.length)&&c(new m.exception.bug("ccm: can't deal with 4GiB or more data")),g=[i.partial(8,(e.length?64:0)|f-2<<2|g-1)],g=i.concat(g,d),g[3]|=i.bitLength(b)/8,g=a.encrypt(g),e.length)for(d=i.bitLength(e)/8,65279>=d?h=[i.partial(16,d)]:4294967295>=d&&(h=i.concat([i.partial(16,65534)],[d])),h=i.concat(h,e),e=0;e<h.length;e+=4)g=a.encrypt(j(g,h.slice(e,e+4).concat([0,0,0])));for(e=0;e<b.length;e+=4)g=a.encrypt(j(g,b.slice(e,e+4).concat([0,0,0])));return i.clamp(g,8*f)},p:function(a,b,c,d,e,f){var g,h=m.bitArray;g=h.l;var i=b.length,j=h.bitLength(b);if(c=h.concat([h.partial(8,f-1)],c).concat([0,0,0]).slice(0,4),d=h.bitSlice(g(d,a.encrypt(c)),0,e),!i)return{tag:d,data:[]};for(g=0;i>g;g+=4)c[3]++,e=a.encrypt(c),b[g]^=e[0],b[g+1]^=e[1],b[g+2]^=e[2],b[g+3]^=e[3];return{tag:d,data:h.clamp(b,j)}}},m.mode.ocb2={name:"ocb2",encrypt:function(a,b,d,e,f,g){128!==m.bitArray.bitLength(d)&&c(new m.exception.invalid("ocb iv must be 128 bits"));var h,i=m.mode.ocb2.H,j=m.bitArray,k=j.l,l=[0,0,0,0];d=i(a.encrypt(d));var n,o=[];for(e=e||[],f=f||64,h=0;h+4<b.length;h+=4)n=b.slice(h,h+4),l=k(l,n),o=o.concat(k(d,a.encrypt(k(d,n)))),d=i(d);return n=b.slice(h),b=j.bitLength(n),h=a.encrypt(k(d,[0,0,0,b])),n=j.clamp(k(n.concat([0,0,0]),h),b),l=k(l,k(n.concat([0,0,0]),h)),l=a.encrypt(k(l,k(d,i(d)))),e.length&&(l=k(l,g?e:m.mode.ocb2.pmac(a,e))),o.concat(j.concat(n,j.clamp(l,f)))},decrypt:function(a,b,d,e,f,g){128!==m.bitArray.bitLength(d)&&c(new m.exception.invalid("ocb iv must be 128 bits")),f=f||64;var h,i,j=m.mode.ocb2.H,k=m.bitArray,l=k.l,n=[0,0,0,0],o=j(a.encrypt(d)),p=m.bitArray.bitLength(b)-f,q=[];for(e=e||[],d=0;p/32>d+4;d+=4)h=l(o,a.decrypt(l(o,b.slice(d,d+4)))),n=l(n,h),q=q.concat(h),o=j(o);return i=p-32*d,h=a.encrypt(l(o,[0,0,0,i])),h=l(h,k.clamp(b.slice(d),i).concat([0,0,0])),n=l(n,h),n=a.encrypt(l(n,l(o,j(o)))),e.length&&(n=l(n,g?e:m.mode.ocb2.pmac(a,e))),k.equal(k.clamp(n,f),k.bitSlice(b,p))||c(new m.exception.corrupt("ocb: tag doesn't match")),q.concat(k.clamp(h,i))},pmac:function(a,b){var c,d=m.mode.ocb2.H,e=m.bitArray,f=e.l,g=[0,0,0,0],h=a.encrypt([0,0,0,0]),h=f(h,d(d(h)));for(c=0;c+4<b.length;c+=4)h=d(h),g=f(g,a.encrypt(f(h,b.slice(c,c+4))));return c=b.slice(c),128>e.bitLength(c)&&(h=f(h,d(h)),c=e.concat(c,[-2147483648,0,0,0])),g=f(g,c),a.encrypt(f(d(f(h,d(h))),g))},H:function(a){return[a[0]<<1^a[1]>>>31,a[1]<<1^a[2]>>>31,a[2]<<1^a[3]>>>31,a[3]<<1^135*(a[0]>>>31)]}},m.mode.gcm={name:"gcm",encrypt:function(a,b,c,d,e){var f=b.slice(0);return b=m.bitArray,d=d||[],a=m.mode.gcm.p(!0,a,f,d,c,e||128),b.concat(a.data,a.tag)},decrypt:function(a,b,d,e,f){var g=b.slice(0),h=m.bitArray,i=h.bitLength(g);return f=f||128,e=e||[],i>=f?(b=h.bitSlice(g,i-f),g=h.bitSlice(g,0,i-f)):(b=g,g=[]),a=m.mode.gcm.p(l,a,g,e,d,f),h.equal(a.tag,b)||c(new m.exception.corrupt("gcm: tag doesn't match")),a.data},Z:function(a,b){var c,d,e,f,g,h=m.bitArray.l;for(e=[0,0,0,0],f=b.slice(0),c=0;128>c;c++){for((d=0!==(a[Math.floor(c/32)]&1<<31-c%32))&&(e=h(e,f)),g=0!==(1&f[3]),d=3;d>0;d--)f[d]=f[d]>>>1|(1&f[d-1])<<31;f[0]>>>=1,g&&(f[0]^=-520093696)}return e},g:function(a,b,c){var d,e=c.length;for(b=b.slice(0),d=0;e>d;d+=4)b[0]^=4294967295&c[d],b[1]^=4294967295&c[d+1],b[2]^=4294967295&c[d+2],b[3]^=4294967295&c[d+3],b=m.mode.gcm.Z(b,a);return b},p:function(a,b,c,d,e,f){var g,h,i,j,k,l,n,o,p=m.bitArray;for(l=c.length,n=p.bitLength(c),o=p.bitLength(d),h=p.bitLength(e),g=b.encrypt([0,0,0,0]),96===h?(e=e.slice(0),e=p.concat(e,[1])):(e=m.mode.gcm.g(g,[0,0,0,0],e),e=m.mode.gcm.g(g,e,[0,0,Math.floor(h/4294967296),4294967295&h])),h=m.mode.gcm.g(g,[0,0,0,0],d),k=e.slice(0),d=h.slice(0),a||(d=m.mode.gcm.g(g,h,c)),j=0;l>j;j+=4)k[3]++,i=b.encrypt(k),c[j]^=i[0],c[j+1]^=i[1],c[j+2]^=i[2],c[j+3]^=i[3];return c=p.clamp(c,n),a&&(d=m.mode.gcm.g(g,h,c)),a=[Math.floor(o/4294967296),4294967295&o,Math.floor(n/4294967296),4294967295&n],d=m.mode.gcm.g(g,d,a),i=b.encrypt(e),d[0]^=i[0],d[1]^=i[1],d[2]^=i[2],d[3]^=i[3],{tag:p.bitSlice(d,0,f),data:c}}},m.misc.hmac=function(a,b){this.M=b=b||m.hash.sha256;var c,d=[[],[]],e=b.prototype.blockSize/32;for(this.n=[new b,new b],a.length>e&&(a=b.hash(a)),c=0;e>c;c++)d[0][c]=909522486^a[c],d[1][c]=1549556828^a[c];this.n[0].update(d[0]),this.n[1].update(d[1]),this.G=new b(this.n[0])},m.misc.hmac.prototype.encrypt=m.misc.hmac.prototype.mac=function(a){return this.Q&&c(new m.exception.invalid("encrypt on already updated hmac called!")),this.update(a),this.digest(a)},m.misc.hmac.prototype.reset=function(){this.G=new this.M(this.n[0]),this.Q=l},m.misc.hmac.prototype.update=function(a){this.Q=!0,this.G.update(a)},m.misc.hmac.prototype.digest=function(){var a=this.G.finalize(),a=new this.M(this.n[1]).update(a).finalize();return this.reset(),a},m.misc.pbkdf2=function(a,b,d,e,f){d=d||1e3,(0>e||0>d)&&c(m.exception.invalid("invalid params to pbkdf2")),"string"==typeof a&&(a=m.codec.utf8String.toBits(a)),"string"==typeof b&&(b=m.codec.utf8String.toBits(b)),f=f||m.misc.hmac,a=new f(a);var g,h,i,j,k=[],l=m.bitArray;for(j=1;32*k.length<(e||1);j++){for(f=g=a.encrypt(l.concat(b,[j])),h=1;d>h;h++)for(g=a.encrypt(g),i=0;i<g.length;i++)f[i]^=g[i];k=k.concat(f)}return e&&(k=l.clamp(k,e)),k},m.prng=function(a){this.c=[new m.hash.sha256],this.i=[0],this.F=0,this.s={},this.C=0,this.K={},this.O=this.d=this.j=this.W=0,this.b=[0,0,0,0,0,0,0,0],this.f=[0,0,0,0],this.A=k,this.B=a,this.q=l,this.w={progress:{},seeded:{}},this.m=this.V=0,this.t=1,this.u=2,this.S=65536,this.I=[0,48,64,96,128,192,256,384,512,768,1024],this.T=3e4,this.R=80},m.prng.prototype={randomWords:function(a,b){var d,e=[];d=this.isReady(b);var f;if(d===this.m&&c(new m.exception.notReady("generator isn't seeded")),d&this.u){d=!(d&this.t),f=[];var g,j=0;for(this.O=f[0]=(new Date).valueOf()+this.T,g=0;16>g;g++)f.push(4294967296*Math.random()|0);for(g=0;g<this.c.length&&(f=f.concat(this.c[g].finalize()),j+=this.i[g],this.i[g]=0,!(!d&&this.F&1<<g));g++);for(this.F>=1<<this.c.length&&(this.c.push(new m.hash.sha256),this.i.push(0)),this.d-=j,j>this.j&&(this.j=j),this.F++,this.b=m.hash.sha256.hash(this.b.concat(f)),this.A=new m.cipher.aes(this.b),d=0;4>d&&(this.f[d]=this.f[d]+1|0,!this.f[d]);d++);}for(d=0;a>d;d+=4)0===(d+1)%this.S&&h(this),f=i(this),e.push(f[0],f[1],f[2],f[3]);return h(this),e.slice(0,a)},setDefaultParanoia:function(a,b){0===a&&"Setting paranoia=0 will ruin your security; use it only for testing"!==b&&c("Setting paranoia=0 will ruin your security; use it only for testing"),this.B=a},addEntropy:function(a,b,d){d=d||"user";var e,g,h=(new Date).valueOf(),i=this.s[d],j=this.isReady(),l=0;switch(e=this.K[d],e===k&&(e=this.K[d]=this.W++),i===k&&(i=this.s[d]=0),this.s[d]=(this.s[d]+1)%this.c.length,typeof a){case"number":b===k&&(b=1),this.c[i].update([e,this.C++,1,b,h,1,0|a]);break;case"object":if(d=Object.prototype.toString.call(a),"[object Uint32Array]"===d){for(g=[],d=0;d<a.length;d++)g.push(a[d]);a=g}else for("[object Array]"!==d&&(l=1),d=0;d<a.length&&!l;d++)"number"!=typeof a[d]&&(l=1);if(!l){if(b===k)for(d=b=0;d<a.length;d++)for(g=a[d];g>0;)b++,g>>>=1;this.c[i].update([e,this.C++,2,b,h,a.length].concat(a))}break;case"string":b===k&&(b=a.length),this.c[i].update([e,this.C++,3,b,h,a.length]),this.c[i].update(a);break;default:l=1}l&&c(new m.exception.bug("random: addEntropy only supports number, array of numbers or string")),this.i[i]+=b,this.d+=b,j===this.m&&(this.isReady()!==this.m&&f("seeded",Math.max(this.j,this.d)),f("progress",this.getProgress()))
},isReady:function(a){return a=this.I[a!==k?a:this.B],this.j&&this.j>=a?this.i[0]>this.R&&(new Date).valueOf()>this.O?this.u|this.t:this.t:this.d>=a?this.u|this.m:this.m},getProgress:function(a){return a=this.I[a?a:this.B],this.j>=a?1:this.d>a?1:this.d/a},startCollectors:function(){this.q||(this.a={loadTimeCollector:j(this,this.aa),mouseCollector:j(this,this.ba),keyboardCollector:j(this,this.$),accelerometerCollector:j(this,this.U)},window.addEventListener?(window.addEventListener("load",this.a.loadTimeCollector,l),window.addEventListener("mousemove",this.a.mouseCollector,l),window.addEventListener("keypress",this.a.keyboardCollector,l),window.addEventListener("devicemotion",this.a.accelerometerCollector,l)):document.attachEvent?(document.attachEvent("onload",this.a.loadTimeCollector),document.attachEvent("onmousemove",this.a.mouseCollector),document.attachEvent("keypress",this.a.keyboardCollector)):c(new m.exception.bug("can't attach event")),this.q=!0)},stopCollectors:function(){this.q&&(window.removeEventListener?(window.removeEventListener("load",this.a.loadTimeCollector,l),window.removeEventListener("mousemove",this.a.mouseCollector,l),window.removeEventListener("keypress",this.a.keyboardCollector,l),window.removeEventListener("devicemotion",this.a.accelerometerCollector,l)):document.detachEvent&&(document.detachEvent("onload",this.a.loadTimeCollector),document.detachEvent("onmousemove",this.a.mouseCollector),document.detachEvent("keypress",this.a.keyboardCollector)),this.q=l)},addEventListener:function(a,b){this.w[a][this.V++]=b},removeEventListener:function(a,b){var c,d,e=this.w[a],f=[];for(d in e)e.hasOwnProperty(d)&&e[d]===b&&f.push(d);for(c=0;c<f.length;c++)d=f[c],delete e[d]},$:function(){g(1)},ba:function(a){m.random.addEntropy([a.x||a.clientX||a.offsetX||0,a.y||a.clientY||a.offsetY||0],2,"mouse"),g(0)},aa:function(){g(2)},U:function(a){if(a=a.accelerationIncludingGravity.x||a.accelerationIncludingGravity.y||a.accelerationIncludingGravity.z,window.orientation){var b=window.orientation;"number"==typeof b&&m.random.addEntropy(b,1,"accelerometer")}a&&m.random.addEntropy(a,2,"accelerometer"),g(0)}},m.random=new m.prng(6);a:try{var n,o,p,q;if(q="undefined"!=typeof b){var r;if(r=b.exports){var s;try{s=a("crypto")}catch(t){s=null}r=(o=s)&&o.randomBytes}q=r}if(q)n=o.randomBytes(128),n=new Uint32Array(new Uint8Array(n).buffer),m.random.addEntropy(n,1024,"crypto['randomBytes']");else if(window&&Uint32Array){if(p=new Uint32Array(32),window.crypto&&window.crypto.getRandomValues)window.crypto.getRandomValues(p);else{if(!window.msCrypto||!window.msCrypto.getRandomValues)break a;window.msCrypto.getRandomValues(p)}m.random.addEntropy(p,1024,"crypto['getRandomValues']")}}catch(u){"undefined"!=typeof window&&window.console&&(console.log("There was an error collecting entropy from the browser:"),console.log(u))}m.json={defaults:{v:1,iter:1e3,ks:128,ts:64,mode:"ccm",adata:"",cipher:"aes"},Y:function(a,b,d,e){d=d||{},e=e||{};var f,g=m.json,h=g.e({iv:m.random.randomWords(4,0)},g.defaults);return g.e(h,d),d=h.adata,"string"==typeof h.salt&&(h.salt=m.codec.base64.toBits(h.salt)),"string"==typeof h.iv&&(h.iv=m.codec.base64.toBits(h.iv)),(!m.mode[h.mode]||!m.cipher[h.cipher]||"string"==typeof a&&100>=h.iter||64!==h.ts&&96!==h.ts&&128!==h.ts||128!==h.ks&&192!==h.ks&&256!==h.ks||2>h.iv.length||4<h.iv.length)&&c(new m.exception.invalid("json encrypt: invalid parameters")),"string"==typeof a?(f=m.misc.cachedPbkdf2(a,h),a=f.key.slice(0,h.ks/32),h.salt=f.salt):m.ecc&&a instanceof m.ecc.elGamal.publicKey&&(f=a.kem(),h.kemtag=f.tag,a=f.key.slice(0,h.ks/32)),"string"==typeof b&&(b=m.codec.utf8String.toBits(b)),"string"==typeof d&&(d=m.codec.utf8String.toBits(d)),f=new m.cipher[h.cipher](a),g.e(e,h),e.key=a,h.ct=m.mode[h.mode].encrypt(f,b,h.iv,d,h.ts),h},encrypt:function(){var a=m.json,b=a.Y.apply(a,arguments);return a.encode(b)},X:function(a,b,d,e){d=d||{},e=e||{};var f=m.json;b=f.e(f.e(f.e({},f.defaults),b),d,!0);var g;return d=b.adata,"string"==typeof b.salt&&(b.salt=m.codec.base64.toBits(b.salt)),"string"==typeof b.iv&&(b.iv=m.codec.base64.toBits(b.iv)),(!m.mode[b.mode]||!m.cipher[b.cipher]||"string"==typeof a&&100>=b.iter||64!==b.ts&&96!==b.ts&&128!==b.ts||128!==b.ks&&192!==b.ks&&256!==b.ks||!b.iv||2>b.iv.length||4<b.iv.length)&&c(new m.exception.invalid("json decrypt: invalid parameters")),"string"==typeof a?(g=m.misc.cachedPbkdf2(a,b),a=g.key.slice(0,b.ks/32),b.salt=g.salt):m.ecc&&a instanceof m.ecc.elGamal.secretKey&&(a=a.unkem(m.codec.base64.toBits(b.kemtag)).slice(0,b.ks/32)),"string"==typeof d&&(d=m.codec.utf8String.toBits(d)),g=new m.cipher[b.cipher](a),d=m.mode[b.mode].decrypt(g,b.ct,b.iv,d,b.ts),f.e(e,b),e.key=a,m.codec.utf8String.fromBits(d)},decrypt:function(a,b,c,d){var e=m.json;return e.X(a,e.decode(b),c,d)},encode:function(a){var b,d="{",e="";for(b in a)if(a.hasOwnProperty(b))switch(b.match(/^[a-z0-9]+$/i)||c(new m.exception.invalid("json encode: invalid property name")),d+=e+'"'+b+'":',e=",",typeof a[b]){case"number":case"boolean":d+=a[b];break;case"string":d+='"'+escape(a[b])+'"';break;case"object":d+='"'+m.codec.base64.fromBits(a[b],0)+'"';break;default:c(new m.exception.bug("json encode: unsupported type"))}return d+"}"},decode:function(a){a=a.replace(/\s/g,""),a.match(/^\{.*\}$/)||c(new m.exception.invalid("json decode: this isn't json!")),a=a.replace(/^\{|\}$/g,"").split(/,/);var b,d,e={};for(b=0;b<a.length;b++)(d=a[b].match(/^(?:(["']?)([a-z][a-z0-9]*)\1):(?:(\d+)|"([a-z0-9+\/%*_.@=\-]*)")$/i))||c(new m.exception.invalid("json decode: this isn't json!")),e[d[2]]=d[3]?parseInt(d[3],10):d[2].match(/^(ct|salt|iv)$/)?m.codec.base64.toBits(d[4]):unescape(d[4]);return e},e:function(a,b,d){if(a===k&&(a={}),b===k)return a;for(var e in b)b.hasOwnProperty(e)&&(d&&a[e]!==k&&a[e]!==b[e]&&c(new m.exception.invalid("required parameter overridden")),a[e]=b[e]);return a},ea:function(a,b){var c,d={};for(c in a)a.hasOwnProperty(c)&&a[c]!==b[c]&&(d[c]=a[c]);return d},da:function(a,b){var c,d={};for(c=0;c<b.length;c++)a[b[c]]!==k&&(d[b[c]]=a[b[c]]);return d}},m.encrypt=m.json.encrypt,m.decrypt=m.json.decrypt,m.misc.ca={},m.misc.cachedPbkdf2=function(a,b){var c,d=m.misc.ca;return b=b||{},c=b.iter||1e3,d=d[a]=d[a]||{},c=d[c]=d[c]||{firstSalt:b.salt&&b.salt.length?b.salt.slice(0):m.random.randomWords(2,0)},d=b.salt===k?c.firstSalt:b.salt,c[d]=c[d]||m.misc.pbkdf2(a,d,b.iter),{key:c[d].slice(0),salt:d.slice(0)}}},{crypto:35}],18:[function(a,b,c){(function(b){var d=a("socket.io-client");c.install=function(a){var c={};a.deliver("http",function(e,f){c[e.http]||(c[e.http]=d.connect(e.http),c[e.http].on("packet",function(c){a.receive(new b(c.data,"base64").toString("binary"),e)})),c[e.http].emit("packet",{data:f.toString("base64")})})}}).call(this,a("buffer").Buffer)},{buffer:29,"socket.io-client":19}],19:[function(require,module,exports){var io="undefined"==typeof module?{}:module.exports;!function(){if(function(a,b){var c=a;c.version="0.9.17",c.protocol=1,c.transports=[],c.j=[],c.sockets={},c.connect=function(a,d){var e,f,g=c.util.parseUri(a);b&&b.location&&(g.protocol=g.protocol||b.location.protocol.slice(0,-1),g.host=g.host||(b.document?b.document.domain:b.location.hostname),g.port=g.port||b.location.port),e=c.util.uniqueUri(g);var h={host:g.host,secure:"https"==g.protocol,port:g.port||("https"==g.protocol?443:80),query:g.query||""};return c.util.merge(h,d),(h["force new connection"]||!c.sockets[e])&&(f=new c.Socket(h)),!h["force new connection"]&&f&&(c.sockets[e]=f),f=f||c.sockets[e],f.of(g.path.length>1?g.path:"")}}("object"==typeof module?module.exports:this.io={},this),function(a,b){var c=a.util={},d=/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,e=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];c.parseUri=function(a){for(var b=d.exec(a||""),c={},f=14;f--;)c[e[f]]=b[f]||"";return c},c.uniqueUri=function(a){var c=a.protocol,d=a.host,e=a.port;return"document"in b?(d=d||document.domain,e=e||("https"==c&&"https:"!==document.location.protocol?443:document.location.port)):(d=d||"localhost",e||"https"!=c||(e=443)),(c||"http")+"://"+d+":"+(e||80)},c.query=function(a,b){var d=c.chunkQuery(a||""),e=[];c.merge(d,c.chunkQuery(b||""));for(var f in d)d.hasOwnProperty(f)&&e.push(f+"="+d[f]);return e.length?"?"+e.join("&"):""},c.chunkQuery=function(a){for(var b,c={},d=a.split("&"),e=0,f=d.length;f>e;++e)b=d[e].split("="),b[0]&&(c[b[0]]=b[1]);return c};var f=!1;c.load=function(a){return"document"in b&&"complete"===document.readyState||f?a():void c.on(b,"load",a,!1)},c.on=function(a,b,c,d){a.attachEvent?a.attachEvent("on"+b,c):a.addEventListener&&a.addEventListener(b,c,d)},c.request=function(a){if(a&&"undefined"!=typeof XDomainRequest&&!c.ua.hasCORS)return new XDomainRequest;if("undefined"!=typeof XMLHttpRequest&&(!a||c.ua.hasCORS))return new XMLHttpRequest;if(!a)try{return new(window[["Active"].concat("Object").join("X")])("Microsoft.XMLHTTP")}catch(b){}return null},"undefined"!=typeof window&&c.load(function(){f=!0}),c.defer=function(a){return c.ua.webkit&&"undefined"==typeof importScripts?void c.load(function(){setTimeout(a,100)}):a()},c.merge=function(a,b,d,e){var f,g=e||[],h="undefined"==typeof d?2:d;for(f in b)b.hasOwnProperty(f)&&c.indexOf(g,f)<0&&("object"==typeof a[f]&&h?c.merge(a[f],b[f],h-1,g):(a[f]=b[f],g.push(b[f])));return a},c.mixin=function(a,b){c.merge(a.prototype,b.prototype)},c.inherit=function(a,b){function c(){}c.prototype=b.prototype,a.prototype=new c},c.isArray=Array.isArray||function(a){return"[object Array]"===Object.prototype.toString.call(a)},c.intersect=function(a,b){for(var d=[],e=a.length>b.length?a:b,f=a.length>b.length?b:a,g=0,h=f.length;h>g;g++)~c.indexOf(e,f[g])&&d.push(f[g]);return d},c.indexOf=function(a,b,c){for(var d=a.length,c=0>c?0>c+d?0:c+d:c||0;d>c&&a[c]!==b;c++);return c>=d?-1:c},c.toArray=function(a){for(var b=[],c=0,d=a.length;d>c;c++)b.push(a[c]);return b},c.ua={},c.ua.hasCORS="undefined"!=typeof XMLHttpRequest&&function(){try{var a=new XMLHttpRequest}catch(b){return!1}return void 0!=a.withCredentials}(),c.ua.webkit="undefined"!=typeof navigator&&/webkit/i.test(navigator.userAgent),c.ua.iDevice="undefined"!=typeof navigator&&/iPad|iPhone|iPod/i.test(navigator.userAgent)}("undefined"!=typeof io?io:module.exports,this),function(a,b){function c(){}a.EventEmitter=c,c.prototype.on=function(a,c){return this.$events||(this.$events={}),this.$events[a]?b.util.isArray(this.$events[a])?this.$events[a].push(c):this.$events[a]=[this.$events[a],c]:this.$events[a]=c,this},c.prototype.addListener=c.prototype.on,c.prototype.once=function(a,b){function c(){d.removeListener(a,c),b.apply(this,arguments)}var d=this;return c.listener=b,this.on(a,c),this},c.prototype.removeListener=function(a,c){if(this.$events&&this.$events[a]){var d=this.$events[a];if(b.util.isArray(d)){for(var e=-1,f=0,g=d.length;g>f;f++)if(d[f]===c||d[f].listener&&d[f].listener===c){e=f;break}if(0>e)return this;d.splice(e,1),d.length||delete this.$events[a]}else(d===c||d.listener&&d.listener===c)&&delete this.$events[a]}return this},c.prototype.removeAllListeners=function(a){return void 0===a?(this.$events={},this):(this.$events&&this.$events[a]&&(this.$events[a]=null),this)},c.prototype.listeners=function(a){return this.$events||(this.$events={}),this.$events[a]||(this.$events[a]=[]),b.util.isArray(this.$events[a])||(this.$events[a]=[this.$events[a]]),this.$events[a]},c.prototype.emit=function(a){if(!this.$events)return!1;var c=this.$events[a];if(!c)return!1;var d=Array.prototype.slice.call(arguments,1);if("function"==typeof c)c.apply(this,d);else{if(!b.util.isArray(c))return!1;for(var e=c.slice(),f=0,g=e.length;g>f;f++)e[f].apply(this,d)}return!0}}("undefined"!=typeof io?io:module.exports,"undefined"!=typeof io?io:module.parent.exports),function(exports,nativeJSON){"use strict";function f(a){return 10>a?"0"+a:a}function date(a){return isFinite(a.valueOf())?a.getUTCFullYear()+"-"+f(a.getUTCMonth()+1)+"-"+f(a.getUTCDate())+"T"+f(a.getUTCHours())+":"+f(a.getUTCMinutes())+":"+f(a.getUTCSeconds())+"Z":null}function quote(a){return escapable.lastIndex=0,escapable.test(a)?'"'+a.replace(escapable,function(a){var b=meta[a];return"string"==typeof b?b:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+a+'"'}function str(a,b){var c,d,e,f,g,h=gap,i=b[a];switch(i instanceof Date&&(i=date(a)),"function"==typeof rep&&(i=rep.call(b,a,i)),typeof i){case"string":return quote(i);case"number":return isFinite(i)?String(i):"null";case"boolean":case"null":return String(i);case"object":if(!i)return"null";if(gap+=indent,g=[],"[object Array]"===Object.prototype.toString.apply(i)){for(f=i.length,c=0;f>c;c+=1)g[c]=str(c,i)||"null";return e=0===g.length?"[]":gap?"[\n"+gap+g.join(",\n"+gap)+"\n"+h+"]":"["+g.join(",")+"]",gap=h,e}if(rep&&"object"==typeof rep)for(f=rep.length,c=0;f>c;c+=1)"string"==typeof rep[c]&&(d=rep[c],e=str(d,i),e&&g.push(quote(d)+(gap?": ":":")+e));else for(d in i)Object.prototype.hasOwnProperty.call(i,d)&&(e=str(d,i),e&&g.push(quote(d)+(gap?": ":":")+e));return e=0===g.length?"{}":gap?"{\n"+gap+g.join(",\n"+gap)+"\n"+h+"}":"{"+g.join(",")+"}",gap=h,e}}if(nativeJSON&&nativeJSON.parse)return exports.JSON={parse:nativeJSON.parse,stringify:nativeJSON.stringify};var JSON=exports.JSON={},cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta={"\b":"\\b","	":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},rep;JSON.stringify=function(a,b,c){var d;if(gap="",indent="","number"==typeof c)for(d=0;c>d;d+=1)indent+=" ";else"string"==typeof c&&(indent=c);if(rep=b,b&&"function"!=typeof b&&("object"!=typeof b||"number"!=typeof b.length))throw new Error("JSON.stringify");return str("",{"":a})},JSON.parse=function(text,reviver){function walk(a,b){var c,d,e=a[b];if(e&&"object"==typeof e)for(c in e)Object.prototype.hasOwnProperty.call(e,c)&&(d=walk(e,c),void 0!==d?e[c]=d:delete e[c]);return reviver.call(a,b,e)}var j;if(text=String(text),cx.lastIndex=0,cx.test(text)&&(text=text.replace(cx,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})),/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return j=eval("("+text+")"),"function"==typeof reviver?walk({"":j},""):j;throw new SyntaxError("JSON.parse")}}("undefined"!=typeof io?io:module.exports,"undefined"!=typeof JSON?JSON:void 0),function(a,b){var c=a.parser={},d=c.packets=["disconnect","connect","heartbeat","message","json","event","ack","error","noop"],e=c.reasons=["transport not supported","client not handshaken","unauthorized"],f=c.advice=["reconnect"],g=b.JSON,h=b.util.indexOf;c.encodePacket=function(a){var b=h(d,a.type),c=a.id||"",i=a.endpoint||"",j=a.ack,k=null;switch(a.type){case"error":var l=a.reason?h(e,a.reason):"",m=a.advice?h(f,a.advice):"";(""!==l||""!==m)&&(k=l+(""!==m?"+"+m:""));break;case"message":""!==a.data&&(k=a.data);break;case"event":var n={name:a.name};a.args&&a.args.length&&(n.args=a.args),k=g.stringify(n);break;case"json":k=g.stringify(a.data);break;case"connect":a.qs&&(k=a.qs);break;case"ack":k=a.ackId+(a.args&&a.args.length?"+"+g.stringify(a.args):"")}var o=[b,c+("data"==j?"+":""),i];return null!==k&&void 0!==k&&o.push(k),o.join(":")},c.encodePayload=function(a){var b="";if(1==a.length)return a[0];for(var c=0,d=a.length;d>c;c++){var e=a[c];b+=""+e.length+""+a[c]}return b};var i=/([^:]+):([0-9]+)?(\+)?:([^:]+)?:?([\s\S]*)?/;c.decodePacket=function(a){var b=a.match(i);if(!b)return{};var c=b[2]||"",a=b[5]||"",h={type:d[b[1]],endpoint:b[4]||""};switch(c&&(h.id=c,h.ack=b[3]?"data":!0),h.type){case"error":var b=a.split("+");h.reason=e[b[0]]||"",h.advice=f[b[1]]||"";break;case"message":h.data=a||"";break;case"event":try{var j=g.parse(a);h.name=j.name,h.args=j.args}catch(k){}h.args=h.args||[];break;case"json":try{h.data=g.parse(a)}catch(k){}break;case"connect":h.qs=a||"";break;case"ack":var b=a.match(/^([0-9]+)(\+)?(.*)/);if(b&&(h.ackId=b[1],h.args=[],b[3]))try{h.args=b[3]?g.parse(b[3]):[]}catch(k){}break;case"disconnect":case"heartbeat":}return h},c.decodePayload=function(a){if(""==a.charAt(0)){for(var b=[],d=1,e="";d<a.length;d++)""==a.charAt(d)?(b.push(c.decodePacket(a.substr(d+1).substr(0,e))),d+=Number(e)+1,e=""):e+=a.charAt(d);return b}return[c.decodePacket(a)]}}("undefined"!=typeof io?io:module.exports,"undefined"!=typeof io?io:module.parent.exports),function(a,b){function c(a,b){this.socket=a,this.sessid=b}a.Transport=c,b.util.mixin(c,b.EventEmitter),c.prototype.heartbeats=function(){return!0},c.prototype.onData=function(a){if(this.clearCloseTimeout(),(this.socket.connected||this.socket.connecting||this.socket.reconnecting)&&this.setCloseTimeout(),""!==a){var c=b.parser.decodePayload(a);if(c&&c.length)for(var d=0,e=c.length;e>d;d++)this.onPacket(c[d])}return this},c.prototype.onPacket=function(a){return this.socket.setHeartbeatTimeout(),"heartbeat"==a.type?this.onHeartbeat():("connect"==a.type&&""==a.endpoint&&this.onConnect(),"error"==a.type&&"reconnect"==a.advice&&(this.isOpen=!1),this.socket.onPacket(a),this)},c.prototype.setCloseTimeout=function(){if(!this.closeTimeout){var a=this;this.closeTimeout=setTimeout(function(){a.onDisconnect()},this.socket.closeTimeout)}},c.prototype.onDisconnect=function(){return this.isOpen&&this.close(),this.clearTimeouts(),this.socket.onDisconnect(),this},c.prototype.onConnect=function(){return this.socket.onConnect(),this},c.prototype.clearCloseTimeout=function(){this.closeTimeout&&(clearTimeout(this.closeTimeout),this.closeTimeout=null)},c.prototype.clearTimeouts=function(){this.clearCloseTimeout(),this.reopenTimeout&&clearTimeout(this.reopenTimeout)},c.prototype.packet=function(a){this.send(b.parser.encodePacket(a))},c.prototype.onHeartbeat=function(){this.packet({type:"heartbeat"})},c.prototype.onOpen=function(){this.isOpen=!0,this.clearCloseTimeout(),this.socket.onOpen()},c.prototype.onClose=function(){this.isOpen=!1,this.socket.onClose(),this.onDisconnect()},c.prototype.prepareUrl=function(){var a=this.socket.options;return this.scheme()+"://"+a.host+":"+a.port+"/"+a.resource+"/"+b.protocol+"/"+this.name+"/"+this.sessid},c.prototype.ready=function(a,b){b.call(this)}}("undefined"!=typeof io?io:module.exports,"undefined"!=typeof io?io:module.parent.exports),function(a,b,c){function d(a){if(this.options={port:80,secure:!1,document:"document"in c?document:!1,resource:"socket.io",transports:b.transports,"connect timeout":1e4,"try multiple transports":!0,reconnect:!0,"reconnection delay":500,"reconnection limit":1/0,"reopen delay":3e3,"max reconnection attempts":10,"sync disconnect on unload":!1,"auto connect":!0,"flash policy port":10843,manualFlush:!1},b.util.merge(this.options,a),this.connected=!1,this.open=!1,this.connecting=!1,this.reconnecting=!1,this.namespaces={},this.buffer=[],this.doBuffer=!1,this.options["sync disconnect on unload"]&&(!this.isXDomain()||b.util.ua.hasCORS)){var d=this;b.util.on(c,"beforeunload",function(){d.disconnectSync()},!1)}this.options["auto connect"]&&this.connect()}function e(){}a.Socket=d,b.util.mixin(d,b.EventEmitter),d.prototype.of=function(a){return this.namespaces[a]||(this.namespaces[a]=new b.SocketNamespace(this,a),""!==a&&this.namespaces[a].packet({type:"connect"})),this.namespaces[a]},d.prototype.publish=function(){this.emit.apply(this,arguments);var a;for(var b in this.namespaces)this.namespaces.hasOwnProperty(b)&&(a=this.of(b),a.$emit.apply(a,arguments))},d.prototype.handshake=function(a){function c(b){b instanceof Error?(d.connecting=!1,d.onError(b.message)):a.apply(null,b.split(":"))}var d=this,f=this.options,g=["http"+(f.secure?"s":"")+":/",f.host+":"+f.port,f.resource,b.protocol,b.util.query(this.options.query,"t="+ +new Date)].join("/");if(this.isXDomain()&&!b.util.ua.hasCORS){var h=document.getElementsByTagName("script")[0],i=document.createElement("script");i.src=g+"&jsonp="+b.j.length,h.parentNode.insertBefore(i,h),b.j.push(function(a){c(a),i.parentNode.removeChild(i)})}else{var j=b.util.request();j.open("GET",g,!0),this.isXDomain()&&(j.withCredentials=!0),j.onreadystatechange=function(){4==j.readyState&&(j.onreadystatechange=e,200==j.status?c(j.responseText):403==j.status?d.onError(j.responseText):(d.connecting=!1,!d.reconnecting&&d.onError(j.responseText)))},j.send(null)}},d.prototype.getTransport=function(a){for(var c,d=a||this.transports,e=0;c=d[e];e++)if(b.Transport[c]&&b.Transport[c].check(this)&&(!this.isXDomain()||b.Transport[c].xdomainCheck(this)))return new b.Transport[c](this,this.sessionid);return null},d.prototype.connect=function(a){if(this.connecting)return this;var c=this;return c.connecting=!0,this.handshake(function(d,e,f,g){function h(a){return c.transport&&c.transport.clearTimeouts(),c.transport=c.getTransport(a),c.transport?void c.transport.ready(c,function(){c.connecting=!0,c.publish("connecting",c.transport.name),c.transport.open(),c.options["connect timeout"]&&(c.connectTimeoutTimer=setTimeout(function(){if(!c.connected&&(c.connecting=!1,c.options["try multiple transports"])){for(var a=c.transports;a.length>0&&a.splice(0,1)[0]!=c.transport.name;);a.length?h(a):c.publish("connect_failed")}},c.options["connect timeout"]))}):c.publish("connect_failed")}c.sessionid=d,c.closeTimeout=1e3*f,c.heartbeatTimeout=1e3*e,c.transports||(c.transports=c.origTransports=g?b.util.intersect(g.split(","),c.options.transports):c.options.transports),c.setHeartbeatTimeout(),h(c.transports),c.once("connect",function(){clearTimeout(c.connectTimeoutTimer),a&&"function"==typeof a&&a()})}),this},d.prototype.setHeartbeatTimeout=function(){if(clearTimeout(this.heartbeatTimeoutTimer),!this.transport||this.transport.heartbeats()){var a=this;this.heartbeatTimeoutTimer=setTimeout(function(){a.transport.onClose()},this.heartbeatTimeout)}},d.prototype.packet=function(a){return this.connected&&!this.doBuffer?this.transport.packet(a):this.buffer.push(a),this},d.prototype.setBuffer=function(a){this.doBuffer=a,!a&&this.connected&&this.buffer.length&&(this.options.manualFlush||this.flushBuffer())},d.prototype.flushBuffer=function(){this.transport.payload(this.buffer),this.buffer=[]},d.prototype.disconnect=function(){return(this.connected||this.connecting)&&(this.open&&this.of("").packet({type:"disconnect"}),this.onDisconnect("booted")),this},d.prototype.disconnectSync=function(){var a=b.util.request(),c=["http"+(this.options.secure?"s":"")+":/",this.options.host+":"+this.options.port,this.options.resource,b.protocol,"",this.sessionid].join("/")+"/?disconnect=1";a.open("GET",c,!1),a.send(null),this.onDisconnect("booted")},d.prototype.isXDomain=function(){var a=c.location.port||("https:"==c.location.protocol?443:80);return this.options.host!==c.location.hostname||this.options.port!=a},d.prototype.onConnect=function(){this.connected||(this.connected=!0,this.connecting=!1,this.doBuffer||this.setBuffer(!1),this.emit("connect"))},d.prototype.onOpen=function(){this.open=!0},d.prototype.onClose=function(){this.open=!1,clearTimeout(this.heartbeatTimeoutTimer)},d.prototype.onPacket=function(a){this.of(a.endpoint).onPacket(a)},d.prototype.onError=function(a){a&&a.advice&&"reconnect"===a.advice&&(this.connected||this.connecting)&&(this.disconnect(),this.options.reconnect&&this.reconnect()),this.publish("error",a&&a.reason?a.reason:a)},d.prototype.onDisconnect=function(a){var b=this.connected,c=this.connecting;this.connected=!1,this.connecting=!1,this.open=!1,(b||c)&&(this.transport.close(),this.transport.clearTimeouts(),b&&(this.publish("disconnect",a),"booted"!=a&&this.options.reconnect&&!this.reconnecting&&this.reconnect()))},d.prototype.reconnect=function(){function a(){if(c.connected){for(var a in c.namespaces)c.namespaces.hasOwnProperty(a)&&""!==a&&c.namespaces[a].packet({type:"connect"});c.publish("reconnect",c.transport.name,c.reconnectionAttempts)}clearTimeout(c.reconnectionTimer),c.removeListener("connect_failed",b),c.removeListener("connect",b),c.reconnecting=!1,delete c.reconnectionAttempts,delete c.reconnectionDelay,delete c.reconnectionTimer,delete c.redoTransports,c.options["try multiple transports"]=e}function b(){return c.reconnecting?c.connected?a():c.connecting&&c.reconnecting?c.reconnectionTimer=setTimeout(b,1e3):void(c.reconnectionAttempts++>=d?c.redoTransports?(c.publish("reconnect_failed"),a()):(c.on("connect_failed",b),c.options["try multiple transports"]=!0,c.transports=c.origTransports,c.transport=c.getTransport(),c.redoTransports=!0,c.connect()):(c.reconnectionDelay<f&&(c.reconnectionDelay*=2),c.connect(),c.publish("reconnecting",c.reconnectionDelay,c.reconnectionAttempts),c.reconnectionTimer=setTimeout(b,c.reconnectionDelay))):void 0}this.reconnecting=!0,this.reconnectionAttempts=0,this.reconnectionDelay=this.options["reconnection delay"];var c=this,d=this.options["max reconnection attempts"],e=this.options["try multiple transports"],f=this.options["reconnection limit"];this.options["try multiple transports"]=!1,this.reconnectionTimer=setTimeout(b,this.reconnectionDelay),this.on("connect",b)}}("undefined"!=typeof io?io:module.exports,"undefined"!=typeof io?io:module.parent.exports,this),function(a,b){function c(a,b){this.socket=a,this.name=b||"",this.flags={},this.json=new d(this,"json"),this.ackPackets=0,this.acks={}}function d(a,b){this.namespace=a,this.name=b}a.SocketNamespace=c,b.util.mixin(c,b.EventEmitter),c.prototype.$emit=b.EventEmitter.prototype.emit,c.prototype.of=function(){return this.socket.of.apply(this.socket,arguments)},c.prototype.packet=function(a){return a.endpoint=this.name,this.socket.packet(a),this.flags={},this},c.prototype.send=function(a,b){var c={type:this.flags.json?"json":"message",data:a};return"function"==typeof b&&(c.id=++this.ackPackets,c.ack=!0,this.acks[c.id]=b),this.packet(c)},c.prototype.emit=function(a){var b=Array.prototype.slice.call(arguments,1),c=b[b.length-1],d={type:"event",name:a};return"function"==typeof c&&(d.id=++this.ackPackets,d.ack="data",this.acks[d.id]=c,b=b.slice(0,b.length-1)),d.args=b,this.packet(d)},c.prototype.disconnect=function(){return""===this.name?this.socket.disconnect():(this.packet({type:"disconnect"}),this.$emit("disconnect")),this},c.prototype.onPacket=function(a){function c(){d.packet({type:"ack",args:b.util.toArray(arguments),ackId:a.id})}var d=this;switch(a.type){case"connect":this.$emit("connect");break;case"disconnect":""===this.name?this.socket.onDisconnect(a.reason||"booted"):this.$emit("disconnect",a.reason);break;case"message":case"json":var e=["message",a.data];"data"==a.ack?e.push(c):a.ack&&this.packet({type:"ack",ackId:a.id}),this.$emit.apply(this,e);break;case"event":var e=[a.name].concat(a.args);"data"==a.ack&&e.push(c),this.$emit.apply(this,e);break;case"ack":this.acks[a.ackId]&&(this.acks[a.ackId].apply(this,a.args),delete this.acks[a.ackId]);break;case"error":a.advice?this.socket.onError(a):"unauthorized"==a.reason?this.$emit("connect_failed",a.reason):this.$emit("error",a.reason)}},d.prototype.send=function(){this.namespace.flags[this.name]=!0,this.namespace.send.apply(this.namespace,arguments)},d.prototype.emit=function(){this.namespace.flags[this.name]=!0,this.namespace.emit.apply(this.namespace,arguments)}}("undefined"!=typeof io?io:module.exports,"undefined"!=typeof io?io:module.parent.exports),function(a,b,c){function d(){b.Transport.apply(this,arguments)}a.websocket=d,b.util.inherit(d,b.Transport),d.prototype.name="websocket",d.prototype.open=function(){var a,d=b.util.query(this.socket.options.query),e=this;return a||(a=c.MozWebSocket||c.WebSocket),this.websocket=new a(this.prepareUrl()+d),this.websocket.onopen=function(){e.onOpen(),e.socket.setBuffer(!1)},this.websocket.onmessage=function(a){e.onData(a.data)},this.websocket.onclose=function(){e.onClose(),e.socket.setBuffer(!0)},this.websocket.onerror=function(a){e.onError(a)},this},d.prototype.send=b.util.ua.iDevice?function(a){var b=this;return setTimeout(function(){b.websocket.send(a)},0),this}:function(a){return this.websocket.send(a),this},d.prototype.payload=function(a){for(var b=0,c=a.length;c>b;b++)this.packet(a[b]);return this},d.prototype.close=function(){return this.websocket.close(),this},d.prototype.onError=function(a){this.socket.onError(a)},d.prototype.scheme=function(){return this.socket.options.secure?"wss":"ws"},d.check=function(){return"WebSocket"in c&&!("__addTask"in WebSocket)||"MozWebSocket"in c},d.xdomainCheck=function(){return!0},b.transports.push("websocket")}("undefined"!=typeof io?io.Transport:module.exports,"undefined"!=typeof io?io:module.parent.exports,this),function(a,b){function c(){b.Transport.websocket.apply(this,arguments)}a.flashsocket=c,b.util.inherit(c,b.Transport.websocket),c.prototype.name="flashsocket",c.prototype.open=function(){var a=this,c=arguments;return WebSocket.__addTask(function(){b.Transport.websocket.prototype.open.apply(a,c)}),this},c.prototype.send=function(){var a=this,c=arguments;return WebSocket.__addTask(function(){b.Transport.websocket.prototype.send.apply(a,c)}),this},c.prototype.close=function(){return WebSocket.__tasks.length=0,b.Transport.websocket.prototype.close.call(this),this},c.prototype.ready=function(a,d){function e(){var b=a.options,e=b["flash policy port"],g=["http"+(b.secure?"s":"")+":/",b.host+":"+b.port,b.resource,"static/flashsocket","WebSocketMain"+(a.isXDomain()?"Insecure":"")+".swf"];c.loaded||("undefined"==typeof WEB_SOCKET_SWF_LOCATION&&(WEB_SOCKET_SWF_LOCATION=g.join("/")),843!==e&&WebSocket.loadFlashPolicyFile("xmlsocket://"+b.host+":"+e),WebSocket.__initialize(),c.loaded=!0),d.call(f)}var f=this;return document.body?e():void b.util.load(e)},c.check=function(){return"undefined"!=typeof WebSocket&&"__initialize"in WebSocket&&swfobject?swfobject.getFlashPlayerVersion().major>=10:!1},c.xdomainCheck=function(){return!0},"undefined"!=typeof window&&(WEB_SOCKET_DISABLE_AUTO_INITIALIZATION=!0),b.transports.push("flashsocket")}("undefined"!=typeof io?io.Transport:module.exports,"undefined"!=typeof io?io:module.parent.exports),"undefined"!=typeof window)var swfobject=function(){function a(){if(!R){try{var a=K.getElementsByTagName("body")[0].appendChild(q("span"));a.parentNode.removeChild(a)}catch(b){return}R=!0;for(var c=N.length,d=0;c>d;d++)N[d]()}}function b(a){R?a():N[N.length]=a}function c(a){if(typeof J.addEventListener!=C)J.addEventListener("load",a,!1);else if(typeof K.addEventListener!=C)K.addEventListener("load",a,!1);else if(typeof J.attachEvent!=C)r(J,"onload",a);else if("function"==typeof J.onload){var b=J.onload;J.onload=function(){b(),a()}}else J.onload=a}function d(){M?e():f()}function e(){var a=K.getElementsByTagName("body")[0],b=q(D);b.setAttribute("type",G);var c=a.appendChild(b);if(c){var d=0;!function(){if(typeof c.GetVariable!=C){var e=c.GetVariable("$version");e&&(e=e.split(" ")[1].split(","),U.pv=[parseInt(e[0],10),parseInt(e[1],10),parseInt(e[2],10)])}else if(10>d)return d++,void setTimeout(arguments.callee,10);a.removeChild(b),c=null,f()}()}else f()}function f(){var a=O.length;if(a>0)for(var b=0;a>b;b++){var c=O[b].id,d=O[b].callbackFn,e={success:!1,id:c};if(U.pv[0]>0){var f=p(c);if(f)if(!s(O[b].swfVersion)||U.wk&&U.wk<312)if(O[b].expressInstall&&h()){var k={};k.data=O[b].expressInstall,k.width=f.getAttribute("width")||"0",k.height=f.getAttribute("height")||"0",f.getAttribute("class")&&(k.styleclass=f.getAttribute("class")),f.getAttribute("align")&&(k.align=f.getAttribute("align"));for(var l={},m=f.getElementsByTagName("param"),n=m.length,o=0;n>o;o++)"movie"!=m[o].getAttribute("name").toLowerCase()&&(l[m[o].getAttribute("name")]=m[o].getAttribute("value"));i(k,l,c,d)}else j(f),d&&d(e);else u(c,!0),d&&(e.success=!0,e.ref=g(c),d(e))}else if(u(c,!0),d){var q=g(c);
q&&typeof q.SetVariable!=C&&(e.success=!0,e.ref=q),d(e)}}}function g(a){var b=null,c=p(a);if(c&&"OBJECT"==c.nodeName)if(typeof c.SetVariable!=C)b=c;else{var d=c.getElementsByTagName(D)[0];d&&(b=d)}return b}function h(){return!S&&s("6.0.65")&&(U.win||U.mac)&&!(U.wk&&U.wk<312)}function i(a,b,c,d){S=!0,y=d||null,z={success:!1,id:c};var e=p(c);if(e){"OBJECT"==e.nodeName?(w=k(e),x=null):(w=e,x=c),a.id=H,(typeof a.width==C||!/%$/.test(a.width)&&parseInt(a.width,10)<310)&&(a.width="310"),(typeof a.height==C||!/%$/.test(a.height)&&parseInt(a.height,10)<137)&&(a.height="137"),K.title=K.title.slice(0,47)+" - Flash Player Installation";var f=U.ie&&U.win?["Active"].concat("").join("X"):"PlugIn",g="MMredirectURL="+J.location.toString().replace(/&/g,"%26")+"&MMplayerType="+f+"&MMdoctitle="+K.title;if(typeof b.flashvars!=C?b.flashvars+="&"+g:b.flashvars=g,U.ie&&U.win&&4!=e.readyState){var h=q("div");c+="SWFObjectNew",h.setAttribute("id",c),e.parentNode.insertBefore(h,e),e.style.display="none",function(){4==e.readyState?e.parentNode.removeChild(e):setTimeout(arguments.callee,10)}()}l(a,b,c)}}function j(a){if(U.ie&&U.win&&4!=a.readyState){var b=q("div");a.parentNode.insertBefore(b,a),b.parentNode.replaceChild(k(a),b),a.style.display="none",function(){4==a.readyState?a.parentNode.removeChild(a):setTimeout(arguments.callee,10)}()}else a.parentNode.replaceChild(k(a),a)}function k(a){var b=q("div");if(U.win&&U.ie)b.innerHTML=a.innerHTML;else{var c=a.getElementsByTagName(D)[0];if(c){var d=c.childNodes;if(d)for(var e=d.length,f=0;e>f;f++)1==d[f].nodeType&&"PARAM"==d[f].nodeName||8==d[f].nodeType||b.appendChild(d[f].cloneNode(!0))}}return b}function l(a,b,c){var d,e=p(c);if(U.wk&&U.wk<312)return d;if(e)if(typeof a.id==C&&(a.id=c),U.ie&&U.win){var f="";for(var g in a)a[g]!=Object.prototype[g]&&("data"==g.toLowerCase()?b.movie=a[g]:"styleclass"==g.toLowerCase()?f+=' class="'+a[g]+'"':"classid"!=g.toLowerCase()&&(f+=" "+g+'="'+a[g]+'"'));var h="";for(var i in b)b[i]!=Object.prototype[i]&&(h+='<param name="'+i+'" value="'+b[i]+'" />');e.outerHTML='<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"'+f+">"+h+"</object>",P[P.length]=a.id,d=p(a.id)}else{var j=q(D);j.setAttribute("type",G);for(var k in a)a[k]!=Object.prototype[k]&&("styleclass"==k.toLowerCase()?j.setAttribute("class",a[k]):"classid"!=k.toLowerCase()&&j.setAttribute(k,a[k]));for(var l in b)b[l]!=Object.prototype[l]&&"movie"!=l.toLowerCase()&&m(j,l,b[l]);e.parentNode.replaceChild(j,e),d=j}return d}function m(a,b,c){var d=q("param");d.setAttribute("name",b),d.setAttribute("value",c),a.appendChild(d)}function n(a){var b=p(a);b&&"OBJECT"==b.nodeName&&(U.ie&&U.win?(b.style.display="none",function(){4==b.readyState?o(a):setTimeout(arguments.callee,10)}()):b.parentNode.removeChild(b))}function o(a){var b=p(a);if(b){for(var c in b)"function"==typeof b[c]&&(b[c]=null);b.parentNode.removeChild(b)}}function p(a){var b=null;try{b=K.getElementById(a)}catch(c){}return b}function q(a){return K.createElement(a)}function r(a,b,c){a.attachEvent(b,c),Q[Q.length]=[a,b,c]}function s(a){var b=U.pv,c=a.split(".");return c[0]=parseInt(c[0],10),c[1]=parseInt(c[1],10)||0,c[2]=parseInt(c[2],10)||0,b[0]>c[0]||b[0]==c[0]&&b[1]>c[1]||b[0]==c[0]&&b[1]==c[1]&&b[2]>=c[2]?!0:!1}function t(a,b,c,d){if(!U.ie||!U.mac){var e=K.getElementsByTagName("head")[0];if(e){var f=c&&"string"==typeof c?c:"screen";if(d&&(A=null,B=null),!A||B!=f){var g=q("style");g.setAttribute("type","text/css"),g.setAttribute("media",f),A=e.appendChild(g),U.ie&&U.win&&typeof K.styleSheets!=C&&K.styleSheets.length>0&&(A=K.styleSheets[K.styleSheets.length-1]),B=f}U.ie&&U.win?A&&typeof A.addRule==D&&A.addRule(a,b):A&&typeof K.createTextNode!=C&&A.appendChild(K.createTextNode(a+" {"+b+"}"))}}}function u(a,b){if(T){var c=b?"visible":"hidden";R&&p(a)?p(a).style.visibility=c:t("#"+a,"visibility:"+c)}}function v(a){var b=/[\\\"<>\.;]/,c=null!=b.exec(a);return c&&typeof encodeURIComponent!=C?encodeURIComponent(a):a}{var w,x,y,z,A,B,C="undefined",D="object",E="Shockwave Flash",F="ShockwaveFlash.ShockwaveFlash",G="application/x-shockwave-flash",H="SWFObjectExprInst",I="onreadystatechange",J=window,K=document,L=navigator,M=!1,N=[d],O=[],P=[],Q=[],R=!1,S=!1,T=!0,U=function(){var a=typeof K.getElementById!=C&&typeof K.getElementsByTagName!=C&&typeof K.createElement!=C,b=L.userAgent.toLowerCase(),c=L.platform.toLowerCase(),d=/win/.test(c?c:b),e=/mac/.test(c?c:b),f=/webkit/.test(b)?parseFloat(b.replace(/^.*webkit\/(\d+(\.\d+)?).*$/,"$1")):!1,g=!1,h=[0,0,0],i=null;if(typeof L.plugins!=C&&typeof L.plugins[E]==D)i=L.plugins[E].description,!i||typeof L.mimeTypes!=C&&L.mimeTypes[G]&&!L.mimeTypes[G].enabledPlugin||(M=!0,g=!1,i=i.replace(/^.*\s+(\S+\s+\S+$)/,"$1"),h[0]=parseInt(i.replace(/^(.*)\..*$/,"$1"),10),h[1]=parseInt(i.replace(/^.*\.(.*)\s.*$/,"$1"),10),h[2]=/[a-zA-Z]/.test(i)?parseInt(i.replace(/^.*[a-zA-Z]+(.*)$/,"$1"),10):0);else if(typeof J[["Active"].concat("Object").join("X")]!=C)try{var j=new(window[["Active"].concat("Object").join("X")])(F);j&&(i=j.GetVariable("$version"),i&&(g=!0,i=i.split(" ")[1].split(","),h=[parseInt(i[0],10),parseInt(i[1],10),parseInt(i[2],10)]))}catch(k){}return{w3:a,pv:h,wk:f,ie:g,win:d,mac:e}}();!function(){U.w3&&((typeof K.readyState!=C&&"complete"==K.readyState||typeof K.readyState==C&&(K.getElementsByTagName("body")[0]||K.body))&&a(),R||(typeof K.addEventListener!=C&&K.addEventListener("DOMContentLoaded",a,!1),U.ie&&U.win&&(K.attachEvent(I,function(){"complete"==K.readyState&&(K.detachEvent(I,arguments.callee),a())}),J==top&&!function(){if(!R){try{K.documentElement.doScroll("left")}catch(b){return void setTimeout(arguments.callee,0)}a()}}()),U.wk&&!function(){return R?void 0:/loaded|complete/.test(K.readyState)?void a():void setTimeout(arguments.callee,0)}(),c(a)))}(),function(){U.ie&&U.win&&window.attachEvent("onunload",function(){for(var a=Q.length,b=0;a>b;b++)Q[b][0].detachEvent(Q[b][1],Q[b][2]);for(var c=P.length,d=0;c>d;d++)n(P[d]);for(var e in U)U[e]=null;U=null;for(var f in swfobject)swfobject[f]=null;swfobject=null})}()}return{registerObject:function(a,b,c,d){if(U.w3&&a&&b){var e={};e.id=a,e.swfVersion=b,e.expressInstall=c,e.callbackFn=d,O[O.length]=e,u(a,!1)}else d&&d({success:!1,id:a})},getObjectById:function(a){return U.w3?g(a):void 0},embedSWF:function(a,c,d,e,f,g,j,k,m,n){var o={success:!1,id:c};U.w3&&!(U.wk&&U.wk<312)&&a&&c&&d&&e&&f?(u(c,!1),b(function(){d+="",e+="";var b={};if(m&&typeof m===D)for(var p in m)b[p]=m[p];b.data=a,b.width=d,b.height=e;var q={};if(k&&typeof k===D)for(var r in k)q[r]=k[r];if(j&&typeof j===D)for(var t in j)typeof q.flashvars!=C?q.flashvars+="&"+t+"="+j[t]:q.flashvars=t+"="+j[t];if(s(f)){var v=l(b,q,c);b.id==c&&u(c,!0),o.success=!0,o.ref=v}else{if(g&&h())return b.data=g,void i(b,q,c,n);u(c,!0)}n&&n(o)})):n&&n(o)},switchOffAutoHideShow:function(){T=!1},ua:U,getFlashPlayerVersion:function(){return{major:U.pv[0],minor:U.pv[1],release:U.pv[2]}},hasFlashPlayerVersion:s,createSWF:function(a,b,c){return U.w3?l(a,b,c):void 0},showExpressInstall:function(a,b,c,d){U.w3&&h()&&i(a,b,c,d)},removeSWF:function(a){U.w3&&n(a)},createCSS:function(a,b,c,d){U.w3&&t(a,b,c,d)},addDomLoadEvent:b,addLoadEvent:c,getQueryParamValue:function(a){var b=K.location.search||K.location.hash;if(b){if(/\?/.test(b)&&(b=b.split("?")[1]),null==a)return v(b);for(var c=b.split("&"),d=0;d<c.length;d++)if(c[d].substring(0,c[d].indexOf("="))==a)return v(c[d].substring(c[d].indexOf("=")+1))}return""},expressInstallCallback:function(){if(S){var a=p(H);a&&w&&(a.parentNode.replaceChild(w,a),x&&(u(x,!0),U.ie&&U.win&&(w.style.display="block")),y&&y(z)),S=!1}}}}();!function(){if("undefined"!=typeof window&&!window.WebSocket){var a=window.console;if(a&&a.log&&a.error||(a={log:function(){},error:function(){}}),!swfobject.hasFlashPlayerVersion("10.0.0"))return void a.error("Flash Player >= 10.0.0 is required.");"file:"==location.protocol&&a.error("WARNING: web-socket-js doesn't work in file:///... URL unless you set Flash Security Settings properly. Open the page via Web server i.e. http://..."),WebSocket=function(a,b,c,d,e){var f=this;f.__id=WebSocket.__nextId++,WebSocket.__instances[f.__id]=f,f.readyState=WebSocket.CONNECTING,f.bufferedAmount=0,f.__events={},b?"string"==typeof b&&(b=[b]):b=[],setTimeout(function(){WebSocket.__addTask(function(){WebSocket.__flash.create(f.__id,a,b,c||null,d||0,e||null)})},0)},WebSocket.prototype.send=function(a){if(this.readyState==WebSocket.CONNECTING)throw"INVALID_STATE_ERR: Web Socket connection has not been established";var b=WebSocket.__flash.send(this.__id,encodeURIComponent(a));return 0>b?!0:(this.bufferedAmount+=b,!1)},WebSocket.prototype.close=function(){this.readyState!=WebSocket.CLOSED&&this.readyState!=WebSocket.CLOSING&&(this.readyState=WebSocket.CLOSING,WebSocket.__flash.close(this.__id))},WebSocket.prototype.addEventListener=function(a,b){a in this.__events||(this.__events[a]=[]),this.__events[a].push(b)},WebSocket.prototype.removeEventListener=function(a,b){if(a in this.__events)for(var c=this.__events[a],d=c.length-1;d>=0;--d)if(c[d]===b){c.splice(d,1);break}},WebSocket.prototype.dispatchEvent=function(a){for(var b=this.__events[a.type]||[],c=0;c<b.length;++c)b[c](a);var d=this["on"+a.type];d&&d(a)},WebSocket.prototype.__handleEvent=function(a){"readyState"in a&&(this.readyState=a.readyState),"protocol"in a&&(this.protocol=a.protocol);var b;if("open"==a.type||"error"==a.type)b=this.__createSimpleEvent(a.type);else if("close"==a.type)b=this.__createSimpleEvent("close");else{if("message"!=a.type)throw"unknown event type: "+a.type;var c=decodeURIComponent(a.message);b=this.__createMessageEvent("message",c)}this.dispatchEvent(b)},WebSocket.prototype.__createSimpleEvent=function(a){if(document.createEvent&&window.Event){var b=document.createEvent("Event");return b.initEvent(a,!1,!1),b}return{type:a,bubbles:!1,cancelable:!1}},WebSocket.prototype.__createMessageEvent=function(a,b){if(document.createEvent&&window.MessageEvent&&!window.opera){var c=document.createEvent("MessageEvent");return c.initMessageEvent("message",!1,!1,b,null,null,window,null),c}return{type:a,data:b,bubbles:!1,cancelable:!1}},WebSocket.CONNECTING=0,WebSocket.OPEN=1,WebSocket.CLOSING=2,WebSocket.CLOSED=3,WebSocket.__flash=null,WebSocket.__instances={},WebSocket.__tasks=[],WebSocket.__nextId=0,WebSocket.loadFlashPolicyFile=function(a){WebSocket.__addTask(function(){WebSocket.__flash.loadManualPolicyFile(a)})},WebSocket.__initialize=function(){if(!WebSocket.__flash){if(WebSocket.__swfLocation&&(window.WEB_SOCKET_SWF_LOCATION=WebSocket.__swfLocation),!window.WEB_SOCKET_SWF_LOCATION)return void a.error("[WebSocket] set WEB_SOCKET_SWF_LOCATION to location of WebSocketMain.swf");var b=document.createElement("div");b.id="webSocketContainer",b.style.position="absolute",WebSocket.__isFlashLite()?(b.style.left="0px",b.style.top="0px"):(b.style.left="-100px",b.style.top="-100px");var c=document.createElement("div");c.id="webSocketFlash",b.appendChild(c),document.body.appendChild(b),swfobject.embedSWF(WEB_SOCKET_SWF_LOCATION,"webSocketFlash","1","1","10.0.0",null,null,{hasPriority:!0,swliveconnect:!0,allowScriptAccess:"always"},null,function(b){b.success||a.error("[WebSocket] swfobject.embedSWF failed")})}},WebSocket.__onFlashInitialized=function(){setTimeout(function(){WebSocket.__flash=document.getElementById("webSocketFlash"),WebSocket.__flash.setCallerUrl(location.href),WebSocket.__flash.setDebug(!!window.WEB_SOCKET_DEBUG);for(var a=0;a<WebSocket.__tasks.length;++a)WebSocket.__tasks[a]();WebSocket.__tasks=[]},0)},WebSocket.__onFlashEvent=function(){return setTimeout(function(){try{for(var b=WebSocket.__flash.receiveEvents(),c=0;c<b.length;++c)WebSocket.__instances[b[c].webSocketId].__handleEvent(b[c])}catch(d){a.error(d)}},0),!0},WebSocket.__log=function(b){a.log(decodeURIComponent(b))},WebSocket.__error=function(b){a.error(decodeURIComponent(b))},WebSocket.__addTask=function(a){WebSocket.__flash?a():WebSocket.__tasks.push(a)},WebSocket.__isFlashLite=function(){if(!window.navigator||!window.navigator.mimeTypes)return!1;var a=window.navigator.mimeTypes["application/x-shockwave-flash"];return a&&a.enabledPlugin&&a.enabledPlugin.filename&&a.enabledPlugin.filename.match(/flashlite/i)?!0:!1},window.WEB_SOCKET_DISABLE_AUTO_INITIALIZATION||(window.addEventListener?window.addEventListener("load",function(){WebSocket.__initialize()},!1):window.attachEvent("onload",function(){WebSocket.__initialize()}))}}(),function(a,b,c){function d(a){a&&(b.Transport.apply(this,arguments),this.sendBuffer=[])}function e(){}a.XHR=d,b.util.inherit(d,b.Transport),d.prototype.open=function(){return this.socket.setBuffer(!1),this.onOpen(),this.get(),this.setCloseTimeout(),this},d.prototype.payload=function(a){for(var c=[],d=0,e=a.length;e>d;d++)c.push(b.parser.encodePacket(a[d]));this.send(b.parser.encodePayload(c))},d.prototype.send=function(a){return this.post(a),this},d.prototype.post=function(a){function b(){4==this.readyState&&(this.onreadystatechange=e,f.posting=!1,200==this.status?f.socket.setBuffer(!1):f.onClose())}function d(){this.onload=e,f.socket.setBuffer(!1)}var f=this;this.socket.setBuffer(!0),this.sendXHR=this.request("POST"),c.XDomainRequest&&this.sendXHR instanceof XDomainRequest?this.sendXHR.onload=this.sendXHR.onerror=d:this.sendXHR.onreadystatechange=b,this.sendXHR.send(a)},d.prototype.close=function(){return this.onClose(),this},d.prototype.request=function(a){var c=b.util.request(this.socket.isXDomain()),d=b.util.query(this.socket.options.query,"t="+ +new Date);if(c.open(a||"GET",this.prepareUrl()+d,!0),"POST"==a)try{c.setRequestHeader?c.setRequestHeader("Content-type","text/plain;charset=UTF-8"):c.contentType="text/plain"}catch(e){}return c},d.prototype.scheme=function(){return this.socket.options.secure?"https":"http"},d.check=function(a,d){try{var e=b.util.request(d),f=c.XDomainRequest&&e instanceof XDomainRequest,g=a&&a.options&&a.options.secure?"https:":"http:",h=c.location&&g!=c.location.protocol;if(e&&(!f||!h))return!0}catch(i){}return!1},d.xdomainCheck=function(a){return d.check(a,!0)}}("undefined"!=typeof io?io.Transport:module.exports,"undefined"!=typeof io?io:module.parent.exports,this),function(a,b){function c(){b.Transport.XHR.apply(this,arguments)}a.htmlfile=c,b.util.inherit(c,b.Transport.XHR),c.prototype.name="htmlfile",c.prototype.get=function(){this.doc=new(window[["Active"].concat("Object").join("X")])("htmlfile"),this.doc.open(),this.doc.write("<html></html>"),this.doc.close(),this.doc.parentWindow.s=this;var a=this.doc.createElement("div");a.className="socketio",this.doc.body.appendChild(a),this.iframe=this.doc.createElement("iframe"),a.appendChild(this.iframe);var c=this,d=b.util.query(this.socket.options.query,"t="+ +new Date);this.iframe.src=this.prepareUrl()+d,b.util.on(window,"unload",function(){c.destroy()})},c.prototype._=function(a,b){a=a.replace(/\\\//g,"/"),this.onData(a);try{var c=b.getElementsByTagName("script")[0];c.parentNode.removeChild(c)}catch(d){}},c.prototype.destroy=function(){if(this.iframe){try{this.iframe.src="about:blank"}catch(a){}this.doc=null,this.iframe.parentNode.removeChild(this.iframe),this.iframe=null,CollectGarbage()}},c.prototype.close=function(){return this.destroy(),b.Transport.XHR.prototype.close.call(this)},c.check=function(a){if("undefined"!=typeof window&&["Active"].concat("Object").join("X")in window)try{var c=new(window[["Active"].concat("Object").join("X")])("htmlfile");return c&&b.Transport.XHR.check(a)}catch(d){}return!1},c.xdomainCheck=function(){return!1},b.transports.push("htmlfile")}("undefined"!=typeof io?io.Transport:module.exports,"undefined"!=typeof io?io:module.parent.exports),function(a,b,c){function d(){b.Transport.XHR.apply(this,arguments)}function e(){}a["xhr-polling"]=d,b.util.inherit(d,b.Transport.XHR),b.util.merge(d,b.Transport.XHR),d.prototype.name="xhr-polling",d.prototype.heartbeats=function(){return!1},d.prototype.open=function(){var a=this;return b.Transport.XHR.prototype.open.call(a),!1},d.prototype.get=function(){function a(){4==this.readyState&&(this.onreadystatechange=e,200==this.status?(f.onData(this.responseText),f.get()):f.onClose())}function b(){this.onload=e,this.onerror=e,f.retryCounter=1,f.onData(this.responseText),f.get()}function d(){f.retryCounter++,!f.retryCounter||f.retryCounter>3?f.onClose():f.get()}if(this.isOpen){var f=this;this.xhr=this.request(),c.XDomainRequest&&this.xhr instanceof XDomainRequest?(this.xhr.onload=b,this.xhr.onerror=d):this.xhr.onreadystatechange=a,this.xhr.send(null)}},d.prototype.onClose=function(){if(b.Transport.XHR.prototype.onClose.call(this),this.xhr){this.xhr.onreadystatechange=this.xhr.onload=this.xhr.onerror=e;try{this.xhr.abort()}catch(a){}this.xhr=null}},d.prototype.ready=function(a,c){var d=this;b.util.defer(function(){c.call(d)})},b.transports.push("xhr-polling")}("undefined"!=typeof io?io.Transport:module.exports,"undefined"!=typeof io?io:module.parent.exports,this),function(a,b,c){function d(){b.Transport["xhr-polling"].apply(this,arguments),this.index=b.j.length;var a=this;b.j.push(function(b){a._(b)})}var e=c.document&&"MozAppearance"in c.document.documentElement.style;a["jsonp-polling"]=d,b.util.inherit(d,b.Transport["xhr-polling"]),d.prototype.name="jsonp-polling",d.prototype.post=function(a){function c(){d(),e.socket.setBuffer(!1)}function d(){e.iframe&&e.form.removeChild(e.iframe);try{g=document.createElement('<iframe name="'+e.iframeId+'">')}catch(a){g=document.createElement("iframe"),g.name=e.iframeId}g.id=e.iframeId,e.form.appendChild(g),e.iframe=g}var e=this,f=b.util.query(this.socket.options.query,"t="+ +new Date+"&i="+this.index);if(!this.form){var g,h=document.createElement("form"),i=document.createElement("textarea"),j=this.iframeId="socketio_iframe_"+this.index;h.className="socketio",h.style.position="absolute",h.style.top="0px",h.style.left="0px",h.style.display="none",h.target=j,h.method="POST",h.setAttribute("accept-charset","utf-8"),i.name="d",h.appendChild(i),document.body.appendChild(h),this.form=h,this.area=i}this.form.action=this.prepareUrl()+f,d(),this.area.value=b.JSON.stringify(a);try{this.form.submit()}catch(k){}this.iframe.attachEvent?g.onreadystatechange=function(){"complete"==e.iframe.readyState&&c()}:this.iframe.onload=c,this.socket.setBuffer(!0)},d.prototype.get=function(){var a=this,c=document.createElement("script"),d=b.util.query(this.socket.options.query,"t="+ +new Date+"&i="+this.index);this.script&&(this.script.parentNode.removeChild(this.script),this.script=null),c.async=!0,c.src=this.prepareUrl()+d,c.onerror=function(){a.onClose()};var f=document.getElementsByTagName("script")[0];f.parentNode.insertBefore(c,f),this.script=c,e&&setTimeout(function(){var a=document.createElement("iframe");document.body.appendChild(a),document.body.removeChild(a)},100)},d.prototype._=function(a){return this.onData(a),this.isOpen&&this.get(),this},d.prototype.ready=function(a,c){var d=this;return e?void b.util.load(function(){c.call(d)}):c.call(this)},d.check=function(){return"document"in c},d.xdomainCheck=function(){return!0},b.transports.push("jsonp-polling")}("undefined"!=typeof io?io.Transport:module.exports,"undefined"!=typeof io?io:module.parent.exports,this),"function"==typeof define&&define.amd&&define([],function(){return io})}()},{}],20:[function(a,b,c){(function(b){function d(a){a.bridgeCache={},e(a),setTimeout(function(){d(a)},X.link_timer)}function e(a){Object.keys(a.buckets).forEach(function(b){var c=a.buckets[b].sort(function(a,b){return a.age-b.age});c.length&&V("link maintenance on bucket",b,c.length),c.slice(0,X.link_k).forEach(function(b){b.linked&&C(b.to)&&(Date.now()-b.linked.sentAt<Math.ceil(X.link_timer/2)||b.linked.send({js:{seed:a.seed}}))})})}function f(a){var b=this;if(a===!0&&(b.bridging=!0),b.bridging)return!0;if(!a)return b.bridging;var c="string"==typeof a?b.whois(a):a;return c&&c.bridging?!0:!1}function g(a){var b=this;if(!a.parts)return U("invalid args to addSeed",a);var c=b.whokey(a.parts,!1,a.keys);return c?(Array.isArray(a.paths)&&a.paths.forEach(function(a){a=c.pathGet(a),a.seed=!0}),c.isSeed=!0,void b.seeds.push(c)):U("invalid seed info",a)}function h(a){function b(){if(d){var b=c.seeds.filter(function(a){return C(a.to)}).length;if(b)return a(null,b),void(d=0);d--,d||a(c.locals.length?null:"offline",c.locals.length)}}var c=this;if(c.waits.length>0)return c.waiting=function(){c.online(a)};c.isOnline=!0,c.send({type:"lan"},I(c.ping()));var d=c.seeds.length;return d?void c.seeds.forEach(function(a){a.link(function(){C(a.to)&&a.pathSync(),b()})}):(U("no seeds"),a(null,0))}function i(a,c){var d=this,e=J(a);if(!e)return U("failed to decode a packet from",c,new b(a).toString("hex"));if(2!=e.length){if(e.sender=c,e.id=d.pcounter++,e.at=Date.now(),V(">>>>",Date(),a.length,e.head.length,c&&[c.type,c.ip,c.port,c.id].join(",")),"ping"==e.js.type)return w(d,e);if("pong"==e.js.type)return x(d,e);if(1==e.head.length){var f=R(d,e);if(!f||!f.verify)return U("couldn't decode open (possibly using the wrong public key?)",f&&f.err);if(!y(f.js.line,32))return U("invalid line id enclosed",f.js.line);if(f.js.to!==d.hashname)return U("open for wrong hashname",f.js.to);var g=D(d.parts,f.js.from);if(g!=f.csid)return U("open with mismatch CSID",g,f.csid);var h=d.whokey(f.js.from,f.key);if(!h)return U("invalid hashname",f.js.from);if(h.csid=f.csid,"number"!=typeof f.js.at)return U("invalid at",f.js.at);if(h.openAt&&f.js.at<h.openAt)return V("dropping older open");if(h.openAt=f.js.at,V("inOpen verified",h.hashname,c&&JSON.stringify(c.json)),f.js.line==h.lineIn){var i=Date.now()-(h.openAcked||0);if(i<X.seek_timeout||i<X.nat_timeout&&h.openDup>=3)return;h.openDup++}else h.openDup=0;var j=h.open();return h.active(),h.openAcked=Date.now(),c=h.pathIn(c),c?d.send(c,j,h):h.relayChan&&h.relayChan.send({body:j}),void(f.js.line!=h.lineIn&&(h.lineIn=f.js.line,V("new line",h.lineIn,h.lineOut),d.CSets[f.csid].openline(h,f),d.lines[h.lineOut]=h,Object.keys(h.chans).forEach(function(a){var b=h.chans[a];if(b){if(!b.recvAt)return;h.receive({js:{c:b.id,err:"reset"}})}delete h.chans[a]})))}if(0==e.head.length){var k=e.body.slice(0,16).toString("hex"),h=d.lines[k];if(!h){if(!d.bridgeLine[k])return V("unknown line received",k,e.sender);V("BRIDGE",JSON.stringify(d.bridgeLine[k]),k);var l=T.createHash("sha256").update(e.body).digest("hex");if(d.bridgeCache[l])return;return d.bridgeCache[l]=!0,d.send(d.bridgeLine[k],I(!1,e.body))}var m;return(m=d.CSets[h.csid].delineize(h,e))?V("couldn't decrypt line",m,e.sender):(h.linedAt=h.openAt,h.active(),void h.receive(e))}Object.keys(e.js).length>0&&U("dropping incoming packet of unknown type",e.js,e.sender)}}function j(a,b,c){var d=this;if("object"!=typeof a)return!1;var e=D(d.parts,a);if(!e)return!1;var f=d.whois(H(a));if(!f)return!1;c&&(b=c[e]);var g=M(d,f,e,b);return g?(U("whokey err",f.hashname,g),!1):T.createHash("sha256").update(f.key).digest("hex")!=a[e]?(U("whokey part mismatch",f.hashname,e,a[e],T.createHash("sha256").update(f.key).digest("hex")),delete f.key,!1):(f.parts=a,f)}function k(a){var c=this;if(!a)return U("whois called without a hashname",a,(new Error).stack),!1;if("string"!=typeof a)return U("wrong type, should be string",typeof a,a),!1;if(!y(a,64))return U("whois called without a valid hashname",a),!1;if(a===c.hashname)return V("whois called for self"),!1;var d=c.all[a];if(d)return d;d=c.all[a]={hashname:a,chans:{},self:c,paths:[],isAlive:0,sendwait:[]},d.at=Date.now(),d.bucket=z(c.hashname,a),c.buckets[d.bucket]||(c.buckets[d.bucket]=[]);var e=[c.hashname,a].sort();return d.chanOut=e[0]==c.hashname?2:1,d.start=n,d.raw=m,d.pathGet=function(a){if("object"!=typeof a||"string"!=typeof a.type)return!1;var b=B(a,d.paths);return b?b:(a=JSON.parse(JSON.stringify(a)),a.json||(a.json=JSON.parse(JSON.stringify(a))),V("adding new path",d.paths.length,JSON.stringify(a.json)),W(d.hashname,a.type,JSON.stringify(a.json)),d.paths.push(a),E(a)||(d.isPublic=!0),"ipv4"==a.type&&c.paths.forEach(function(b){"ipv4"==b.type&&b.ip==a.ip&&(d.isLocal=!0)}),a)},d.pathOut=function(a){return(a=d.pathGet(a))?(a.sentAt||"ipv4"!=a.type||c.send(a,I()),a.sentAt=Date.now(),!C(d.to)&&C(a)&&(d.to=a),a):!1},d.pathEnd=function(a){if(a.seed)return!1;d.to==a&&(d.to=!1),a.gone=!0;var b=d.paths.indexOf(a);return b>=0&&d.paths.splice(b,1),V("PATH END",JSON.stringify(a.json)),!1},d.pathIn=function(a){return(a=d.pathGet(a))?(a.recvAt||a.sentAt||(V("PATH INNEW",E(a)?"local":"public",JSON.stringify(a.json),d.paths.map(function(a){return JSON.stringify(a.json)})),"ipv4"!=a.type||F(a.ip)||(d.ip=a.ip,d.port=a.port),d.paths.forEach(function(b){return b!=a&&b.type==a.type?C(b)?a.ip&&b.ip==a.ip?d.pathEnd(b):"http"==a.type?d.pathEnd(b):void 0:d.pathEnd(b):void 0}),-1==Y.indexOf(a.type)&&(d.bridging=!0),E(a)&&!d.isLocal&&(d.isLocal=!0,d.pathSync())),a.recvAt=Date.now(),d.to=a,a):!1},d.active=function(){c.recvAt=Date.now(),(!d.recvAt||Date.now()-d.recvAt>X.nat_timeout)&&setTimeout(function(){d.pathSync()},10),d.recvAt=Date.now(),d.sendwait.forEach(function(a){d.chans[a.js.c]&&d.send(a)}),d.sendwait=[]},d.send=function(a){function e(){if(d.vias){var a=d.vias;delete d.vias,Object.keys(a).forEach(function(b){c.whois(b).peer(d.hashname,a[b])})}}if(b.isBuffer(a)&&console.log("lined packet?!",d.hashname,typeof d.sendwait.length,(new Error).stack),d.lineIn){V("line sending",d.hashname,d.lineIn);var f=c.CSets[d.csid].lineize(d,a);if(d.sentAt=Date.now(),a.to)return c.send(a.to,f,d);if(C(d.to))return c.send(d.to,f,d);if(d.relayChan)return d.relayChan.send({body:f})}return d.openAt=!1,-1==d.sendwait.indexOf(a)&&d.sendwait.push(a),V("alive failthrough",d.sendSeek,Object.keys(d.vias||{})),d.open()&&d.paths.forEach(function(a){c.send(a,d.open(),d)}),d.vias?e():void((!d.sendSeek||Date.now()-d.sendSeek>5e3)&&(d.sendSeek=Date.now(),c.seek(d,function(){d.sendwait.length&&e()})))},d.receive=function(a){if(!a.js||"number"!=typeof a.js.c)return U("dropping invalid channel packet",a.js);a.sender=d.pathIn(a.sender),a.from=d;var b=d.chans[a.js.c];if(V("LINEIN",b&&b.type,JSON.stringify(a.js),a.body&&a.body.length),b!==!1){if(b)return b.receive(a);var e={};if("undefined"==typeof a.js.seq&&(e=c.raws),0===a.js.seq&&(e=c.rels),e[a.js.type]){if(a.js.c%2==d.chanOut%2)return U("channel id incorrect",a.js.c,d.chanOut);var f=e==c.raws?"raw":"start",b=d[f](a.js.type,{bare:!0,id:a.js.c},e[a.js.type]);b.receive(a)}}},d.chanEnded=function(a){d.chans[a]&&(V("channel ended",a,d.chans[a].type,d.hashname),d.chans[a]=!1)},d.sees=function(a){if("string"!=typeof a&&U("invalid see address",a,d.hashname),"string"!=typeof a)return!1;var b=a.split(",");if(!c.isHashname(b[0])||b[0]==c.hashname)return!1;var e=c.whois(b[0]);return e?(b.length>=4&&4==b[2].split(".").length&&parseInt(b[3])>0&&e.pathGet({type:"ipv4",ip:b[2],port:parseInt(b[3])}),e.vias||(e.vias={}),e.vias[d.hashname]=e.cisd||b[1],e):!1},d.seek=function(a,b){var c=z(d.hashname,a),e=a.substr(0,Math.ceil((255-c)/4)+2);d.raw("seek",{timeout:X.seek_timeout,retry:3,js:{seek:e}},function(a,c){b(c.js.err,Array.isArray(c.js.see)?c.js.see:[])})},d.address=function(a){if(!a)return"";var b=D(d.parts,a.parts);return b?d.ip?[d.hashname,b,d.ip,d.port].join(","):[d.hashname,b].join(","):""},d.link=function(a){a||(a=function(){}),V("LINKTRY",d.hashname);var b={seed:c.seed};return b.see=c.buckets[d.bucket].sort(function(a,b){return a.age-b.age}).filter(function(a){return a.seed}).map(function(a){return a.address(d)}).slice(0,8),b.see.length<8&&Object.keys(c.buckets).forEach(function(a){b.see.length>=8||c.buckets[a].sort(function(a,b){return a.age-b.age}).forEach(function(a){b.see.length>=8||!a.seed||-1!=b.see.indexOf(a.address(d))||b.see.push(a.address(d))})}),c.isBridge(d)&&(b.bridges=c.paths.filter(function(a){return!E(a)}).map(function(a){return a.type})),d.linked?(d.linked.send({js:b}),a()):void(d.linked=d.raw("link",{retry:3,js:b,timeout:X.idle_timeout},function(b,c,d){t(b,c,d),a(c.js.err)}))},d.peer=function(a,b){if(b&&c.parts[b]){var e={peer:a};e.paths=d.pathsOut(),d.raw("peer",{timeout:X.nat_timeout,js:e,body:K(c,b)},function(b,d,e){e.relayTo||(e.relayTo=c.whois(a)),o(e,d)})}},d.open=function(){return d.parts?(d.opened||(d.opened=Q(c,d)),d.opened):!1},d.pathsOut=function(){var a=[];return c.paths.forEach(function(b){(!E(b)||d.isLocal)&&a.push(b)}),a},d.pathSync=function(){if(!d.pathSyncing){d.pathSyncing=!0,V("pathSync",d.hashname);var a={},b=d.pathsOut();b.length>0&&(a.paths=b);var e=[];d.raw("path",{js:a,timeout:1e4},function(a,b){if(a)return void(d.pathSyncing=!1);if(b.from.isSeed&&"object"==typeof b.js.path&&"ipv4"==b.js.path.type&&!F(b.js.path.ip)&&(V("updating public ipv4",JSON.stringify(c.pub4),JSON.stringify(b.js.path)),c.pathSet(c.pub4,!0),c.pub4={type:"ipv4",ip:b.js.path.ip,port:parseInt(b.js.path.port)},c.pathSet(c.pub4)),b.sender){e.push(b.sender);var f=b.sender;e.forEach(function(a){Y.indexOf(f.type)<Y.indexOf(a.type)||E(f)||(f=a)}),V("pathSync best",d.hashname,JSON.stringify(f.json)),d.to=f}})}},d.ticket=function(a){return c.pencode(a).length>1024?!1:O(c,d,a)},d.ticketed=function(a){return packet=J(a),packet?P(c,d,packet):!1},d}function l(a,b){function c(){i=i.sort(function(b,c){return z(a.hashname,b)-z(a.hashname,c)})}function d(b){for(Object.keys(g).forEach(function(a){-1==i.indexOf(a)&&i.push(a)}),Object.keys(h).forEach(function(a){-1==i.indexOf(a)&&i.push(a)}),c();cb=a.seeking.shift();)cb(b,i.slice())}function e(b){if(a.seeking.length){if(V("SEEK LOOP",i),0==Object.keys(h).length&&0==i.length)return d("failed to find the hashname");var l=b||i.shift();if(l){if(l==a.hashname)return d();if(g[l]||h[l])return b||e();var m=z(a.hashname,l);if(m>k)return b||e();j[l]&&(k=m),h[l]=!0;var n=f.whois(l);n.seek(a.hashname,function(a,d){d.forEach(function(a){var b=n.sees(a);b&&(j[n.hashname]&&0==d.indexOf(a)&&(j[b.hashname]=!0),i.push(b.hashname))}),c(),g[l]=!0,delete h[l],b||e()})}}}var f=this;if("string"==typeof a&&(a=f.whois(a)),b||(b=function(){}),!a)return b("invalid hashname");var g={},h={},i=[],j={},k=255,l=[];Object.keys(f.buckets).forEach(function(b){f.buckets[b].forEach(function(b){b.hashname!=a&&b.seed&&C(b.to)&&l.push(b)})}),l.sort(function(b,c){return z(a.hashname,b.hashname)-z(a.hashname,c.hashname)}).slice(0,3).forEach(function(a){j[a.hashname]=!0,i.push(a.hashname)}),V("seek starting with",i,l.length),a.seeking||(a.seeking=[]),a.seeking.push(b),a.seeking.length>1||(e(),e(),e(),f.locals.forEach(function(a){e(a.hashname)}))}function m(a,b,c){function d(){g.timer&&clearTimeout(g.timer),g.timer=setTimeout(function(){return g.ended?void f.chanEnded(g.id):f.receive({js:{err:"timeout",c:g.id}})},b.timeout)}function e(){g.ended||g.opened||(g.send(b),4e3>h&&(h*=2),b.retry--,b.retry&&setTimeout(e,h))}var f=this,g={type:a,callback:c};if(g.id=b.id,g.startAt=Date.now(),g.id||(g.id=f.chanOut,f.chanOut+=2),g.isOut=g.id%2==f.chanOut%2,f.chans[g.id]=g,g.timeout=function(a){b.timeout=a,d()},g.timeout(b.timeout||X.chan_timeout),g.hashname=f.hashname,V("new unreliable channel",f.hashname,g.type,g.id),g.receive=function(a){return f.chans[g.id]?(g.opened=!0,g.ended=g.ended||a.js.err||a.js.end,g.recvAt=Date.now(),g.last=a.sender,g.callback(g.ended,a,g),void d()):V("dropping receive packet to dead channel",g.id,a.js)},g.send=function(a){return f.chans[g.id]?(a.js||(a.js={}),a.js.c=g.id,g.ended=g.ended||a.js.err||a.js.end,g.sentAt=Date.now(),V("SEND",g.type,JSON.stringify(a.js),a.body&&a.body.length),void f.send(a)):V("dropping send packet to dead channel",g.id,a.js)},g.end=function(){g.ended||g.send({js:{end:!0}})},g.fail=function(a){g.ended||(g.ended=a||"failed",f.send({js:{err:g.ended,c:g.id}}))},b.js&&(b.js.type=a,g.send(b),b.retry)){var h=1e3;setTimeout(e,h)}return g}function n(a,b,c){function d(){f.timer&&clearTimeout(f.timer),f.timer=setTimeout(function(){f.ended=f.ended||!0,e.chanEnded(f.id)},b.timeout)}var e=this,f={inq:[],outq:[],outSeq:0,inDone:-1,outConfirmed:-1,lastAck:-1,callback:c};return f.id=b.id,f.startAt=Date.now(),f.id||(f.id=e.chanOut,e.chanOut+=2),f.isOut=f.id%2==e.chanOut%2,e.chans[f.id]=f,b.bare||"_"===a.substr(0,1)||(a="_"+a),f.type=a,"_"!=f.type.substr(0,1)&&(f.safe=!0),f.hashname=e.hashname,V("new channel",e.hashname,f.type,f.id),f.timeout=function(a){b.timeout=a
},f.timeout(b.timeout||X.chan_timeout),f.wrap=function(a){return Z[a]?Z[a](f):!1},f.receive=function(a){if(a.js.err)return f.inq=[],f.ended=a.js.err,f.callback(a.js.err,a,f,function(){}),void d();f.recvAt=Date.now(),f.opened=!0,f.last=a.sender;var b=parseInt(a.js.ack);if(b>f.outSeq)return U("bad ack, dropping entirely",f.outSeq,b);var c=Array.isArray(a.js.miss)?a.js.miss:[];if(c.length>100&&(U("too many misses",c.length,f.id,a.from.hashname),c=c.slice(0,100)),c.length>0||b>f.lastAck){V("miss processing",b,f.lastAck,c,f.outq.length),f.lastAck=b;var e=f.outq;f.outq=[],e.forEach(function(a){return a.js.seq<=b?(a.callback&&a.callback(),void(a.js.end&&d())):(f.outq.push(a),void(-1!=c.indexOf(a.js.seq)&&(Date.now()-a.resentAt<1e3||(a.resentAt=Date.now(),f.ack(a)))))})}var g=a.js.seq;if(g>=0){if(f.acker||(f.acker=setTimeout(function(){delete f.acker,f.ack()},X.chan_autoack)),g<=f.inDone||f.inq[g-(f.inDone+1)])return f.forceAck=!0;if(g-f.inDone>X.chan_inbuf)return U("chan too far behind, dropping",g,f.inDone,f.id,a.from.hashname),f.forceAck=!0;f.inq[g-(f.inDone+1)]=a,V("INQ",Object.keys(f.inq),f.inDone,f.handling),f.handler()}},f.handler=function(){if(!f.handling){var a=f.inq[0];!a&&f.inq.length>0&&(f.forceAck=!0),a&&(f.handling=!0,f.ended=f.ended||a.js.end,f.safe||(a.js=a.js._||{}),f.callback(f.ended,a,f,function(a){f.inq.shift(),f.inDone++,f.handling=!1,a&&f.ack(),f.ended&&d(),f.handler()}))}},f.resend=function(){if(!f.ended&&f.outq.length){var a=f.outq[f.outq.length-1];if(Date.now()-a.sentAt>b.timeout)return void e.receive({js:{err:"timeout",c:f.id}});V("channel resending"),f.ack(a),setTimeout(function(){f.resend()},X.chan_resend)}},f.ack=function(a){if(a||V("ACK CHECK",f.id,f.outConfirmed,f.inDone),!a){if(!f.forceAck&&f.outConfirmed==f.inDone)return;a={js:{}}}if(f.forceAck=!1,f.inDone>=0&&(f.outConfirmed=a.js.ack=f.inDone),delete a.js.miss,f.inq.length>0){a.js.miss=[];for(var b=0;b<f.inq.length;b++)f.inq[b]||a.js.miss.push(f.inDone+b+1)}a.js.c=f.id,V("SEND",f.type,JSON.stringify(a.js)),d(),e.send(a)},f.send=function(a){if(a||(a={}),a.err){if(f.ended)return;return f.ended=a.err,e.send({js:{err:a.err,c:f.id}}),d()}var b={};return b.js=f.safe?a.js:{_:a.js},a.type&&(b.js.type=a.type),a.end&&(b.js.end=a.end),b.body=a.body,b.callback=a.callback,b.js.seq=f.outSeq++,b.sentAt=Date.now(),f.outq.push(b),f.ack(b),f.resender&&clearTimeout(f.resender),f.resender=setTimeout(function(){f.resend()},X.chan_resend),f},f.end=function(){return f.ended?f.ack():void f.send({js:{end:!0}})},f.fail=function(a){var b="failed";"string"==typeof a&&(b=a),"object"==typeof a&&a.js&&a.js.err&&(b=a.js.err),f.send({err:b})},b.js&&(b.type=a,f.send(b)),f}function o(a,b){var c=a.relayTo,d=b.from.self;if((b.js.err||b.js.warn)&&!a.migrating&&c.relayChan==a&&!c.to){V("relay failing, trying to migrate",c.hashname),a.migrating=!0;var e=[];c.paths.forEach(function(a){d.bridges[a.type]&&Object.keys(d.bridges[a.type]).forEach(function(a){-1==e.indexOf(a)&&e.push(a)})});var f;e.forEach(function(a){if(!f&&a!=c.hashname&&a!=b.from.hashname){var e=d.whois(a);C(e.to)&&(f=e.peer(c.hashname,c.csid))}})}if(b.js.err||b.js.end)return V("ending relay from",a.hashname,"to",c.hashname,b.js.err||b.js.end),void(c.relayChan==a&&(c.relayChan=!1));c.to&&c.to.recvAt<a.startAt&&(c.to=!1),c.relayChan=a;var g=b.js.bridge?JSON.parse(JSON.stringify(b.sender.json)):!1;b.body&&b.body.length&&d.receive(b.body,g),c.pathSync()}function p(a,b,c){if(c.relayTo)return o(c,b);var d=c.relayTo=b.from.self.whokey(b.js.from,b.body);return c.relayTo?(c.timeout(X.nat_timeout),Array.isArray(b.js.paths)&&b.js.paths.forEach(function(a){return"string"!=typeof a.type?V("bad path",JSON.stringify(a)):void b.from.self.send(a,d.open(),d)}),c.send({body:d.open()}),void b.from.sees(d.hashname)):U("invalid connect request from",b.from.hashname,b.js)}function q(a,b,c,d){if(b.ended&&!c.ended)return c.send({js:{err:"disconnected"}});if(c.ended&&!b.ended)return b.send({js:{err:"disconnected"}});var e={};if(a.isBridge(b.hashname)||a.isBridge(c.hashname)){var f=J(d.body),g=f&&f.body&&f.body.length>16&&f.body.slice(0,16).toString("hex");g&&0==f.head.length&&!c.bridged&&c.last&&!a.lines[g]&&(c.bridged=!0,V("auto-bridging",c.hashname,g,JSON.stringify(c.last.json)),a.bridgeLine[g]=JSON.parse(JSON.stringify(c.last.json)))}b.bridged&&c.bridged&&(e={bridge:!0}),(!b.relayed||Date.now()-b.relayed>1e3)&&(b.relayed=Date.now(),b.relays=0),b.relays++,b.relays>5&&(V("relay too fast, warning",b.relays),e.warn="toofast"),b.relayed=Date.now(),c.send({js:e,body:d.body})}function r(a,b,c){if(!a){var d=b.from.self;if(c.relay)return q(d,c,c.relay,b);if(y(b.js.peer,64)){var e=d.whois(b.js.peer);if(e){if(!(C(e.to)||d.isBridge(b.from.hashname)||d.isBridge(e.hashname)))return V("disconnected peer request");Array.isArray(b.js.paths)||(b.js.paths=[]),b.from.paths.forEach(function(a){a.recvAt&&-1!=Y.indexOf(a.type)&&(!E(a)||e.isLocal)&&b.js.paths.push(a.json)});var f={from:b.from.parts,paths:[]};b.js.paths.forEach(function(a){"string"==typeof a.type&&(B(a,f.paths)||f.paths.push(a))}),c.timeout(X.nat_timeout),c.relay=e.raw("connect",{js:f,body:b.body},function(a,b,e){a||q(d,e,c,b)})}}}}function s(a,b,c){if(!a){if(!y(b.js.seek))return U("invalid seek of ",b.js.seek,"from:",b.from.hashname);var d=b.from.self,e=b.js.seek,f=[],g={},h=z(d.hashname,b.js.seek),i=d.buckets[h]?d.buckets[h]:[];i.sort(function(a,b){return a.age-b.age}).forEach(function(a){f.length||a.seed&&(f.push(a.address(b.from)),g[a.hashname]=!0)}),i.sort(function(a,b){return z(e,a.hashname)-z(e,b.hashname)}).forEach(function(a){g[a.hashname]||(a.seed||a.hashname.substr(0,e.length)==e)&&(f.push(a.address(b.from)),g[a.hashname]=!0)});var j={end:!0,see:f.filter(function(a){return a}).slice(0,8)};c.send({js:j})}}function t(a,b,c){if(!a){var d=b.from.self;c.timeout(2*X.nat_timeout),V("LINKUP",b.from.hashname),b.from.age||(b.from.age=Date.now()),b.from.linked=c,b.from.seed=b.js.seed,-1==d.buckets[b.from.bucket].indexOf(b.from)&&d.buckets[b.from.bucket].push(b.from),b.from.seed&&b.from.isLocal&&-1==d.locals.indexOf(b.from)&&d.locals.push(b.from),c.sentAt||b.from.link(),Array.isArray(b.js.see)&&b.js.see.forEach(function(a){var c=b.from.sees(a);c&&!c.linked&&d.buckets[c.bucket].length<X.link_k&&c.link()}),Array.isArray(b.js.bridges)&&b.js.bridges.forEach(function(a){d.bridges[a]||(d.bridges[a]={}),d.bridges[a][b.from.hashname]=Date.now()}),c.callback=u}}function u(a,b,c){if(b.from&&b.from.linked&&b.from.linked==c){var d=b.from.self;if(a){V("LINKDOWN",b.from.hashname,a),delete b.from.linked;var e=d.buckets[b.from.bucket].indexOf(b.from);return e>-1&&d.buckets[b.from.bucket].splice(e,1),void(c.recvAt&&b.from.link())}b.from.seed=b.js.seed,Date.now()-c.sentAt>Math.ceil(X.link_timer/2)&&c.send({js:{seed:d.seed}})}}function v(a,b,c){if(!a){{b.from.self}Array.isArray(b.js.paths)&&b.js.paths.forEach(function(a){b.from.pathGet(a)}),b.from.paths.forEach(function(a){var b={};Y.indexOf(a.type)>=0&&(b.path=a.json),c.send({js:b,to:a})})}}function w(a,b){if(b.js.trace!=a.tracer&&!(a.locals.length>1||a.lanSkip&&a.lanSkip==b.js.trace)){V("PING-PONG",b.js,b.sender),a.lanSkip=b.js.trace;var c=D(a.parts,b.js);if(c){var d={type:"pong",from:a.parts,trace:b.js.trace};a.send(b.sender,I(d,K(a,c)))}}}function x(a,b){if(V("PONG",JSON.stringify(b.js),JSON.stringify(b.sender)),b.js.trace==a.tracer){if(a.locals.length>=5)return U("locals full");if(b.body&&0!=b.body.length){var c=a.whokey(b.js.from,b.body);if(!c)return U("invalid lan request from",b.js.from,b.sender);c.local=!0,V("local seed open",c.hashname,JSON.stringify(b.sender)),a.send(b.sender,c.open(),c),c.link()}}}function y(a,b){return"string"!=typeof a?!1:b&&a.length!==b?!1:0!==a.replace(/[a-f0-9]+/i,"").length?!1:!0}function z(a,b){var c=A(a),d=A(b);if(!c.length||!d.length)return-1;for(var e=[-1,0,1,1,2,2,2,2,3,3,3,3,3,3,3,3],f=252,g=0;g<c.length;g++){if(!d[g])return f;var h=c[g]^d[g];if(h)return f+e[h];f-=4}return f}function A(a){for(var b=[],c=0;c<a.length/2;c++){var d=parseInt(a.substr(2*c,2),16);if(isNaN(d))return[];b[b.length]=d>>4,b[b.length]=15&d}return b}function B(a,b){var c;return a&&Array.isArray(b)?(b.forEach(function(b){if(b&&b.type==a.type)switch(a.type){case"ipv4":case"ipv6":a.ip==b.ip&&a.port==b.port&&(c=b);break;case"http":a.http==b.http&&(c=b);break;default:a.id===b.id&&(c=b)}}),c):c}function C(a){return!a||a.gone?!1:a.recvAt&&Date.now()-a.recvAt<X.nat_timeout?!0:!1}function D(a,b){if("object"!=typeof a||"object"!=typeof b)return!1;for(var c,d=Object.keys(a).sort();c=d.pop();)if(b[c])return c;return!1}function E(b){return b&&b.type?"bluetooth"==b.type?!0:"http"==b.type&&"string"==typeof b.http?F(a("url").parse(b.http).hostname):["ipv4","ipv6"].indexOf(b.type)>=0?F(b.ip):!1:!1}function F(a){if(a.indexOf(":")>=0)return 0==a.indexOf("::")?!0:0==a.indexOf("fc00")?!0:0==a.indexOf("fe80")?!0:!1;var b=a.split(".");return"0"==b[0]?!0:"127"==b[0]?!0:"10"==b[0]?!0:"192"==b[0]&&"168"==b[1]?!0:"172"==b[0]&&b[1]>=16&&b[1]<=31?!0:"169"==b[0]&&"254"==b[1]?!0:!1}function G(a){return T.randomBytes(a).toString("hex")}function H(a){var c=new b(0);return Object.keys(a).sort().forEach(function(d){c=T.createHash("sha256").update(b.concat([c,new b(d)])).digest(),c=T.createHash("sha256").update(b.concat([c,new b(a[d])])).digest()}),c.toString("hex")}function I(a,c){!c&&a&&a.js&&(c=a.body,a=a.js);var d="number"==typeof a?new b(String.fromCharCode(a)):new b(a?JSON.stringify(a):"","utf8");"string"==typeof c&&(c=new b(c,"binary")),c=c||new b(0);var e=new b(2);return e.writeInt16BE(d.length,0),b.concat([e,d,c])}function J(a){if(!a)return void 0;var c="string"==typeof a?new b(a,"binary"):a;if(a.length<2)return void 0;var d=c.readUInt16BE(0);if(d>c.length-2)return void 0;var e=c.slice(2,d+2),f=c.slice(d+2),g={};if(d>1)try{g=JSON.parse(e.toString("utf8"))}catch(h){return void console.log("couldn't parse JS",c.toString("hex"),h)}return{js:g,length:c.length,head:e.toString("binary"),body:f}}function K(a,b){return a.cs&&a.cs[b]&&a.cs[b].key}function L(a){a.cs={},a.keys={},a.parts={};var b=!1;return Object.keys(a.id).forEach(function(c){2==c.length&&(a.cs[c]={},a.CSets[c]||(b=c+" not supported"),b=b||a.CSets[c].loadkey(a.cs[c],a.id[c],a.id[c+"_secret"]),a.keys[c]=a.id[c],a.parts[c]=T.createHash("sha256").update(a.cs[c].key).digest("hex"))}),b}function M(a,b,c,d){return b.csid=c,a.CSets[c].loadkey(b,d)}function N(a,b){function c(g){if(g)return a(g);var h=f.pop();return h?void d.CSets[h].genkey(e,c,b):(d.load(e),a(null,e))}var d=this,e={},f=Object.keys(d.CSets);return 0==f.length?a("no sets supported"):void c()}function O(a,b,c){if(!b.csid)return console.log("can't ticket w/ no key"),!1;var d={};return a.CSets[b.csid].loadkey(d,b.key),a.CSets[b.csid].openize(a,d,I(c))}function P(a,b,c){var d,e=c.head.charCodeAt().toString(16);if(a.CSets[e]&&e==b.csid){c.from=b;try{d=a.CSets[e].deopenize(a,c)}catch(f){d={err:f}}}else d={err:"invalid CSID of "+e};return d.err||!d.inner?(V("deticketize failed",d.err),!1):d.inner}function Q(a,b){if(!b.csid)return void console.log("can't open w/ no key");b.lineOut||(b.lineOut=G(16)),b.lineAt||(b.lineAt=Date.now());var c={};return c.at=b.lineAt,c.to=b.hashname,c.from=a.parts,c.line=b.lineOut,a.CSets[b.csid].openize(a,b,c)}function R(a,b){var c,d=b.head.charCodeAt().toString(16);if(!a.CSets[d])return{err:"unknown CSID of "+d};try{c=a.CSets[d].deopenize(a,b)}catch(e){return{err:e}}return c.csid=d,c}function S(a){"string"!=typeof a&&(a="");var b=a.match(/[0-9A-Fa-f]{64}/);if(!b)return $.parse(a);var c=b[0],d=c.substr(0,32),e=$.parse(a.replace(c,d));return e.hostname!=d?$.parse(a):(Object.keys(e).forEach(function(a){"string"==typeof e[a]&&(e[a]=e[a].replace(d,c))}),e)}var T=a("crypto"),U=function(){return void console.log.apply(console,arguments)},V=function(){};c.debug=function(a){V=a};var W=function(){};c.info=function(a){W=a};var X=c.defaults={};X.chan_timeout=1e4,X.seek_timeout=3e3,X.chan_autoack=1e3,X.chan_resend=2e3,X.chan_outbuf=100,X.chan_inbuf=50,X.nat_timeout=3e4,X.idle_timeout=2*X.nat_timeout,X.link_timer=X.nat_timeout-5e3,X.link_max=256,X.link_k=8;var Y=["bluetooth","webrtc","ipv6","ipv4","http"];c.switch=function(){var a={seeds:[],locals:[],lines:{},bridges:{},bridgeLine:{},all:{},buckets:[],capacity:[],rels:{},raws:{},paths:[],bridgeCache:{},networks:{},CSets:{}};return a.load=function(b){if("object"!=typeof b)return"bad keys";a.id=b;var c=L(a);return c?c:0==Object.keys(a.cs).length?"missing cipher sets":(a.hashname=H(a.parts),!1)},a.make=N,a.seed=!0,a.pcounter=1,a.receive=i,a.deliver=function(b,c){a.networks[b]=c},a.send=function(b,c,d){return c?b?a.networks[b.type]?(d&&(b=d.pathOut(b)),V("<<<<",Date(),c.length,b&&[b.type,b.ip,b.port,b.id].join(","),d&&d.hashname),a.networks[b.type](b,c,d)):!1:V("send called w/ no path, dropping",(new Error).stack)&&!1:V("send called w/ no packet, dropping",(new Error).stack)&&!1},a.pathSet=function(b,c){var d;if(b){if(d=B(b,a.paths))return void(c&&a.paths.splice(a.paths.indexOf(d),1));V("local path add",JSON.stringify(b)),W("self",b.type,JSON.stringify(b)),a.paths.push(b),a.isOnline&&e(a)}},a.addSeed=g,a.whois=k,a.whokey=j,a.start=function(b,c,d,e){var f=a.whois(b);return f?f.start(c,d,e):e("invalid hashname")},a.online=h,a.listen=function(b,c){return"string"!=typeof b||"function"!=typeof c?U("invalid arguments to listen"):("_"!==b.substr(0,1)&&(b="_"+b),void(a.rels[b]=c))},a.raw=function(b,c){return"string"!=typeof b||"function"!=typeof c?U("invalid arguments to raw"):void(a.raws[b]=c)},a.raws.peer=r,a.raws.connect=p,a.raws.seek=s,a.raws.path=v,a.raws.link=t,a.seek=l,a.pencode=I,a.pdecode=J,a.isLocalIP=F,a.randomHEX=G,a.uriparse=S,a.pathMatch=B,a.isHashname=function(a){return y(a,64)},a.isBridge=f,a.wraps=Z,a.waits=[],a.waiting=!1,a.wait=function(b){return b?a.waits.push(!0):(a.waits.pop(),void(a.waiting&&0==a.waits.length&&a.waiting()))},a.ping=function(){a.tracer||(a.tracer=G(16));var b={type:"ping",trace:a.tracer};return Object.keys(a.parts).forEach(function(a){b[a]=!0}),b},d(a),a};var Z={bulk:function(a){var b="";a.callback=function(a,c,d,e){e(),c.body&&(b+=c.body),d.onBulk&&a&&d.onBulk(a!==!0?a:!1,b)},a.bulk=function(b,c){for(;b;){var d=b.substr(0,1e3);b=b.substr(1e3);var e={body:d};b||(e.callback=c),a.send(e)}a.end()}}},$=a("url")}).call(this,a("buffer").Buffer)},{buffer:29,crypto:35,url:70}],21:[function(a,b,c){c.json=a("./seeds.json"),c.install=function(b,d){var e=c.json;d&&d.seeds&&("string"==typeof d.seeds&&(e=a(d.seeds)),"object"==typeof d.seeds&&(e=d.seeds)),Object.keys(e).forEach(function(a){b.addSeed(e[a])})}},{"./seeds.json":22}],22:[function(a,b){b.exports={"5c63d7fb6a101471f15064ed05141b342cce9f3bebeb1616d8fc83dab35e61d5":{paths:[{type:"http",http:"http://azure.lewisl.net:42424"},{type:"ipv4",ip:"23.100.21.191",port:42424}],parts:{"2a":"8cb716b34f138d72d32ba1d79cab4bb0d713bc3b959936b2273be29a15d9e437","1a":"0360efab9c139a9e6cd49b945ce93efef3f39b7f0238bb5e087ea0ed4b935835"},keys:{"2a":"MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAxlm1hU1Oks9sHFbAiwevgjwirVmyEjxNmMUNV3lZZrejk3K0J59AOpt4ohEsGzySIumALLGpDSX+HAiuvEQF1PQnZW1kqtaGyiHymQH0V56FN5RYzpBXIOkE+eel2Ge3WhIGDP7v2jg6rIL3h0b+H9fbX3ixfPQC0NE796wB2xu5thX7ylM3DSFfcFUGh3P1WDXgejluAsw8AzSC1GjvH+Bw0gtNA7aFHiyrxhvAc5EEaeBQbbdBBANsb41ToWjhnFdgWEZUHFGVXdh0WyHDMNiSp+9JMHpbgb/zct+dVCGMK5HEDB05nPRadLkSbQIUUQLxEYUVC+Yvfangi0NSwQIDAQAB","1a":"PK+9AzIMgPMTD+rr8v1Oct2KYRslcr3nNznM7jZgWmDneqSFfqI50Q=="}}}},{}],23:[function(a,b,c){(function(b){c.install=function(c){c.sock=function(a){if(c.isHashname(a)&&(a={to:a}),"object"!=typeof a)return console.log("invalid args")&&!1;var b=c.whois(a.to);if(!b)return console.log("invalid to hashname",a.to)&&!1;delete a.to;var d=b.start("sock",{bare:!0,js:a});return d.wrap("stream")},c.onSock=function(a){c.rels.sock=function(b,c,d,e){b||(e(),a(d.wrap("stream")))}},c.wraps.stream=function(c){var d=new a("stream").Duplex();d.on("finish",function(){c.send({js:{end:!0}})}),d.on("error",function(a){c.fail({js:{err:a}})}),d._write=function(a,b,e){if(c.ended)return e("closed");for(;a.length;){var f=a.slice(0,1e3);a=a.slice(1e3);var g={js:{},body:f};a.length||(g.callback=e,d.ended&&(g.js.end=!0)),c.send(g)}},d.end=function(a){d.ended=!0,a||(a=new b(0)),d.write(a)};var e=!1;return d._read=function(){e&&e(),e=!1},c.callback=function(a,b,c,f){b.body&&(d.push(b.body)||(e=f)),a&&d.push(null),e||f()},d}}}).call(this,a("buffer").Buffer)},{buffer:29}],24:[function(a,b,c){c.install=function(a){a.TSockets={},a.socket=function(b,c){if("string"!=typeof b)return warn("invalid TS uri")&&!1;if(0==b.indexOf("ts://")){var d=b.substr(5).split("/"),e=a.whois(d.shift());if(!e)return warn("invalid TS hashname")&&!1;var f=d.join("/");f||(f="/");var g=e.start("ts",{bare:!0,js:{path:f}});return g.wrap("TS"),g.socket}return 0!=b.indexOf("/")?warn("invalid TS listening uri")&&!1:void(a.TSockets[b]=c)},a.rels.ts=function(a,b,c,d){if(!a){var e=b.from.self;if(d(),"string"!=typeof b.js.path||!e.TSockets[b.js.path])return c.err("unknown path");c.wrap("TS"),e.TSockets[b.js.path](c.socket),c.send({js:{open:!0}})}},a.wraps.TS=function(a){return a.socket={data:"",hashname:a.hashname,id:a.id},a.callback=function(a,b,c,d){c.socket.readyState=1,c.socket.onopen&&(c.socket.onopen(),delete c.socket.onopen),b.body&&(c.socket.data+=b.body),b.js.done?c.socket.onmessageack?c.socket.onmessageack(c.socket,d):(c.socket.onmessage&&c.socket.onmessage(c.socket),c.socket.data="",d()):d(),a&&(c.socket.readyState=2,1!=a&&c.socket.onerror&&c.socket.onerror(a),c.socket.onclose&&c.socket.onclose())},a.socket.readyState=a.lastIn?1:0,a.socket.send=function(b,c){if(1!=a.socket.readyState)return console.log("sending fail to TS readyState",a.socket.readyState)&&!1;for(;b;){var d=b.substr(0,1e3);b=b.substr(1e3);var e={js:{},body:d};b||(e.callback=c,e.js.done=!0),a.send(e)}},a.socket.close=function(){a.socket.readyState=2,a.done()},a.socket}}},{}],25:[function(a,b,c){(function(b){function d(a,b){b(a);var c=f.Readable();return c._read=function(){},c.emit("end"),c}function e(a){var c=f.Duplex();return c._read=function(){},c.on("finish",function(){a.send({js:{end:!0}})}),c._write=function(b,d,e){for(;b.length;){var f=b.slice(0,1e3);b=b.slice(1e3);var g={js:{},body:f};b.length||(g.callback=e,c.ended&&(g.js.end=!0)),a.send(g)}},c.end=function(a){c.ended=!0,a||(a=new b(0)),c.write(a)},c}var f=a("stream"),g=(a("url"),a("http"));c.install=function(a){a.thtp={},a.thtp.request=function(c,f){if(f||(f=function(){}),"string"==typeof c&&(c={uri:c}),"object"!=typeof c||!(c.uri||c.url||c.hashname))return d("invalid args",f);c.hashname&&(c.uri="thtp://"+c.hashname+c.path);var g=a.uriparse(c.uri||c.url);if("thtp:"!=g.protocol)return d("invalid protocol "+g.protocol,f);if(g.hostname==a.hashname)return d("can't request self",f);var h;if(!(h=a.whois(g.hostname)))return d("invalid hashname",f);var i={};"object"==typeof c.headers&&Object.keys(c.headers).forEach(function(a){i[a.toLowerCase()]=c.headers[a].toString()}),c.body&&(i["content-length"]=c.body.length.toString()),i.method=c.method||"get",i.path=g.path;var j=a.pencode(i,c.body);i={},j.length<=1e3&&(i.end=!0);var k=new b(0),l=e(h.start("thtp",{bare:!0,js:i,body:j.slice(0,1e3)},function(c,d,e,g){if(g(!0),l.headers)return l.push(d.body),void(c&&l.emit("end"));d.body&&(k=b.concat([k,d.body]));var h;return(h=a.pdecode(k))?(l.status=parseInt(h.js.status)||500,l.headers=h.js,f(l.status>=300?l.status.toString():!1,l),h.body&&l.push(h.body),void(c&&l.emit("end"))):void(c&&f(500,l))}));return j.length>1e3&&l.end(j.slice(1e3)),l},a.thtp.listen=function(c){a.rels.thtp=function(f,g,h,i){var j,k=new b(0);h.callback=function(f,g,h,i){return i(!0),j?(g.body&&j.push(g.body),void(f&&j.emit("end"))):(k=b.concat([k,g.body]),(http=a.pdecode(k))?"string"!=typeof http.js.method||"string"!=typeof http.js.path?h.err("invalid"):(j=e(h),j.method=http.js.method,j.path=http.js.path,delete http.js.method,delete http.js.path,j.headers=http.js,c(j,function(b){if(b||(b={}),b.err)return d(f,h.err);var c={};"object"==typeof b.headers&&Object.keys(b.headers).forEach(function(a){c[a.toLowerCase()]=b.headers[a].toString()}),c.status=b.status||200,b.json&&(b.body=JSON.stringify(b.json)),b.body&&(c["content-length"]=b.body.length.toString());var e=a.pencode(c,b.body),c={};return b.body&&e.length<=1e3&&(c.end=!0),h.send({js:c,body:e.slice(0,1e3)}),e.length>1e3&&j.write(e.slice(1e3)),j}),http.body&&j.push(http.body),void(f&&j.emit("end"))):void(f&&h.end()))},h.callback(f,g,h,i)}};var c={};a.thtp.match=function(b,d){var e=a.uriparse(b).pathname;c[e]=d,Object.keys(c).length>1||a.thtp.listen(function(a,b){var d;return Object.keys(c).forEach(function(b){0==a.path.indexOf(b)&&(d&&d.length>b||(d=b))}),d?c[d](a,b):void b({status:404,body:"not found"})})},a.thtp.proxy=function(b){"0.0.0.0"==b.address&&(b.address="127.0.0.1"),a.thtp.listen(function(a,c){var d={host:b.address,port:b.port,headers:a.headers,method:a.method,path:a.path};a.pipe(g.request(d,function(a){a.pipe(c({status:a.statusCode,headers:a.headers}))}))})}}}).call(this,a("buffer").Buffer)},{buffer:29,http:46,stream:69,url:70}],26:[function(a,b,c){(function(b){var d=a("crypto");c.install=function(a){var c={};a.token=function(e,f){if("function"==typeof e&&(f=e,e=!1),!e){var g=new b(a.hashname,"hex"),h=new b(a.randomHEX(8),"hex"),i=d.createHash("sha256").update(b.concat([g,h])).digest();e=b.concat([g.slice(0,16),h,i.slice(0,8)]).toString("hex")}return f&&(c[e]=f),e},a.raws.token=function(a,b,d){if(!a){var e=b.from.self;return e.isHashname(b.js.token)?c[b.js.token]?(c[b.js.token](b.from),d.send({js:{end:!0}})):e.tokens?void e.tokens(b.js.token,b.from,function(a){a&&d.err(a),can.send({js:{end:!0}})}):d.err("unknown"):d.err("invalid")}},a.dispense=function(c,e){a.seek(c,function(f,g){if(!Array.isArray(g))return e(f||"not found");var h;return g.forEach(function(a){if(a.substr(0,32)==c.substr(0,32)){var e=new b(a,"hex"),f=new b(c.substr(32,16),"hex"),g=d.createHash("sha256").update(b.concat([e,f])).digest();token2=b.concat([e.slice(0,16),f,g.slice(0,8)]).toString("hex"),c==token2&&(h=a)}}),h&&(h=a.whois(h))?void h.raw("token",{js:{token:c},retries:3},function(a){e(a!==!0?a:!1,h)}):e("not found")})}}}).call(this,a("buffer").Buffer)},{buffer:29,crypto:35}],27:[function(a,b,c){(function(b){var d=a("webrtc-peer");c.install=function(a){function c(c,g,h){g.wrap("TS"),f[h]=g;var i;g.socket.onopen=function(){i=new d.peer({initiate:c,_self:"self",_peer:h}),i.DEBUG=!0,i.onsignal=function(a){console.log("RTC OUT",a),g.socket.send(JSON.stringify(a))},i.onconnection=function(){console.log("RTC CONNECTED"),e[h]=i,g.cached&&i.send(g.cached)},i.onmessage=function(c){a.receive(new b(c,"base64"),{type:"webrtc"})}},g.socket.onmessage=function(a){console.log("RTC IN",a);try{a=JSON.parse(a.data)}catch(b){return console.log("rtc parse error",b,a.data)}i.signal(a)}}if(!d.hasWebRTC)return!1;a.pathSet({type:"webrtc"});var e={},f={};a.deliver("webrtc",function(a,b,d){var g=b.toString("base64");if(e[d.hashname])return e[d.hashname].send(g);if(f[d.hashname])return f[d.hashname].cached=g;var h=d.start("webrtc",{bare:!0});setTimeout(function(){h.send({type:"webrtc",js:{open:!0}})},10),c(!0,h,d.hashname)}),a.rels.webrtc=function(a,b,d,e){if(e(),!a){var g=b.from.hashname;if(f[g]&&d.id<f[g].id)return d.fail("duplicate");d.send({js:{open:!0}}),c(!1,d,g)}}}}).call(this,a("buffer").Buffer)},{buffer:29,"webrtc-peer":28}],28:[function(a,b,c){function d(a){a||(a={}),a.reliable=!0;var b={iceServers:c.iceServers},d=a.reliable?{}:{optional:[{RtpDataChannels:!0}]};this._rtc=new e(b,d),this.LOG_SELF=a._self,this.LOG_PEER=a._peer,this._channel=null,this.onsignal=null,this.onmessage=null,this.onconnection=null;var f=this,g=this._rtc;a.initiate?this._setupChannel():g.ondatachannel=this._setupChannel.bind(this),g.onnegotiationneeded=function(){f.DEBUG&&console.log(f.LOG_SELF,"saw negotiation trigger and will create an offer"),g.createOffer(function(a){f.DEBUG&&console.log(f.LOG_SELF,"created offer, sending to",f.LOG_PEER),g.setLocalDescription(a,function(){console.log("DONE")}),f._sendSignal(a)},function(a){console.warn(f.LOG_SELF,"failed to create offer",a)})},g.onicecandidate=function(a){a.candidate&&f._sendSignal({candidate:a.candidate})},g.onicechange=function(){f.DEBUG&&console.log(f.LOG_SELF,"ICE change",g.iceGatheringState,g.iceConnectionState)},g.onstatechange=function(){f.DEBUG&&console.log(f.LOG_SELF,"State change",g.signalingState,g.readyState)}}c.peer=d,c.iceServers=[{url:"stun:23.21.150.121"}];var e=window.mozRTCPeerConnection||window.RTCPeerConnection||window.webkitRTCPeerConnection,f=window.mozRTCSessionDescription||window.RTCSessionDescription||window.webkitRTCSessionDescription,g=window.mozRTCIceCandidate||window.RTCIceCandidate||window.webkitRTCIceCandidate;c.hasWebRTC=e?!0:!1,d.prototype._sendSignal=function(a){if(!this.onsignal)throw Error("Need to send message but `onsignal` handler is not set.");this.onsignal(a)},d.prototype.signal=function(a){var b=this,c=this._rtc;if(b.DEBUG&&console.log(this.LOG_SELF,"got data",a,"from",this.LOG_PEER),a.sdp)c.setRemoteDescription(new f(a),function(){var a="offer"==c.remoteDescription.type;b.DEBUG&&console.log(b.LOG_SELF,"set offer, now creating answer:",a),a&&c.createAnswer(function(a){b.DEBUG&&console.log(b.LOG_SELF,"got anwer, sending back to",b.LOG_PEER),c.setLocalDescription(a),b._sendSignal(a)},function(a){console.warn(b.LOG_SELF,"couldn't create answer",a)})},function(a){console.warn(b.LOG_SELF,"couldn't set remote description",a)});else if(a.candidate)try{c.addIceCandidate(new g(a.candidate))}catch(d){console.error("Couldn't add candidate",d)}},d.prototype.send=function(a){return this._channel&&"open"===this._channel.readyState?void this._channel.send(a):handler.DEBUG&&console.log("dropping data, no open channel")},d.prototype._setupChannel=function(a){var b=this,c=this._rtc;a&&b.DEBUG&&console.log(this.LOG_SELF,"received data channel",a.channel.readyState),this._channel=a?a.channel:c.createDataChannel("telehash"),this._channel.onopen=function(){b.DEBUG&&console.log(b.LOG_SELF,"DATA CHANNEL IS OPEN",b._channel),b.onconnection&&b.onconnection(b._channel)},this._channel.onmessage=function(a){b.DEBUG&&console.log(b.LOG_SELF,"received message!",a),b.onmessage&&b.onmessage(a.data)},window.mozRTCPeerConnection&&setTimeout(function(){c.onnegotiationneeded()},0),window.dbgChannel=this._channel}},{}],29:[function(a,b,c){function d(a,b,c){if(!(this instanceof d))return new d(a,b,c);var e=typeof a;"base64"===b&&"string"===e&&(a=C(a));var f;if("number"===e)f=F(a);else if("string"===e)f=d.byteLength(a,b);else{if("object"!==e)throw new Error("First argument needs to be a number, array or string.");f=F(a.length)}var g;d._useTypedArrays?g=d._augment(new Uint8Array(f)):(g=this,g.length=f,g._isBuffer=!0);var h;if(d._useTypedArrays&&"number"==typeof a.byteLength)g._set(a);else if(H(a))if(d.isBuffer(a))for(h=0;f>h;h++)g[h]=a.readUInt8(h);else for(h=0;f>h;h++)g[h]=(a[h]%256+256)%256;else if("string"===e)g.write(a,0,b);else if("number"===e&&!d._useTypedArrays&&!c)for(h=0;f>h;h++)g[h]=0;return g}function e(a,b,c,d){c=Number(c)||0;var e=a.length-c;d?(d=Number(d),d>e&&(d=e)):d=e;var f=b.length;S(f%2===0,"Invalid hex string"),d>f/2&&(d=f/2);for(var g=0;d>g;g++){var h=parseInt(b.substr(2*g,2),16);S(!isNaN(h),"Invalid hex string"),a[c+g]=h}return g}function f(a,b,c,d){var e=N(J(b),a,c,d);return e}function g(a,b,c,d){var e=N(K(b),a,c,d);return e}function h(a,b,c,d){return g(a,b,c,d)}function i(a,b,c,d){var e=N(M(b),a,c,d);return e}function j(a,b,c,d){var e=N(L(b),a,c,d);return e}function k(a,b,c){return T.fromByteArray(0===b&&c===a.length?a:a.slice(b,c))}function l(a,b,c){var d="",e="";c=Math.min(a.length,c);for(var f=b;c>f;f++)a[f]<=127?(d+=O(e)+String.fromCharCode(a[f]),e=""):e+="%"+a[f].toString(16);return d+O(e)}function m(a,b,c){var d="";c=Math.min(a.length,c);for(var e=b;c>e;e++)d+=String.fromCharCode(a[e]);return d}function n(a,b,c){return m(a,b,c)}function o(a,b,c){var d=a.length;(!b||0>b)&&(b=0),(!c||0>c||c>d)&&(c=d);for(var e="",f=b;c>f;f++)e+=I(a[f]);return e}function p(a,b,c){for(var d=a.slice(b,c),e="",f=0;f<d.length;f+=2)e+=String.fromCharCode(d[f]+256*d[f+1]);return e}function q(a,b,c,d){d||(S("boolean"==typeof c,"missing or invalid endian"),S(void 0!==b&&null!==b,"missing offset"),S(b+1<a.length,"Trying to read beyond buffer length"));var e=a.length;if(!(b>=e)){var f;return c?(f=a[b],e>b+1&&(f|=a[b+1]<<8)):(f=a[b]<<8,e>b+1&&(f|=a[b+1])),f}}function r(a,b,c,d){d||(S("boolean"==typeof c,"missing or invalid endian"),S(void 0!==b&&null!==b,"missing offset"),S(b+3<a.length,"Trying to read beyond buffer length"));var e=a.length;if(!(b>=e)){var f;return c?(e>b+2&&(f=a[b+2]<<16),e>b+1&&(f|=a[b+1]<<8),f|=a[b],e>b+3&&(f+=a[b+3]<<24>>>0)):(e>b+1&&(f=a[b+1]<<16),e>b+2&&(f|=a[b+2]<<8),e>b+3&&(f|=a[b+3]),f+=a[b]<<24>>>0),f}}function s(a,b,c,d){d||(S("boolean"==typeof c,"missing or invalid endian"),S(void 0!==b&&null!==b,"missing offset"),S(b+1<a.length,"Trying to read beyond buffer length"));var e=a.length;if(!(b>=e)){var f=q(a,b,c,!0),g=32768&f;return g?-1*(65535-f+1):f}}function t(a,b,c,d){d||(S("boolean"==typeof c,"missing or invalid endian"),S(void 0!==b&&null!==b,"missing offset"),S(b+3<a.length,"Trying to read beyond buffer length"));var e=a.length;if(!(b>=e)){var f=r(a,b,c,!0),g=2147483648&f;return g?-1*(4294967295-f+1):f}}function u(a,b,c,d){return d||(S("boolean"==typeof c,"missing or invalid endian"),S(b+3<a.length,"Trying to read beyond buffer length")),U.read(a,b,c,23,4)}function v(a,b,c,d){return d||(S("boolean"==typeof c,"missing or invalid endian"),S(b+7<a.length,"Trying to read beyond buffer length")),U.read(a,b,c,52,8)}function w(a,b,c,d,e){e||(S(void 0!==b&&null!==b,"missing value"),S("boolean"==typeof d,"missing or invalid endian"),S(void 0!==c&&null!==c,"missing offset"),S(c+1<a.length,"trying to write beyond buffer length"),P(b,65535));var f=a.length;if(!(c>=f)){for(var g=0,h=Math.min(f-c,2);h>g;g++)a[c+g]=(b&255<<8*(d?g:1-g))>>>8*(d?g:1-g);return c+2}}function x(a,b,c,d,e){e||(S(void 0!==b&&null!==b,"missing value"),S("boolean"==typeof d,"missing or invalid endian"),S(void 0!==c&&null!==c,"missing offset"),S(c+3<a.length,"trying to write beyond buffer length"),P(b,4294967295));var f=a.length;if(!(c>=f)){for(var g=0,h=Math.min(f-c,4);h>g;g++)a[c+g]=b>>>8*(d?g:3-g)&255;return c+4}}function y(a,b,c,d,e){e||(S(void 0!==b&&null!==b,"missing value"),S("boolean"==typeof d,"missing or invalid endian"),S(void 0!==c&&null!==c,"missing offset"),S(c+1<a.length,"Trying to write beyond buffer length"),Q(b,32767,-32768));var f=a.length;if(!(c>=f))return b>=0?w(a,b,c,d,e):w(a,65535+b+1,c,d,e),c+2}function z(a,b,c,d,e){e||(S(void 0!==b&&null!==b,"missing value"),S("boolean"==typeof d,"missing or invalid endian"),S(void 0!==c&&null!==c,"missing offset"),S(c+3<a.length,"Trying to write beyond buffer length"),Q(b,2147483647,-2147483648));var f=a.length;if(!(c>=f))return b>=0?x(a,b,c,d,e):x(a,4294967295+b+1,c,d,e),c+4}function A(a,b,c,d,e){e||(S(void 0!==b&&null!==b,"missing value"),S("boolean"==typeof d,"missing or invalid endian"),S(void 0!==c&&null!==c,"missing offset"),S(c+3<a.length,"Trying to write beyond buffer length"),R(b,3.4028234663852886e38,-3.4028234663852886e38));var f=a.length;if(!(c>=f))return U.write(a,b,c,d,23,4),c+4}function B(a,b,c,d,e){e||(S(void 0!==b&&null!==b,"missing value"),S("boolean"==typeof d,"missing or invalid endian"),S(void 0!==c&&null!==c,"missing offset"),S(c+7<a.length,"Trying to write beyond buffer length"),R(b,1.7976931348623157e308,-1.7976931348623157e308));var f=a.length;if(!(c>=f))return U.write(a,b,c,d,52,8),c+8}function C(a){for(a=D(a).replace(W,"");a.length%4!==0;)a+="=";return a}function D(a){return a.trim?a.trim():a.replace(/^\s+|\s+$/g,"")}function E(a,b,c){return"number"!=typeof a?c:(a=~~a,a>=b?b:a>=0?a:(a+=b,a>=0?a:0))}function F(a){return a=~~Math.ceil(+a),0>a?0:a}function G(a){return(Array.isArray||function(a){return"[object Array]"===Object.prototype.toString.call(a)})(a)}function H(a){return G(a)||d.isBuffer(a)||a&&"object"==typeof a&&"number"==typeof a.length}function I(a){return 16>a?"0"+a.toString(16):a.toString(16)
}function J(a){for(var b=[],c=0;c<a.length;c++){var d=a.charCodeAt(c);if(127>=d)b.push(d);else{var e=c;d>=55296&&57343>=d&&c++;for(var f=encodeURIComponent(a.slice(e,c+1)).substr(1).split("%"),g=0;g<f.length;g++)b.push(parseInt(f[g],16))}}return b}function K(a){for(var b=[],c=0;c<a.length;c++)b.push(255&a.charCodeAt(c));return b}function L(a){for(var b,c,d,e=[],f=0;f<a.length;f++)b=a.charCodeAt(f),c=b>>8,d=b%256,e.push(d),e.push(c);return e}function M(a){return T.toByteArray(a)}function N(a,b,c,d){for(var e=0;d>e&&!(e+c>=b.length||e>=a.length);e++)b[e+c]=a[e];return e}function O(a){try{return decodeURIComponent(a)}catch(b){return String.fromCharCode(65533)}}function P(a,b){S("number"==typeof a,"cannot write a non-number as a number"),S(a>=0,"specified a negative value for writing an unsigned value"),S(b>=a,"value is larger than maximum value for type"),S(Math.floor(a)===a,"value has a fractional component")}function Q(a,b,c){S("number"==typeof a,"cannot write a non-number as a number"),S(b>=a,"value larger than maximum allowed value"),S(a>=c,"value smaller than minimum allowed value"),S(Math.floor(a)===a,"value has a fractional component")}function R(a,b,c){S("number"==typeof a,"cannot write a non-number as a number"),S(b>=a,"value larger than maximum allowed value"),S(a>=c,"value smaller than minimum allowed value")}function S(a,b){if(!a)throw new Error(b||"Failed assertion")}var T=a("base64-js"),U=a("ieee754");c.Buffer=d,c.SlowBuffer=d,c.INSPECT_MAX_BYTES=50,d.poolSize=8192,d._useTypedArrays=function(){try{var a=new ArrayBuffer(0),b=new Uint8Array(a);return b.foo=function(){return 42},42===b.foo()&&"function"==typeof b.subarray}catch(c){return!1}}(),d.isEncoding=function(a){switch(String(a).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"raw":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},d.isBuffer=function(a){return!(null===a||void 0===a||!a._isBuffer)},d.byteLength=function(a,b){var c;switch(a=a.toString(),b||"utf8"){case"hex":c=a.length/2;break;case"utf8":case"utf-8":c=J(a).length;break;case"ascii":case"binary":case"raw":c=a.length;break;case"base64":c=M(a).length;break;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":c=2*a.length;break;default:throw new Error("Unknown encoding")}return c},d.concat=function(a,b){if(S(G(a),"Usage: Buffer.concat(list[, length])"),0===a.length)return new d(0);if(1===a.length)return a[0];var c;if(void 0===b)for(b=0,c=0;c<a.length;c++)b+=a[c].length;var e=new d(b),f=0;for(c=0;c<a.length;c++){var g=a[c];g.copy(e,f),f+=g.length}return e},d.compare=function(a,b){S(d.isBuffer(a)&&d.isBuffer(b),"Arguments must be Buffers");for(var c=a.length,e=b.length,f=0,g=Math.min(c,e);g>f&&a[f]===b[f];f++);return f!==g&&(c=a[f],e=b[f]),e>c?-1:c>e?1:0},d.prototype.write=function(a,b,c,d){if(isFinite(b))isFinite(c)||(d=c,c=void 0);else{var k=d;d=b,b=c,c=k}b=Number(b)||0;var l=this.length-b;c?(c=Number(c),c>l&&(c=l)):c=l,d=String(d||"utf8").toLowerCase();var m;switch(d){case"hex":m=e(this,a,b,c);break;case"utf8":case"utf-8":m=f(this,a,b,c);break;case"ascii":m=g(this,a,b,c);break;case"binary":m=h(this,a,b,c);break;case"base64":m=i(this,a,b,c);break;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":m=j(this,a,b,c);break;default:throw new Error("Unknown encoding")}return m},d.prototype.toString=function(a,b,c){var d=this;if(a=String(a||"utf8").toLowerCase(),b=Number(b)||0,c=void 0===c?d.length:Number(c),c===b)return"";var e;switch(a){case"hex":e=o(d,b,c);break;case"utf8":case"utf-8":e=l(d,b,c);break;case"ascii":e=m(d,b,c);break;case"binary":e=n(d,b,c);break;case"base64":e=k(d,b,c);break;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":e=p(d,b,c);break;default:throw new Error("Unknown encoding")}return e},d.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}},d.prototype.equals=function(a){return S(d.isBuffer(a),"Argument must be a Buffer"),0===d.compare(this,a)},d.prototype.compare=function(a){return S(d.isBuffer(a),"Argument must be a Buffer"),d.compare(this,a)},d.prototype.copy=function(a,b,c,e){var f=this;if(c||(c=0),e||0===e||(e=this.length),b||(b=0),e!==c&&0!==a.length&&0!==f.length){S(e>=c,"sourceEnd < sourceStart"),S(b>=0&&b<a.length,"targetStart out of bounds"),S(c>=0&&c<f.length,"sourceStart out of bounds"),S(e>=0&&e<=f.length,"sourceEnd out of bounds"),e>this.length&&(e=this.length),a.length-b<e-c&&(e=a.length-b+c);var g=e-c;if(100>g||!d._useTypedArrays)for(var h=0;g>h;h++)a[h+b]=this[h+c];else a._set(this.subarray(c,c+g),b)}},d.prototype.slice=function(a,b){var c=this.length;if(a=E(a,c,0),b=E(b,c,c),d._useTypedArrays)return d._augment(this.subarray(a,b));for(var e=b-a,f=new d(e,void 0,!0),g=0;e>g;g++)f[g]=this[g+a];return f},d.prototype.get=function(a){return console.log(".get() is deprecated. Access using array indexes instead."),this.readUInt8(a)},d.prototype.set=function(a,b){return console.log(".set() is deprecated. Access using array indexes instead."),this.writeUInt8(a,b)},d.prototype.readUInt8=function(a,b){return b||(S(void 0!==a&&null!==a,"missing offset"),S(a<this.length,"Trying to read beyond buffer length")),a>=this.length?void 0:this[a]},d.prototype.readUInt16LE=function(a,b){return q(this,a,!0,b)},d.prototype.readUInt16BE=function(a,b){return q(this,a,!1,b)},d.prototype.readUInt32LE=function(a,b){return r(this,a,!0,b)},d.prototype.readUInt32BE=function(a,b){return r(this,a,!1,b)},d.prototype.readInt8=function(a,b){if(b||(S(void 0!==a&&null!==a,"missing offset"),S(a<this.length,"Trying to read beyond buffer length")),!(a>=this.length)){var c=128&this[a];return c?-1*(255-this[a]+1):this[a]}},d.prototype.readInt16LE=function(a,b){return s(this,a,!0,b)},d.prototype.readInt16BE=function(a,b){return s(this,a,!1,b)},d.prototype.readInt32LE=function(a,b){return t(this,a,!0,b)},d.prototype.readInt32BE=function(a,b){return t(this,a,!1,b)},d.prototype.readFloatLE=function(a,b){return u(this,a,!0,b)},d.prototype.readFloatBE=function(a,b){return u(this,a,!1,b)},d.prototype.readDoubleLE=function(a,b){return v(this,a,!0,b)},d.prototype.readDoubleBE=function(a,b){return v(this,a,!1,b)},d.prototype.writeUInt8=function(a,b,c){return c||(S(void 0!==a&&null!==a,"missing value"),S(void 0!==b&&null!==b,"missing offset"),S(b<this.length,"trying to write beyond buffer length"),P(a,255)),b>=this.length?void 0:(this[b]=a,b+1)},d.prototype.writeUInt16LE=function(a,b,c){return w(this,a,b,!0,c)},d.prototype.writeUInt16BE=function(a,b,c){return w(this,a,b,!1,c)},d.prototype.writeUInt32LE=function(a,b,c){return x(this,a,b,!0,c)},d.prototype.writeUInt32BE=function(a,b,c){return x(this,a,b,!1,c)},d.prototype.writeInt8=function(a,b,c){return c||(S(void 0!==a&&null!==a,"missing value"),S(void 0!==b&&null!==b,"missing offset"),S(b<this.length,"Trying to write beyond buffer length"),Q(a,127,-128)),b>=this.length?void 0:(a>=0?this.writeUInt8(a,b,c):this.writeUInt8(255+a+1,b,c),b+1)},d.prototype.writeInt16LE=function(a,b,c){return y(this,a,b,!0,c)},d.prototype.writeInt16BE=function(a,b,c){return y(this,a,b,!1,c)},d.prototype.writeInt32LE=function(a,b,c){return z(this,a,b,!0,c)},d.prototype.writeInt32BE=function(a,b,c){return z(this,a,b,!1,c)},d.prototype.writeFloatLE=function(a,b,c){return A(this,a,b,!0,c)},d.prototype.writeFloatBE=function(a,b,c){return A(this,a,b,!1,c)},d.prototype.writeDoubleLE=function(a,b,c){return B(this,a,b,!0,c)},d.prototype.writeDoubleBE=function(a,b,c){return B(this,a,b,!1,c)},d.prototype.fill=function(a,b,c){if(a||(a=0),b||(b=0),c||(c=this.length),S(c>=b,"end < start"),c!==b&&0!==this.length){S(b>=0&&b<this.length,"start out of bounds"),S(c>=0&&c<=this.length,"end out of bounds");var d;if("number"==typeof a)for(d=b;c>d;d++)this[d]=a;else{var e=J(a.toString()),f=e.length;for(d=b;c>d;d++)this[d]=e[d%f]}return this}},d.prototype.inspect=function(){for(var a=[],b=this.length,d=0;b>d;d++)if(a[d]=I(this[d]),d===c.INSPECT_MAX_BYTES){a[d+1]="...";break}return"<Buffer "+a.join(" ")+">"},d.prototype.toArrayBuffer=function(){if("undefined"!=typeof Uint8Array){if(d._useTypedArrays)return new d(this).buffer;for(var a=new Uint8Array(this.length),b=0,c=a.length;c>b;b+=1)a[b]=this[b];return a.buffer}throw new Error("Buffer.toArrayBuffer not supported in this browser")};var V=d.prototype;d._augment=function(a){return a._isBuffer=!0,a._get=a.get,a._set=a.set,a.get=V.get,a.set=V.set,a.write=V.write,a.toString=V.toString,a.toLocaleString=V.toString,a.toJSON=V.toJSON,a.equals=V.equals,a.compare=V.compare,a.copy=V.copy,a.slice=V.slice,a.readUInt8=V.readUInt8,a.readUInt16LE=V.readUInt16LE,a.readUInt16BE=V.readUInt16BE,a.readUInt32LE=V.readUInt32LE,a.readUInt32BE=V.readUInt32BE,a.readInt8=V.readInt8,a.readInt16LE=V.readInt16LE,a.readInt16BE=V.readInt16BE,a.readInt32LE=V.readInt32LE,a.readInt32BE=V.readInt32BE,a.readFloatLE=V.readFloatLE,a.readFloatBE=V.readFloatBE,a.readDoubleLE=V.readDoubleLE,a.readDoubleBE=V.readDoubleBE,a.writeUInt8=V.writeUInt8,a.writeUInt16LE=V.writeUInt16LE,a.writeUInt16BE=V.writeUInt16BE,a.writeUInt32LE=V.writeUInt32LE,a.writeUInt32BE=V.writeUInt32BE,a.writeInt8=V.writeInt8,a.writeInt16LE=V.writeInt16LE,a.writeInt16BE=V.writeInt16BE,a.writeInt32LE=V.writeInt32LE,a.writeInt32BE=V.writeInt32BE,a.writeFloatLE=V.writeFloatLE,a.writeFloatBE=V.writeFloatBE,a.writeDoubleLE=V.writeDoubleLE,a.writeDoubleBE=V.writeDoubleBE,a.fill=V.fill,a.inspect=V.inspect,a.toArrayBuffer=V.toArrayBuffer,a};var W=/[^+\/0-9A-z]/g},{"base64-js":30,ieee754:31}],30:[function(a,b,c){var d="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";!function(a){"use strict";function b(a){var b=a.charCodeAt(0);return b===g?62:b===h?63:i>b?-1:i+10>b?b-i+26+26:k+26>b?b-k:j+26>b?b-j+26:void 0}function c(a){function c(a){j[l++]=a}var d,e,g,h,i,j;if(a.length%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var k=a.length;i="="===a.charAt(k-2)?2:"="===a.charAt(k-1)?1:0,j=new f(3*a.length/4-i),g=i>0?a.length-4:a.length;var l=0;for(d=0,e=0;g>d;d+=4,e+=3)h=b(a.charAt(d))<<18|b(a.charAt(d+1))<<12|b(a.charAt(d+2))<<6|b(a.charAt(d+3)),c((16711680&h)>>16),c((65280&h)>>8),c(255&h);return 2===i?(h=b(a.charAt(d))<<2|b(a.charAt(d+1))>>4,c(255&h)):1===i&&(h=b(a.charAt(d))<<10|b(a.charAt(d+1))<<4|b(a.charAt(d+2))>>2,c(h>>8&255),c(255&h)),j}function e(a){function b(a){return d.charAt(a)}function c(a){return b(a>>18&63)+b(a>>12&63)+b(a>>6&63)+b(63&a)}var e,f,g,h=a.length%3,i="";for(e=0,g=a.length-h;g>e;e+=3)f=(a[e]<<16)+(a[e+1]<<8)+a[e+2],i+=c(f);switch(h){case 1:f=a[a.length-1],i+=b(f>>2),i+=b(f<<4&63),i+="==";break;case 2:f=(a[a.length-2]<<8)+a[a.length-1],i+=b(f>>10),i+=b(f>>4&63),i+=b(f<<2&63),i+="="}return i}var f="undefined"!=typeof Uint8Array?Uint8Array:Array,g="+".charCodeAt(0),h="/".charCodeAt(0),i="0".charCodeAt(0),j="a".charCodeAt(0),k="A".charCodeAt(0);a.toByteArray=c,a.fromByteArray=e}("undefined"==typeof c?this.base64js={}:c)},{}],31:[function(a,b,c){c.read=function(a,b,c,d,e){var f,g,h=8*e-d-1,i=(1<<h)-1,j=i>>1,k=-7,l=c?e-1:0,m=c?-1:1,n=a[b+l];for(l+=m,f=n&(1<<-k)-1,n>>=-k,k+=h;k>0;f=256*f+a[b+l],l+=m,k-=8);for(g=f&(1<<-k)-1,f>>=-k,k+=d;k>0;g=256*g+a[b+l],l+=m,k-=8);if(0===f)f=1-j;else{if(f===i)return g?0/0:1/0*(n?-1:1);g+=Math.pow(2,d),f-=j}return(n?-1:1)*g*Math.pow(2,f-d)},c.write=function(a,b,c,d,e,f){var g,h,i,j=8*f-e-1,k=(1<<j)-1,l=k>>1,m=23===e?Math.pow(2,-24)-Math.pow(2,-77):0,n=d?0:f-1,o=d?1:-1,p=0>b||0===b&&0>1/b?1:0;for(b=Math.abs(b),isNaN(b)||1/0===b?(h=isNaN(b)?1:0,g=k):(g=Math.floor(Math.log(b)/Math.LN2),b*(i=Math.pow(2,-g))<1&&(g--,i*=2),b+=g+l>=1?m/i:m*Math.pow(2,1-l),b*i>=2&&(g++,i/=2),g+l>=k?(h=0,g=k):g+l>=1?(h=(b*i-1)*Math.pow(2,e),g+=l):(h=b*Math.pow(2,l-1)*Math.pow(2,e),g=0));e>=8;a[c+n]=255&h,n+=o,h/=256,e-=8);for(g=g<<e|h,j+=e;j>0;a[c+n]=255&g,n+=o,g/=256,j-=8);a[c+n-o]|=128*p}},{}],32:[function(a,b){(function(c){function d(a){return function(){var b=[],d={update:function(a,d){return c.isBuffer(a)||(a=new c(a,d)),b.push(a),this},digest:function(d){var e=c.concat(b),f=a(e);return b=null,d?f.toString(d):f}};return d}}var e=a("sha.js"),f=d(a("./md5")),g=d(a("ripemd160"));b.exports=function(a){return"md5"===a?new f:"rmd160"===a?new g:e(a)}}).call(this,a("buffer").Buffer)},{"./md5":36,buffer:29,ripemd160:37,"sha.js":39}],33:[function(a,b){(function(c){function d(a,b){if(!(this instanceof d))return new d(a,b);this._opad=i,this._alg=a,b=this._key=c.isBuffer(b)?b:new c(b),b.length>f?b=e(a).update(b).digest():b.length<f&&(b=c.concat([b,g],f));for(var h=this._ipad=new c(f),i=this._opad=new c(f),j=0;f>j;j++)h[j]=54^b[j],i[j]=92^b[j];this._hash=e(a).update(h)}var e=a("./create-hash"),f=64,g=new c(f);g.fill(0),b.exports=d,d.prototype.update=function(a,b){return this._hash.update(a,b),this},d.prototype.digest=function(a){var b=this._hash.digest();return e(this._alg).update(this._opad).update(b).digest(a)}}).call(this,a("buffer").Buffer)},{"./create-hash":32,buffer:29}],34:[function(a,b){(function(a){function c(b,c){if(b.length%f!==0){var d=b.length+(f-b.length%f);b=a.concat([b,g],d)}for(var e=[],h=c?b.readInt32BE:b.readInt32LE,i=0;i<b.length;i+=f)e.push(h.call(b,i));return e}function d(b,c,d){for(var e=new a(c),f=d?e.writeInt32BE:e.writeInt32LE,g=0;g<b.length;g++)f.call(e,b[g],4*g,!0);return e}function e(b,e,f,g){a.isBuffer(b)||(b=new a(b));var i=e(c(b,g),b.length*h);return d(i,f,g)}var f=4,g=new a(f);g.fill(0);var h=8;b.exports={hash:e}}).call(this,a("buffer").Buffer)},{buffer:29}],35:[function(a,b,c){(function(b){function d(){var a=[].slice.call(arguments).join(" ");throw new Error([a,"we accept pull requests","http://github.com/dominictarr/crypto-browserify"].join("\n"))}function e(a,b){for(var c in a)b(a[c],c)}var f=a("./rng");c.createHash=a("./create-hash"),c.createHmac=a("./create-hmac"),c.randomBytes=function(a,c){if(!c||!c.call)return new b(f(a));try{c.call(this,void 0,new b(f(a)))}catch(d){c(d)}},c.getHashes=function(){return["sha1","sha256","md5","rmd160"]};var g=a("./pbkdf2")(c.createHmac);c.pbkdf2=g.pbkdf2,c.pbkdf2Sync=g.pbkdf2Sync,e(["createCredentials","createCipher","createCipheriv","createDecipher","createDecipheriv","createSign","createVerify","createDiffieHellman"],function(a){c[a]=function(){d("sorry,",a,"is not implemented yet")}})}).call(this,a("buffer").Buffer)},{"./create-hash":32,"./create-hmac":33,"./pbkdf2":43,"./rng":44,buffer:29}],36:[function(a,b){function c(a,b){a[b>>5]|=128<<b%32,a[(b+64>>>9<<4)+14]=b;for(var c=1732584193,d=-271733879,j=-1732584194,k=271733878,l=0;l<a.length;l+=16){var m=c,n=d,o=j,p=k;c=e(c,d,j,k,a[l+0],7,-680876936),k=e(k,c,d,j,a[l+1],12,-389564586),j=e(j,k,c,d,a[l+2],17,606105819),d=e(d,j,k,c,a[l+3],22,-1044525330),c=e(c,d,j,k,a[l+4],7,-176418897),k=e(k,c,d,j,a[l+5],12,1200080426),j=e(j,k,c,d,a[l+6],17,-1473231341),d=e(d,j,k,c,a[l+7],22,-45705983),c=e(c,d,j,k,a[l+8],7,1770035416),k=e(k,c,d,j,a[l+9],12,-1958414417),j=e(j,k,c,d,a[l+10],17,-42063),d=e(d,j,k,c,a[l+11],22,-1990404162),c=e(c,d,j,k,a[l+12],7,1804603682),k=e(k,c,d,j,a[l+13],12,-40341101),j=e(j,k,c,d,a[l+14],17,-1502002290),d=e(d,j,k,c,a[l+15],22,1236535329),c=f(c,d,j,k,a[l+1],5,-165796510),k=f(k,c,d,j,a[l+6],9,-1069501632),j=f(j,k,c,d,a[l+11],14,643717713),d=f(d,j,k,c,a[l+0],20,-373897302),c=f(c,d,j,k,a[l+5],5,-701558691),k=f(k,c,d,j,a[l+10],9,38016083),j=f(j,k,c,d,a[l+15],14,-660478335),d=f(d,j,k,c,a[l+4],20,-405537848),c=f(c,d,j,k,a[l+9],5,568446438),k=f(k,c,d,j,a[l+14],9,-1019803690),j=f(j,k,c,d,a[l+3],14,-187363961),d=f(d,j,k,c,a[l+8],20,1163531501),c=f(c,d,j,k,a[l+13],5,-1444681467),k=f(k,c,d,j,a[l+2],9,-51403784),j=f(j,k,c,d,a[l+7],14,1735328473),d=f(d,j,k,c,a[l+12],20,-1926607734),c=g(c,d,j,k,a[l+5],4,-378558),k=g(k,c,d,j,a[l+8],11,-2022574463),j=g(j,k,c,d,a[l+11],16,1839030562),d=g(d,j,k,c,a[l+14],23,-35309556),c=g(c,d,j,k,a[l+1],4,-1530992060),k=g(k,c,d,j,a[l+4],11,1272893353),j=g(j,k,c,d,a[l+7],16,-155497632),d=g(d,j,k,c,a[l+10],23,-1094730640),c=g(c,d,j,k,a[l+13],4,681279174),k=g(k,c,d,j,a[l+0],11,-358537222),j=g(j,k,c,d,a[l+3],16,-722521979),d=g(d,j,k,c,a[l+6],23,76029189),c=g(c,d,j,k,a[l+9],4,-640364487),k=g(k,c,d,j,a[l+12],11,-421815835),j=g(j,k,c,d,a[l+15],16,530742520),d=g(d,j,k,c,a[l+2],23,-995338651),c=h(c,d,j,k,a[l+0],6,-198630844),k=h(k,c,d,j,a[l+7],10,1126891415),j=h(j,k,c,d,a[l+14],15,-1416354905),d=h(d,j,k,c,a[l+5],21,-57434055),c=h(c,d,j,k,a[l+12],6,1700485571),k=h(k,c,d,j,a[l+3],10,-1894986606),j=h(j,k,c,d,a[l+10],15,-1051523),d=h(d,j,k,c,a[l+1],21,-2054922799),c=h(c,d,j,k,a[l+8],6,1873313359),k=h(k,c,d,j,a[l+15],10,-30611744),j=h(j,k,c,d,a[l+6],15,-1560198380),d=h(d,j,k,c,a[l+13],21,1309151649),c=h(c,d,j,k,a[l+4],6,-145523070),k=h(k,c,d,j,a[l+11],10,-1120210379),j=h(j,k,c,d,a[l+2],15,718787259),d=h(d,j,k,c,a[l+9],21,-343485551),c=i(c,m),d=i(d,n),j=i(j,o),k=i(k,p)}return Array(c,d,j,k)}function d(a,b,c,d,e,f){return i(j(i(i(b,a),i(d,f)),e),c)}function e(a,b,c,e,f,g,h){return d(b&c|~b&e,a,b,f,g,h)}function f(a,b,c,e,f,g,h){return d(b&e|c&~e,a,b,f,g,h)}function g(a,b,c,e,f,g,h){return d(b^c^e,a,b,f,g,h)}function h(a,b,c,e,f,g,h){return d(c^(b|~e),a,b,f,g,h)}function i(a,b){var c=(65535&a)+(65535&b),d=(a>>16)+(b>>16)+(c>>16);return d<<16|65535&c}function j(a,b){return a<<b|a>>>32-b}var k=a("./helpers");b.exports=function(a){return k.hash(a,c,16)}},{"./helpers":34}],37:[function(a,b){(function(a){function c(a,b,c){return a^b^c}function d(a,b,c){return a&b|~a&c}function e(a,b,c){return(a|~b)^c}function f(a,b,c){return a&c|b&~c}function g(a,b,c){return a^(b|~c)}function h(a,b){return a<<b|a>>>32-b}function i(b){var c=[1732584193,4023233417,2562383102,271733878,3285377520];"string"==typeof b&&(b=new a(b,"utf8"));var d=p(b),e=8*b.length,f=8*b.length;d[e>>>5]|=128<<24-e%32,d[(e+64>>>9<<4)+14]=16711935&(f<<8|f>>>24)|4278255360&(f<<24|f>>>8);for(var g=0;g<d.length;g+=16)r(c,d,g);for(var g=0;5>g;g++){var h=c[g];c[g]=16711935&(h<<8|h>>>24)|4278255360&(h<<24|h>>>8)}var i=q(c);return new a(i)}b.exports=i;var j=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13],k=[5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11],l=[11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6],m=[8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11],n=[0,1518500249,1859775393,2400959708,2840853838],o=[1352829926,1548603684,1836072691,2053994217,0],p=function(a){for(var b=[],c=0,d=0;c<a.length;c++,d+=8)b[d>>>5]|=a[c]<<24-d%32;return b},q=function(a){for(var b=[],c=0;c<32*a.length;c+=8)b.push(a[c>>>5]>>>24-c%32&255);return b},r=function(a,b,i){for(var p=0;16>p;p++){var q=i+p,r=b[q];b[q]=16711935&(r<<8|r>>>24)|4278255360&(r<<24|r>>>8)}var s,t,u,v,w,x,y,z,A,B;x=s=a[0],y=t=a[1],z=u=a[2],A=v=a[3],B=w=a[4];for(var C,p=0;80>p;p+=1)C=s+b[i+j[p]]|0,C+=16>p?c(t,u,v)+n[0]:32>p?d(t,u,v)+n[1]:48>p?e(t,u,v)+n[2]:64>p?f(t,u,v)+n[3]:g(t,u,v)+n[4],C=0|C,C=h(C,l[p]),C=C+w|0,s=w,w=v,v=h(u,10),u=t,t=C,C=x+b[i+k[p]]|0,C+=16>p?g(y,z,A)+o[0]:32>p?f(y,z,A)+o[1]:48>p?e(y,z,A)+o[2]:64>p?d(y,z,A)+o[3]:c(y,z,A)+o[4],C=0|C,C=h(C,m[p]),C=C+B|0,x=B,B=A,A=h(z,10),z=y,y=C;C=a[1]+u+A|0,a[1]=a[2]+v+B|0,a[2]=a[3]+w+x|0,a[3]=a[4]+s+y|0,a[4]=a[0]+t+z|0,a[0]=C}}).call(this,a("buffer").Buffer)},{buffer:29}],38:[function(a,b){var c=a("./util"),d=c.write,e=c.zeroFill;b.exports=function(a){function b(b,c){this._block=new a(b),this._finalSize=c,this._blockSize=b,this._len=0,this._s=0}function f(a,b){return null==b?a.byteLength||a.length:"ascii"==b||"binary"==b?a.length:"hex"==b?a.length/2:"base64"==b?a.length/3:void 0}return b.prototype.init=function(){this._s=0,this._len=0},b.prototype.update=function(b,c){var e,g=this._blockSize;c||"string"!=typeof b||(c="utf8"),c?("utf-8"===c&&(c="utf8"),("base64"===c||"utf8"===c)&&(b=new a(b,c),c=null),e=f(b,c)):e=b.byteLength||b.length;for(var h=this._len+=e,i=this._s=this._s||0,j=0,k=this._block;h>i;){var l=Math.min(e,j+g);d(k,b,c,i%g,j,l);var m=l-j;i+=m,j+=m,i%g||this._update(k)}return this._s=i,this},b.prototype.digest=function(a){var b=this._blockSize,d=this._finalSize,f=8*this._len,g=this._block,h=f%(8*b);g[this._len%b]=128,e(this._block,this._len%b+1),h>=8*d&&(this._update(this._block),c.zeroFill(this._block,0)),g.writeInt32BE(f,d+4);var i=this._update(this._block)||this._hash();return null==a?i:i.toString(a)},b.prototype._update=function(){throw new Error("_update must be implemented by subclass")},b}},{"./util":42}],39:[function(a,b,c){var c=b.exports=function(a){var b=c[a];if(!b)throw new Error(a+" is not supported (we accept pull requests)");return new b},d=a("buffer").Buffer,e=a("./hash")(d);c.sha=c.sha1=a("./sha1")(d,e),c.sha256=a("./sha256")(d,e)},{"./hash":38,"./sha1":40,"./sha256":41,buffer:29}],40:[function(a,b){b.exports=function(b,c){function d(){return p.length?p.pop().init():this instanceof d?(this._w=o,c.call(this,64,56),this._h=null,void this.init()):new d}function e(a,b,c,d){return 20>a?b&c|~b&d:40>a?b^c^d:60>a?b&c|b&d|c&d:b^c^d}function f(a){return 20>a?1518500249:40>a?1859775393:60>a?-1894007588:-899497514}function g(a,b){return a+b|0}function h(a,b){return a<<b|a>>>32-b}var i=a("util").inherits;i(d,c);var j=0,k=4,l=8,m=12,n=16,o=new Int32Array(80),p=[];d.prototype.init=function(){return this._a=1732584193,this._b=4023233417,this._c=2562383102,this._d=271733878,this._e=3285377520,c.prototype.init.call(this),this},d.prototype._POOL=p;new b(1)instanceof DataView;return d.prototype._update=function(){{var a,b,c,d,i,j,k,l,m,n,o=this._block;this._h}a=j=this._a,b=k=this._b,c=l=this._c,d=m=this._d,i=n=this._e;for(var p=this._w,q=0;80>q;q++){var r=p[q]=16>q?o.readInt32BE(4*q):h(p[q-3]^p[q-8]^p[q-14]^p[q-16],1),s=g(g(h(a,5),e(q,b,c,d)),g(g(i,r),f(q)));i=d,d=c,c=h(b,30),b=a,a=s}this._a=g(a,j),this._b=g(b,k),this._c=g(c,l),this._d=g(d,m),this._e=g(i,n)},d.prototype._hash=function(){p.length<100&&p.push(this);var a=new b(20);return a.writeInt32BE(0|this._a,j),a.writeInt32BE(0|this._b,k),a.writeInt32BE(0|this._c,l),a.writeInt32BE(0|this._d,m),a.writeInt32BE(0|this._e,n),a},d}},{util:72}],41:[function(a,b){{var c=a("util").inherits;a("./util")}b.exports=function(a,b){function d(){o.length,this.init(),this._w=n,b.call(this,64,56)}function e(a,b){return a>>>b|a<<32-b}function f(a,b){return a>>>b}function g(a,b,c){return a&b^~a&c}function h(a,b,c){return a&b^a&c^b&c}function i(a){return e(a,2)^e(a,13)^e(a,22)}function j(a){return e(a,6)^e(a,11)^e(a,25)}function k(a){return e(a,7)^e(a,18)^f(a,3)}function l(a){return e(a,17)^e(a,19)^f(a,10)}var m=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298];c(d,b);var n=new Array(64),o=[];d.prototype.init=function(){return this._a=1779033703,this._b=-1150833019,this._c=1013904242,this._d=-1521486534,this._e=1359893119,this._f=-1694144372,this._g=528734635,this._h=1541459225,this._len=this._s=0,this};return d.prototype._update=function(){var a,b,c,d,e,f,n,o,p,q,r=this._block,s=this._w;a=0|this._a,b=0|this._b,c=0|this._c,d=0|this._d,e=0|this._e,f=0|this._f,n=0|this._g,o=0|this._h;for(var t=0;64>t;t++){var u=s[t]=16>t?r.readInt32BE(4*t):l(s[t-2])+s[t-7]+k(s[t-15])+s[t-16];p=o+j(e)+g(e,f,n)+m[t]+u,q=i(a)+h(a,b,c),o=n,n=f,f=e,e=d+p,d=c,c=b,b=a,a=p+q}this._a=a+this._a|0,this._b=b+this._b|0,this._c=c+this._c|0,this._d=d+this._d|0,this._e=e+this._e|0,this._f=f+this._f|0,this._g=n+this._g|0,this._h=o+this._h|0},d.prototype._hash=function(){o.length<10&&o.push(this);var b=new a(32);return b.writeInt32BE(this._a,0),b.writeInt32BE(this._b,4),b.writeInt32BE(this._c,8),b.writeInt32BE(this._d,12),b.writeInt32BE(this._e,16),b.writeInt32BE(this._f,20),b.writeInt32BE(this._g,24),b.writeInt32BE(this._h,28),b},d}},{"./util":42,util:72}],42:[function(a,b,c){function d(a,b,c,d,e,f){var g=f-e;if("ascii"===c||"binary"===c)for(var h=0;g>h;h++)a[d+h]=b.charCodeAt(h+e);else if(null==c)for(var h=0;g>h;h++)a[d+h]=b[h+e];else{if("hex"!==c)throw new Error("base64"===c?"base64 encoding not yet supported":c+" encoding not yet supported");for(var h=0;g>h;h++){var i=e+h;a[d+h]=parseInt(b[2*i]+b[2*i+1],16)}}}function e(a,b){for(var c=b;c<a.length;c++)a[c]=0}c.write=d,c.zeroFill=e,c.toString=toString},{}],43:[function(a,b){(function(a){var c=64,d=new a(c);d.fill(0),b.exports=function(b,e){return e=e||{},e.pbkdf2=function(a,b,c,d,f){if("function"!=typeof f)throw new Error("No callback provided to pbkdf2");setTimeout(function(){f(null,e.pbkdf2Sync(a,b,c,d))})},e.pbkdf2Sync=function(e,f,g,h){if("number"!=typeof g)throw new TypeError("Iterations not a number");if(0>g)throw new TypeError("Bad iterations");if("number"!=typeof h)throw new TypeError("Key length not a number");if(0>h)throw new TypeError("Bad key length");var e=a.isBuffer(e)?e:new a(e);e.length>c?e=createHash(alg).update(e).digest():e.length<c&&(e=a.concat([e,d],c));var i,j,k,l=0,m=1,n=new a(4),o=new a(h);for(o.fill(0);h;){j=h>20?20:h,n[0]=m>>24&255,n[1]=m>>16&255,n[2]=m>>8&255,n[3]=255&m,i=b("sha1",e),i.update(f),i.update(n),k=i.digest(),k.copy(o,l,0,j);for(var p=1;g>p;p++){i=b("sha1",e),i.update(k),k=i.digest();for(var q=0;j>q;q++)o[q]^=k[q]}h-=j,m++,l+=j}return o},e}}).call(this,a("buffer").Buffer)},{buffer:29}],44:[function(a,b){(function(a){!function(){var c,d,e=this;c=function(b){for(var c,c,d=new a(b),e=0;b>e;e++)0==(3&e)&&(c=4294967296*Math.random()),d[e]=c>>>((3&e)<<3)&255;return d},e.crypto&&crypto.getRandomValues&&(d=function(b){var c=new a(b);return crypto.getRandomValues(c),c}),b.exports=d||c}()}).call(this,a("buffer").Buffer)},{buffer:29}],45:[function(a,b){function c(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function d(a){return"function"==typeof a}function e(a){return"number"==typeof a}function f(a){return"object"==typeof a&&null!==a}function g(a){return void 0===a}b.exports=c,c.EventEmitter=c,c.prototype._events=void 0,c.prototype._maxListeners=void 0,c.defaultMaxListeners=10,c.prototype.setMaxListeners=function(a){if(!e(a)||0>a||isNaN(a))throw TypeError("n must be a positive number");return this._maxListeners=a,this},c.prototype.emit=function(a){var b,c,e,h,i,j;if(this._events||(this._events={}),"error"===a&&(!this._events.error||f(this._events.error)&&!this._events.error.length))throw b=arguments[1],b instanceof Error?b:TypeError('Uncaught, unspecified "error" event.');if(c=this._events[a],g(c))return!1;if(d(c))switch(arguments.length){case 1:c.call(this);break;case 2:c.call(this,arguments[1]);break;case 3:c.call(this,arguments[1],arguments[2]);break;default:for(e=arguments.length,h=new Array(e-1),i=1;e>i;i++)h[i-1]=arguments[i];c.apply(this,h)}else if(f(c)){for(e=arguments.length,h=new Array(e-1),i=1;e>i;i++)h[i-1]=arguments[i];for(j=c.slice(),e=j.length,i=0;e>i;i++)j[i].apply(this,h)}return!0},c.prototype.addListener=function(a,b){var e;if(!d(b))throw TypeError("listener must be a function");if(this._events||(this._events={}),this._events.newListener&&this.emit("newListener",a,d(b.listener)?b.listener:b),this._events[a]?f(this._events[a])?this._events[a].push(b):this._events[a]=[this._events[a],b]:this._events[a]=b,f(this._events[a])&&!this._events[a].warned){var e;e=g(this._maxListeners)?c.defaultMaxListeners:this._maxListeners,e&&e>0&&this._events[a].length>e&&(this._events[a].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[a].length),"function"==typeof console.trace&&console.trace())}return this},c.prototype.on=c.prototype.addListener,c.prototype.once=function(a,b){function c(){this.removeListener(a,c),e||(e=!0,b.apply(this,arguments))}if(!d(b))throw TypeError("listener must be a function");var e=!1;return c.listener=b,this.on(a,c),this},c.prototype.removeListener=function(a,b){var c,e,g,h;if(!d(b))throw TypeError("listener must be a function");if(!this._events||!this._events[a])return this;if(c=this._events[a],g=c.length,e=-1,c===b||d(c.listener)&&c.listener===b)delete this._events[a],this._events.removeListener&&this.emit("removeListener",a,b);else if(f(c)){for(h=g;h-->0;)if(c[h]===b||c[h].listener&&c[h].listener===b){e=h;break}if(0>e)return this;1===c.length?(c.length=0,delete this._events[a]):c.splice(e,1),this._events.removeListener&&this.emit("removeListener",a,b)}return this},c.prototype.removeAllListeners=function(a){var b,c;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[a]&&delete this._events[a],this;if(0===arguments.length){for(b in this._events)"removeListener"!==b&&this.removeAllListeners(b);return this.removeAllListeners("removeListener"),this._events={},this}if(c=this._events[a],d(c))this.removeListener(a,c);else for(;c.length;)this.removeListener(a,c[c.length-1]);return delete this._events[a],this},c.prototype.listeners=function(a){var b;return b=this._events&&this._events[a]?d(this._events[a])?[this._events[a]]:this._events[a].slice():[]},c.listenerCount=function(a,b){var c;return c=a._events&&a._events[b]?d(a._events[b])?1:a._events[b].length:0}},{}],46:[function(a,b){var c=b.exports,d=(a("events").EventEmitter,a("./lib/request")),e=a("url");c.request=function(a,b){"string"==typeof a&&(a=e.parse(a)),a||(a={}),a.host||a.port||(a.port=parseInt(window.location.port,10)),!a.host&&a.hostname&&(a.host=a.hostname),a.scheme||(a.scheme=window.location.protocol.split(":")[0]),a.host||(a.host=window.location.hostname||window.location.host),/:/.test(a.host)&&(a.port||(a.port=a.host.split(":")[1]),a.host=a.host.split(":")[0]),a.port||(a.port="https"==a.scheme?443:80);var c=new d(new f,a);return b&&c.on("response",b),c},c.get=function(a,b){a.method="GET";var d=c.request(a,b);return d.end(),d},c.Agent=function(){},c.Agent.defaultMaxSockets=4;var f=function(){if("undefined"==typeof window)throw new Error("no window object present");if(window.XMLHttpRequest)return window.XMLHttpRequest;if(window.ActiveXObject){for(var a=["Msxml2.XMLHTTP.6.0","Msxml2.XMLHTTP.3.0","Microsoft.XMLHTTP"],b=0;b<a.length;b++)try{var c=new window.ActiveXObject(a[b]);return function(){if(c){var d=c;return c=null,d}return new window.ActiveXObject(a[b])}}catch(d){}throw new Error("ajax not supported in this browser")}throw new Error("ajax not supported in this browser")}();c.STATUS_CODES={100:"Continue",101:"Switching Protocols",102:"Processing",200:"OK",201:"Created",202:"Accepted",203:"Non-Authoritative Information",204:"No Content",205:"Reset Content",206:"Partial Content",207:"Multi-Status",300:"Multiple Choices",301:"Moved Permanently",302:"Moved Temporarily",303:"See Other",304:"Not Modified",305:"Use Proxy",307:"Temporary Redirect",400:"Bad Request",401:"Unauthorized",402:"Payment Required",403:"Forbidden",404:"Not Found",405:"Method Not Allowed",406:"Not Acceptable",407:"Proxy Authentication Required",408:"Request Time-out",409:"Conflict",410:"Gone",411:"Length Required",412:"Precondition Failed",413:"Request Entity Too Large",414:"Request-URI Too Large",415:"Unsupported Media Type",416:"Requested Range Not Satisfiable",417:"Expectation Failed",418:"I'm a teapot",422:"Unprocessable Entity",423:"Locked",424:"Failed Dependency",425:"Unordered Collection",426:"Upgrade Required",428:"Precondition Required",429:"Too Many Requests",431:"Request Header Fields Too Large",500:"Internal Server Error",501:"Not Implemented",502:"Bad Gateway",503:"Service Unavailable",504:"Gateway Time-out",505:"HTTP Version Not Supported",506:"Variant Also Negotiates",507:"Insufficient Storage",509:"Bandwidth Limit Exceeded",510:"Not Extended",511:"Network Authentication Required"}
},{"./lib/request":47,events:45,url:70}],47:[function(a,b){var c=a("stream"),d=a("./response"),e=a("Base64"),f=a("inherits"),g=b.exports=function(a,b){var c=this;c.writable=!0,c.xhr=a,c.body=[],c.uri=(b.scheme||"http")+"://"+b.host+(b.port?":"+b.port:"")+(b.path||"/"),"undefined"==typeof b.withCredentials&&(b.withCredentials=!0);try{a.withCredentials=b.withCredentials}catch(f){}if(b.responseType)try{a.responseType=b.responseType}catch(f){}if(a.open(b.method||"GET",c.uri,!0),c._headers={},b.headers)for(var g=h(b.headers),i=0;i<g.length;i++){var j=g[i];if(c.isSafeRequestHeader(j)){var k=b.headers[j];c.setHeader(j,k)}}b.auth&&this.setHeader("Authorization","Basic "+e.btoa(b.auth));var l=new d;l.on("close",function(){c.emit("close")}),l.on("ready",function(){c.emit("response",l)}),a.onreadystatechange=function(){a.__aborted||l.handle(a)}};f(g,c),g.prototype.setHeader=function(a,b){this._headers[a.toLowerCase()]=b},g.prototype.getHeader=function(a){return this._headers[a.toLowerCase()]},g.prototype.removeHeader=function(a){delete this._headers[a.toLowerCase()]},g.prototype.write=function(a){this.body.push(a)},g.prototype.destroy=function(){this.xhr.__aborted=!0,this.xhr.abort(),this.emit("close")},g.prototype.end=function(a){void 0!==a&&this.body.push(a);for(var b=h(this._headers),c=0;c<b.length;c++){var d=b[c],e=this._headers[d];if(i(e))for(var f=0;f<e.length;f++)this.xhr.setRequestHeader(d,e[f]);else this.xhr.setRequestHeader(d,e)}if(0===this.body.length)this.xhr.send("");else if("string"==typeof this.body[0])this.xhr.send(this.body.join(""));else if(i(this.body[0])){for(var g=[],c=0;c<this.body.length;c++)g.push.apply(g,this.body[c]);this.xhr.send(g)}else if(/Array/.test(Object.prototype.toString.call(this.body[0]))){for(var j=0,c=0;c<this.body.length;c++)j+=this.body[c].length;for(var g=new this.body[0].constructor(j),k=0,c=0;c<this.body.length;c++)for(var l=this.body[c],f=0;f<l.length;f++)g[k++]=l[f];this.xhr.send(g)}else{for(var g="",c=0;c<this.body.length;c++)g+=this.body[c].toString();this.xhr.send(g)}},g.unsafeHeaders=["accept-charset","accept-encoding","access-control-request-headers","access-control-request-method","connection","content-length","cookie","cookie2","content-transfer-encoding","date","expect","host","keep-alive","origin","referer","te","trailer","transfer-encoding","upgrade","user-agent","via"],g.prototype.isSafeRequestHeader=function(a){return a?-1===j(g.unsafeHeaders,a.toLowerCase()):!1};var h=Object.keys||function(a){var b=[];for(var c in a)b.push(c);return b},i=Array.isArray||function(a){return"[object Array]"===Object.prototype.toString.call(a)},j=function(a,b){if(a.indexOf)return a.indexOf(b);for(var c=0;c<a.length;c++)if(a[c]===b)return c;return-1}},{"./response":48,Base64:49,inherits:50,stream:69}],48:[function(a,b){function c(a){for(var b=a.getAllResponseHeaders().split(/\r?\n/),c={},d=0;d<b.length;d++){var e=b[d];if(""!==e){var f=e.match(/^([^:]+):\s*(.*)/);if(f){var g=f[1].toLowerCase(),i=f[2];void 0!==c[g]?h(c[g])?c[g].push(i):c[g]=[c[g],i]:c[g]=i}else c[e]=!0}}return c}var d=a("stream"),e=a("util"),f=b.exports=function(){this.offset=0,this.readable=!0};e.inherits(f,d);var g={streaming:!0,status2:!0};f.prototype.getResponse=function(a){var b=String(a.responseType).toLowerCase();return"blob"===b?a.responseBlob||a.response:"arraybuffer"===b?a.response:a.responseText},f.prototype.getHeader=function(a){return this.headers[a.toLowerCase()]},f.prototype.handle=function(a){if(2===a.readyState&&g.status2){try{this.statusCode=a.status,this.headers=c(a)}catch(b){g.status2=!1}g.status2&&this.emit("ready")}else if(g.streaming&&3===a.readyState){try{this.statusCode||(this.statusCode=a.status,this.headers=c(a),this.emit("ready"))}catch(b){}try{this._emitData(a)}catch(b){g.streaming=!1}}else 4===a.readyState&&(this.statusCode||(this.statusCode=a.status,this.emit("ready")),this._emitData(a),a.error?this.emit("error",this.getResponse(a)):this.emit("end"),this.emit("close"))},f.prototype._emitData=function(a){var b=this.getResponse(a);return b.toString().match(/ArrayBuffer/)?(this.emit("data",new Uint8Array(b,this.offset)),void(this.offset=b.byteLength)):void(b.length>this.offset&&(this.emit("data",b.slice(this.offset)),this.offset=b.length))};var h=Array.isArray||function(a){return"[object Array]"===Object.prototype.toString.call(a)}},{stream:69,util:72}],49:[function(a,b,c){!function(){function a(a){this.message=a}var b="undefined"!=typeof c?c:this,d="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";a.prototype=new Error,a.prototype.name="InvalidCharacterError",b.btoa||(b.btoa=function(b){for(var c,e,f=0,g=d,h="";b.charAt(0|f)||(g="=",f%1);h+=g.charAt(63&c>>8-f%1*8)){if(e=b.charCodeAt(f+=.75),e>255)throw new a("'btoa' failed: The string to be encoded contains characters outside of the Latin1 range.");c=c<<8|e}return h}),b.atob||(b.atob=function(b){if(b=b.replace(/=+$/,""),b.length%4==1)throw new a("'atob' failed: The string to be decoded is not correctly encoded.");for(var c,e,f=0,g=0,h="";e=b.charAt(g++);~e&&(c=f%4?64*c+e:e,f++%4)?h+=String.fromCharCode(255&c>>(-2*f&6)):0)e=d.indexOf(e);return h})}()},{}],50:[function(a,b){b.exports="function"==typeof Object.create?function(a,b){a.super_=b,a.prototype=Object.create(b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}})}:function(a,b){a.super_=b;var c=function(){};c.prototype=b.prototype,a.prototype=new c,a.prototype.constructor=a}},{}],51:[function(a,b){function c(){}var d=b.exports={};d.nextTick=function(){var a="undefined"!=typeof window&&window.setImmediate,b="undefined"!=typeof window&&window.postMessage&&window.addEventListener;if(a)return function(a){return window.setImmediate(a)};if(b){var c=[];return window.addEventListener("message",function(a){var b=a.source;if((b===window||null===b)&&"process-tick"===a.data&&(a.stopPropagation(),c.length>0)){var d=c.shift();d()}},!0),function(a){c.push(a),window.postMessage("process-tick","*")}}return function(a){setTimeout(a,0)}}(),d.title="browser",d.browser=!0,d.env={},d.argv=[],d.on=c,d.addListener=c,d.once=c,d.off=c,d.removeListener=c,d.removeAllListeners=c,d.emit=c,d.binding=function(){throw new Error("process.binding is not supported")},d.cwd=function(){return"/"},d.chdir=function(){throw new Error("process.chdir is not supported")}},{}],52:[function(a,b,c){(function(a){!function(d){function e(a){throw RangeError(H[a])}function f(a,b){for(var c=a.length;c--;)a[c]=b(a[c]);return a}function g(a,b){return f(a.split(G),b).join(".")}function h(a){for(var b,c,d=[],e=0,f=a.length;f>e;)b=a.charCodeAt(e++),b>=55296&&56319>=b&&f>e?(c=a.charCodeAt(e++),56320==(64512&c)?d.push(((1023&b)<<10)+(1023&c)+65536):(d.push(b),e--)):d.push(b);return d}function i(a){return f(a,function(a){var b="";return a>65535&&(a-=65536,b+=K(a>>>10&1023|55296),a=56320|1023&a),b+=K(a)}).join("")}function j(a){return 10>a-48?a-22:26>a-65?a-65:26>a-97?a-97:w}function k(a,b){return a+22+75*(26>a)-((0!=b)<<5)}function l(a,b,c){var d=0;for(a=c?J(a/A):a>>1,a+=J(a/b);a>I*y>>1;d+=w)a=J(a/I);return J(d+(I+1)*a/(a+z))}function m(a){var b,c,d,f,g,h,k,m,n,o,p=[],q=a.length,r=0,s=C,t=B;for(c=a.lastIndexOf(D),0>c&&(c=0),d=0;c>d;++d)a.charCodeAt(d)>=128&&e("not-basic"),p.push(a.charCodeAt(d));for(f=c>0?c+1:0;q>f;){for(g=r,h=1,k=w;f>=q&&e("invalid-input"),m=j(a.charCodeAt(f++)),(m>=w||m>J((v-r)/h))&&e("overflow"),r+=m*h,n=t>=k?x:k>=t+y?y:k-t,!(n>m);k+=w)o=w-n,h>J(v/o)&&e("overflow"),h*=o;b=p.length+1,t=l(r-g,b,0==g),J(r/b)>v-s&&e("overflow"),s+=J(r/b),r%=b,p.splice(r++,0,s)}return i(p)}function n(a){var b,c,d,f,g,i,j,m,n,o,p,q,r,s,t,u=[];for(a=h(a),q=a.length,b=C,c=0,g=B,i=0;q>i;++i)p=a[i],128>p&&u.push(K(p));for(d=f=u.length,f&&u.push(D);q>d;){for(j=v,i=0;q>i;++i)p=a[i],p>=b&&j>p&&(j=p);for(r=d+1,j-b>J((v-c)/r)&&e("overflow"),c+=(j-b)*r,b=j,i=0;q>i;++i)if(p=a[i],b>p&&++c>v&&e("overflow"),p==b){for(m=c,n=w;o=g>=n?x:n>=g+y?y:n-g,!(o>m);n+=w)t=m-o,s=w-o,u.push(K(k(o+t%s,0))),m=J(t/s);u.push(K(k(m,0))),g=l(c,r,d==f),c=0,++d}++c,++b}return u.join("")}function o(a){return g(a,function(a){return E.test(a)?m(a.slice(4).toLowerCase()):a})}function p(a){return g(a,function(a){return F.test(a)?"xn--"+n(a):a})}var q="object"==typeof c&&c,r="object"==typeof b&&b&&b.exports==q&&b,s="object"==typeof a&&a;(s.global===s||s.window===s)&&(d=s);var t,u,v=2147483647,w=36,x=1,y=26,z=38,A=700,B=72,C=128,D="-",E=/^xn--/,F=/[^ -~]/,G=/\x2E|\u3002|\uFF0E|\uFF61/g,H={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},I=w-x,J=Math.floor,K=String.fromCharCode;if(t={version:"1.2.4",ucs2:{decode:h,encode:i},decode:m,encode:n,toASCII:p,toUnicode:o},"function"==typeof define&&"object"==typeof define.amd&&define.amd)define("punycode",function(){return t});else if(q&&!q.nodeType)if(r)r.exports=t;else for(u in t)t.hasOwnProperty(u)&&(q[u]=t[u]);else d.punycode=t}(this)}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],53:[function(a,b){"use strict";function c(a,b){return Object.prototype.hasOwnProperty.call(a,b)}b.exports=function(a,b,e,f){b=b||"&",e=e||"=";var g={};if("string"!=typeof a||0===a.length)return g;var h=/\+/g;a=a.split(b);var i=1e3;f&&"number"==typeof f.maxKeys&&(i=f.maxKeys);var j=a.length;i>0&&j>i&&(j=i);for(var k=0;j>k;++k){var l,m,n,o,p=a[k].replace(h,"%20"),q=p.indexOf(e);q>=0?(l=p.substr(0,q),m=p.substr(q+1)):(l=p,m=""),n=decodeURIComponent(l),o=decodeURIComponent(m),c(g,n)?d(g[n])?g[n].push(o):g[n]=[g[n],o]:g[n]=o}return g};var d=Array.isArray||function(a){return"[object Array]"===Object.prototype.toString.call(a)}},{}],54:[function(a,b){"use strict";function c(a,b){if(a.map)return a.map(b);for(var c=[],d=0;d<a.length;d++)c.push(b(a[d],d));return c}var d=function(a){switch(typeof a){case"string":return a;case"boolean":return a?"true":"false";case"number":return isFinite(a)?a:"";default:return""}};b.exports=function(a,b,g,h){return b=b||"&",g=g||"=",null===a&&(a=void 0),"object"==typeof a?c(f(a),function(f){var h=encodeURIComponent(d(f))+g;return e(a[f])?c(a[f],function(a){return h+encodeURIComponent(d(a))}).join(b):h+encodeURIComponent(d(a[f]))}).join(b):h?encodeURIComponent(d(h))+g+encodeURIComponent(d(a)):""};var e=Array.isArray||function(a){return"[object Array]"===Object.prototype.toString.call(a)},f=Object.keys||function(a){var b=[];for(var c in a)Object.prototype.hasOwnProperty.call(a,c)&&b.push(c);return b}},{}],55:[function(a,b,c){"use strict";c.decode=c.parse=a("./decode"),c.encode=c.stringify=a("./encode")},{"./decode":53,"./encode":54}],56:[function(a,b){b.exports=a("./lib/_stream_duplex.js")},{"./lib/_stream_duplex.js":57}],57:[function(a,b){(function(c){function d(a){return this instanceof d?(i.call(this,a),j.call(this,a),a&&a.readable===!1&&(this.readable=!1),a&&a.writable===!1&&(this.writable=!1),this.allowHalfOpen=!0,a&&a.allowHalfOpen===!1&&(this.allowHalfOpen=!1),void this.once("end",e)):new d(a)}function e(){this.allowHalfOpen||this._writableState.ended||c.nextTick(this.end.bind(this))}function f(a,b){for(var c=0,d=a.length;d>c;c++)b(a[c],c)}b.exports=d;var g=Object.keys||function(a){var b=[];for(var c in a)b.push(c);return b},h=a("core-util-is");h.inherits=a("inherits");var i=a("./_stream_readable"),j=a("./_stream_writable");h.inherits(d,i),f(g(j.prototype),function(a){d.prototype[a]||(d.prototype[a]=j.prototype[a])})}).call(this,a("sycGbZ"))},{"./_stream_readable":59,"./_stream_writable":61,"core-util-is":62,inherits:50,sycGbZ:51}],58:[function(a,b){function c(a){return this instanceof c?void d.call(this,a):new c(a)}b.exports=c;var d=a("./_stream_transform"),e=a("core-util-is");e.inherits=a("inherits"),e.inherits(c,d),c.prototype._transform=function(a,b,c){c(null,a)}},{"./_stream_transform":60,"core-util-is":62,inherits:50}],59:[function(a,b){(function(c){function d(b){b=b||{};var c=b.highWaterMark;this.highWaterMark=c||0===c?c:16384,this.highWaterMark=~~this.highWaterMark,this.buffer=[],this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=!1,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.calledRead=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.objectMode=!!b.objectMode,this.defaultEncoding=b.defaultEncoding||"utf8",this.ranOut=!1,this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,b.encoding&&(C||(C=a("string_decoder/").StringDecoder),this.decoder=new C(b.encoding),this.encoding=b.encoding)}function e(a){return this instanceof e?(this._readableState=new d(a,this),this.readable=!0,void A.call(this)):new e(a)}function f(a,b,c,d,e){var f=j(b,c);if(f)a.emit("error",f);else if(null===c||void 0===c)b.reading=!1,b.ended||k(a,b);else if(b.objectMode||c&&c.length>0)if(b.ended&&!e){var h=new Error("stream.push() after EOF");a.emit("error",h)}else if(b.endEmitted&&e){var h=new Error("stream.unshift() after end event");a.emit("error",h)}else!b.decoder||e||d||(c=b.decoder.write(c)),b.length+=b.objectMode?1:c.length,e?b.buffer.unshift(c):(b.reading=!1,b.buffer.push(c)),b.needReadable&&l(a),n(a,b);else e||(b.reading=!1);return g(b)}function g(a){return!a.ended&&(a.needReadable||a.length<a.highWaterMark||0===a.length)}function h(a){if(a>=D)a=D;else{a--;for(var b=1;32>b;b<<=1)a|=a>>b;a++}return a}function i(a,b){return 0===b.length&&b.ended?0:b.objectMode?0===a?0:1:isNaN(a)||null===a?b.flowing&&b.buffer.length?b.buffer[0].length:b.length:0>=a?0:(a>b.highWaterMark&&(b.highWaterMark=h(a)),a>b.length?b.ended?b.length:(b.needReadable=!0,0):a)}function j(a,b){var c=null;return y.isBuffer(b)||"string"==typeof b||null===b||void 0===b||a.objectMode||c||(c=new TypeError("Invalid non-string/buffer chunk")),c}function k(a,b){if(b.decoder&&!b.ended){var c=b.decoder.end();c&&c.length&&(b.buffer.push(c),b.length+=b.objectMode?1:c.length)}b.ended=!0,b.length>0?l(a):u(a)}function l(a){var b=a._readableState;b.needReadable=!1,b.emittedReadable||(b.emittedReadable=!0,b.sync?c.nextTick(function(){m(a)}):m(a))}function m(a){a.emit("readable")}function n(a,b){b.readingMore||(b.readingMore=!0,c.nextTick(function(){o(a,b)}))}function o(a,b){for(var c=b.length;!b.reading&&!b.flowing&&!b.ended&&b.length<b.highWaterMark&&(a.read(0),c!==b.length);)c=b.length;b.readingMore=!1}function p(a){return function(){var b=a._readableState;b.awaitDrain--,0===b.awaitDrain&&q(a)}}function q(a){function b(a){var b=a.write(c);!1===b&&d.awaitDrain++}var c,d=a._readableState;for(d.awaitDrain=0;d.pipesCount&&null!==(c=a.read());)if(1===d.pipesCount?b(d.pipes,0,null):v(d.pipes,b),a.emit("data",c),d.awaitDrain>0)return;return 0===d.pipesCount?(d.flowing=!1,void(z.listenerCount(a,"data")>0&&s(a))):void(d.ranOut=!0)}function r(){this._readableState.ranOut&&(this._readableState.ranOut=!1,q(this))}function s(a,b){var d=a._readableState;if(d.flowing)throw new Error("Cannot switch to old mode now.");var e=b||!1,f=!1;a.readable=!0,a.pipe=A.prototype.pipe,a.on=a.addListener=A.prototype.on,a.on("readable",function(){f=!0;for(var b;!e&&null!==(b=a.read());)a.emit("data",b);null===b&&(f=!1,a._readableState.needReadable=!0)}),a.pause=function(){e=!0,this.emit("pause")},a.resume=function(){e=!1,f?c.nextTick(function(){a.emit("readable")}):this.read(0),this.emit("resume")},a.emit("readable")}function t(a,b){var c,d=b.buffer,e=b.length,f=!!b.decoder,g=!!b.objectMode;if(0===d.length)return null;if(0===e)c=null;else if(g)c=d.shift();else if(!a||a>=e)c=f?d.join(""):y.concat(d,e),d.length=0;else if(a<d[0].length){var h=d[0];c=h.slice(0,a),d[0]=h.slice(a)}else if(a===d[0].length)c=d.shift();else{c=f?"":new y(a);for(var i=0,j=0,k=d.length;k>j&&a>i;j++){var h=d[0],l=Math.min(a-i,h.length);f?c+=h.slice(0,l):h.copy(c,i,0,l),l<h.length?d[0]=h.slice(l):d.shift(),i+=l}}return c}function u(a){var b=a._readableState;if(b.length>0)throw new Error("endReadable called on non-empty stream");!b.endEmitted&&b.calledRead&&(b.ended=!0,c.nextTick(function(){b.endEmitted||0!==b.length||(b.endEmitted=!0,a.readable=!1,a.emit("end"))}))}function v(a,b){for(var c=0,d=a.length;d>c;c++)b(a[c],c)}function w(a,b){for(var c=0,d=a.length;d>c;c++)if(a[c]===b)return c;return-1}b.exports=e;var x=a("isarray"),y=a("buffer").Buffer;e.ReadableState=d;var z=a("events").EventEmitter;z.listenerCount||(z.listenerCount=function(a,b){return a.listeners(b).length});var A=a("stream"),B=a("core-util-is");B.inherits=a("inherits");var C;B.inherits(e,A),e.prototype.push=function(a,b){var c=this._readableState;return"string"!=typeof a||c.objectMode||(b=b||c.defaultEncoding,b!==c.encoding&&(a=new y(a,b),b="")),f(this,c,a,b,!1)},e.prototype.unshift=function(a){var b=this._readableState;return f(this,b,a,"",!0)},e.prototype.setEncoding=function(b){C||(C=a("string_decoder/").StringDecoder),this._readableState.decoder=new C(b),this._readableState.encoding=b};var D=8388608;e.prototype.read=function(a){var b=this._readableState;b.calledRead=!0;var c=a;if(("number"!=typeof a||a>0)&&(b.emittedReadable=!1),0===a&&b.needReadable&&(b.length>=b.highWaterMark||b.ended))return l(this),null;if(a=i(a,b),0===a&&b.ended)return 0===b.length&&u(this),null;var d=b.needReadable;b.length-a<=b.highWaterMark&&(d=!0),(b.ended||b.reading)&&(d=!1),d&&(b.reading=!0,b.sync=!0,0===b.length&&(b.needReadable=!0),this._read(b.highWaterMark),b.sync=!1),d&&!b.reading&&(a=i(c,b));var e;return e=a>0?t(a,b):null,null===e&&(b.needReadable=!0,a=0),b.length-=a,0!==b.length||b.ended||(b.needReadable=!0),b.ended&&!b.endEmitted&&0===b.length&&u(this),e},e.prototype._read=function(){this.emit("error",new Error("not implemented"))},e.prototype.pipe=function(a,b){function d(a){a===k&&f()}function e(){a.end()}function f(){a.removeListener("close",h),a.removeListener("finish",i),a.removeListener("drain",o),a.removeListener("error",g),a.removeListener("unpipe",d),k.removeListener("end",e),k.removeListener("end",f),(!a._writableState||a._writableState.needDrain)&&o()}function g(b){j(),a.removeListener("error",g),0===z.listenerCount(a,"error")&&a.emit("error",b)}function h(){a.removeListener("finish",i),j()}function i(){a.removeListener("close",h),j()}function j(){k.unpipe(a)}var k=this,l=this._readableState;switch(l.pipesCount){case 0:l.pipes=a;break;case 1:l.pipes=[l.pipes,a];break;default:l.pipes.push(a)}l.pipesCount+=1;var m=(!b||b.end!==!1)&&a!==c.stdout&&a!==c.stderr,n=m?e:f;l.endEmitted?c.nextTick(n):k.once("end",n),a.on("unpipe",d);var o=p(k);return a.on("drain",o),a._events&&a._events.error?x(a._events.error)?a._events.error.unshift(g):a._events.error=[g,a._events.error]:a.on("error",g),a.once("close",h),a.once("finish",i),a.emit("pipe",k),l.flowing||(this.on("readable",r),l.flowing=!0,c.nextTick(function(){q(k)})),a},e.prototype.unpipe=function(a){var b=this._readableState;if(0===b.pipesCount)return this;if(1===b.pipesCount)return a&&a!==b.pipes?this:(a||(a=b.pipes),b.pipes=null,b.pipesCount=0,this.removeListener("readable",r),b.flowing=!1,a&&a.emit("unpipe",this),this);if(!a){var c=b.pipes,d=b.pipesCount;b.pipes=null,b.pipesCount=0,this.removeListener("readable",r),b.flowing=!1;for(var e=0;d>e;e++)c[e].emit("unpipe",this);return this}var e=w(b.pipes,a);return-1===e?this:(b.pipes.splice(e,1),b.pipesCount-=1,1===b.pipesCount&&(b.pipes=b.pipes[0]),a.emit("unpipe",this),this)},e.prototype.on=function(a,b){var c=A.prototype.on.call(this,a,b);if("data"!==a||this._readableState.flowing||s(this),"readable"===a&&this.readable){var d=this._readableState;d.readableListening||(d.readableListening=!0,d.emittedReadable=!1,d.needReadable=!0,d.reading?d.length&&l(this,d):this.read(0))}return c},e.prototype.addListener=e.prototype.on,e.prototype.resume=function(){s(this),this.read(0),this.emit("resume")},e.prototype.pause=function(){s(this,!0),this.emit("pause")},e.prototype.wrap=function(a){var b=this._readableState,c=!1,d=this;a.on("end",function(){if(b.decoder&&!b.ended){var a=b.decoder.end();a&&a.length&&d.push(a)}d.push(null)}),a.on("data",function(e){if(b.decoder&&(e=b.decoder.write(e)),e&&(b.objectMode||e.length)){var f=d.push(e);f||(c=!0,a.pause())}});for(var e in a)"function"==typeof a[e]&&"undefined"==typeof this[e]&&(this[e]=function(b){return function(){return a[b].apply(a,arguments)}}(e));var f=["error","close","destroy","pause","resume"];return v(f,function(b){a.on(b,d.emit.bind(d,b))}),d._read=function(){c&&(c=!1,a.resume())},d},e._fromList=t}).call(this,a("sycGbZ"))},{buffer:29,"core-util-is":62,events:45,inherits:50,isarray:63,stream:69,"string_decoder/":64,sycGbZ:51}],60:[function(a,b){function c(a,b){this.afterTransform=function(a,c){return d(b,a,c)},this.needTransform=!1,this.transforming=!1,this.writecb=null,this.writechunk=null}function d(a,b,c){var d=a._transformState;d.transforming=!1;var e=d.writecb;if(!e)return a.emit("error",new Error("no writecb in Transform class"));d.writechunk=null,d.writecb=null,null!==c&&void 0!==c&&a.push(c),e&&e(b);var f=a._readableState;f.reading=!1,(f.needReadable||f.length<f.highWaterMark)&&a._read(f.highWaterMark)}function e(a){if(!(this instanceof e))return new e(a);g.call(this,a);var b=(this._transformState=new c(a,this),this);this._readableState.needReadable=!0,this._readableState.sync=!1,this.once("finish",function(){"function"==typeof this._flush?this._flush(function(a){f(b,a)}):f(b)})}function f(a,b){if(b)return a.emit("error",b);var c=a._writableState,d=(a._readableState,a._transformState);if(c.length)throw new Error("calling transform done when ws.length != 0");if(d.transforming)throw new Error("calling transform done when still transforming");return a.push(null)}b.exports=e;var g=a("./_stream_duplex"),h=a("core-util-is");h.inherits=a("inherits"),h.inherits(e,g),e.prototype.push=function(a,b){return this._transformState.needTransform=!1,g.prototype.push.call(this,a,b)},e.prototype._transform=function(){throw new Error("not implemented")},e.prototype._write=function(a,b,c){var d=this._transformState;if(d.writecb=c,d.writechunk=a,d.writeencoding=b,!d.transforming){var e=this._readableState;(d.needTransform||e.needReadable||e.length<e.highWaterMark)&&this._read(e.highWaterMark)}},e.prototype._read=function(){var a=this._transformState;null!==a.writechunk&&a.writecb&&!a.transforming?(a.transforming=!0,this._transform(a.writechunk,a.writeencoding,a.afterTransform)):a.needTransform=!0}},{"./_stream_duplex":57,"core-util-is":62,inherits:50}],61:[function(a,b){(function(c){function d(a,b,c){this.chunk=a,this.encoding=b,this.callback=c}function e(a,b){a=a||{};var c=a.highWaterMark;this.highWaterMark=c||0===c?c:16384,this.objectMode=!!a.objectMode,this.highWaterMark=~~this.highWaterMark,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1;var d=a.decodeStrings===!1;this.decodeStrings=!d,this.defaultEncoding=a.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(a){n(b,a)},this.writecb=null,this.writelen=0,this.buffer=[],this.errorEmitted=!1}function f(b){var c=a("./_stream_duplex");return this instanceof f||this instanceof c?(this._writableState=new e(b,this),this.writable=!0,void w.call(this)):new f(b)}function g(a,b,d){var e=new Error("write after end");a.emit("error",e),c.nextTick(function(){d(e)})}function h(a,b,d,e){var f=!0;if(!u.isBuffer(d)&&"string"!=typeof d&&null!==d&&void 0!==d&&!b.objectMode){var g=new TypeError("Invalid non-string/buffer chunk");a.emit("error",g),c.nextTick(function(){e(g)}),f=!1}return f}function i(a,b,c){return a.objectMode||a.decodeStrings===!1||"string"!=typeof b||(b=new u(b,c)),b}function j(a,b,c,e,f){c=i(b,c,e),u.isBuffer(c)&&(e="buffer");var g=b.objectMode?1:c.length;b.length+=g;var h=b.length<b.highWaterMark;return h||(b.needDrain=!0),b.writing?b.buffer.push(new d(c,e,f)):k(a,b,g,c,e,f),h}function k(a,b,c,d,e,f){b.writelen=c,b.writecb=f,b.writing=!0,b.sync=!0,a._write(d,e,b.onwrite),b.sync=!1}function l(a,b,d,e,f){d?c.nextTick(function(){f(e)}):f(e),a._writableState.errorEmitted=!0,a.emit("error",e)}function m(a){a.writing=!1,a.writecb=null,a.length-=a.writelen,a.writelen=0}function n(a,b){var d=a._writableState,e=d.sync,f=d.writecb;if(m(d),b)l(a,d,e,b,f);else{var g=r(a,d);g||d.bufferProcessing||!d.buffer.length||q(a,d),e?c.nextTick(function(){o(a,d,g,f)}):o(a,d,g,f)}}function o(a,b,c,d){c||p(a,b),d(),c&&s(a,b)}function p(a,b){0===b.length&&b.needDrain&&(b.needDrain=!1,a.emit("drain"))}function q(a,b){b.bufferProcessing=!0;for(var c=0;c<b.buffer.length;c++){var d=b.buffer[c],e=d.chunk,f=d.encoding,g=d.callback,h=b.objectMode?1:e.length;if(k(a,b,h,e,f,g),b.writing){c++;break}}b.bufferProcessing=!1,c<b.buffer.length?b.buffer=b.buffer.slice(c):b.buffer.length=0}function r(a,b){return b.ending&&0===b.length&&!b.finished&&!b.writing}function s(a,b){var c=r(a,b);return c&&(b.finished=!0,a.emit("finish")),c}function t(a,b,d){b.ending=!0,s(a,b),d&&(b.finished?c.nextTick(d):a.once("finish",d)),b.ended=!0}b.exports=f;var u=a("buffer").Buffer;f.WritableState=e;var v=a("core-util-is");v.inherits=a("inherits");var w=a("stream");v.inherits(f,w),f.prototype.pipe=function(){this.emit("error",new Error("Cannot pipe. Not readable."))},f.prototype.write=function(a,b,c){var d=this._writableState,e=!1;return"function"==typeof b&&(c=b,b=null),u.isBuffer(a)?b="buffer":b||(b=d.defaultEncoding),"function"!=typeof c&&(c=function(){}),d.ended?g(this,d,c):h(this,d,a,c)&&(e=j(this,d,a,b,c)),e},f.prototype._write=function(a,b,c){c(new Error("not implemented"))},f.prototype.end=function(a,b,c){var d=this._writableState;"function"==typeof a?(c=a,a=null,b=null):"function"==typeof b&&(c=b,b=null),"undefined"!=typeof a&&null!==a&&this.write(a,b),d.ending||d.finished||t(this,d,c)}}).call(this,a("sycGbZ"))},{"./_stream_duplex":57,buffer:29,"core-util-is":62,inherits:50,stream:69,sycGbZ:51}],62:[function(a,b,c){(function(a){function b(a){return Array.isArray(a)}function d(a){return"boolean"==typeof a}function e(a){return null===a}function f(a){return null==a}function g(a){return"number"==typeof a}function h(a){return"string"==typeof a}function i(a){return"symbol"==typeof a}function j(a){return void 0===a}function k(a){return l(a)&&"[object RegExp]"===r(a)}function l(a){return"object"==typeof a&&null!==a}function m(a){return l(a)&&"[object Date]"===r(a)}function n(a){return l(a)&&("[object Error]"===r(a)||a instanceof Error)}function o(a){return"function"==typeof a}function p(a){return null===a||"boolean"==typeof a||"number"==typeof a||"string"==typeof a||"symbol"==typeof a||"undefined"==typeof a}function q(b){return a.isBuffer(b)}function r(a){return Object.prototype.toString.call(a)}c.isArray=b,c.isBoolean=d,c.isNull=e,c.isNullOrUndefined=f,c.isNumber=g,c.isString=h,c.isSymbol=i,c.isUndefined=j,c.isRegExp=k,c.isObject=l,c.isDate=m,c.isError=n,c.isFunction=o,c.isPrimitive=p,c.isBuffer=q}).call(this,a("buffer").Buffer)},{buffer:29}],63:[function(a,b){b.exports=Array.isArray||function(a){return"[object Array]"==Object.prototype.toString.call(a)}},{}],64:[function(a,b,c){function d(a){if(a&&!i(a))throw new Error("Unknown encoding: "+a)}function e(a){return a.toString(this.encoding)}function f(a){var b=this.charReceived=a.length%2;return this.charLength=b?2:0,b}function g(a){var b=this.charReceived=a.length%3;return this.charLength=b?3:0,b}var h=a("buffer").Buffer,i=h.isEncoding||function(a){switch(a&&a.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}},j=c.StringDecoder=function(a){switch(this.encoding=(a||"utf8").toLowerCase().replace(/[-_]/,""),d(a),this.encoding){case"utf8":this.surrogateSize=3;break;case"ucs2":case"utf16le":this.surrogateSize=2,this.detectIncompleteChar=f;break;case"base64":this.surrogateSize=3,this.detectIncompleteChar=g;break;default:return void(this.write=e)}this.charBuffer=new h(6),this.charReceived=0,this.charLength=0};j.prototype.write=function(a){for(var b="",c=0;this.charLength;){var d=a.length>=this.charLength-this.charReceived?this.charLength-this.charReceived:a.length;if(a.copy(this.charBuffer,this.charReceived,c,d),this.charReceived+=d-c,c=d,this.charReceived<this.charLength)return"";b=this.charBuffer.slice(0,this.charLength).toString(this.encoding);var e=b.charCodeAt(b.length-1);if(!(e>=55296&&56319>=e)){if(this.charReceived=this.charLength=0,d==a.length)return b;a=a.slice(d,a.length);break}this.charLength+=this.surrogateSize,b=""}var f=this.detectIncompleteChar(a),g=a.length;this.charLength&&(a.copy(this.charBuffer,0,a.length-f,g),this.charReceived=f,g-=f),b+=a.toString(this.encoding,0,g);var g=b.length-1,e=b.charCodeAt(g);if(e>=55296&&56319>=e){var h=this.surrogateSize;return this.charLength+=h,this.charReceived+=h,this.charBuffer.copy(this.charBuffer,h,0,h),this.charBuffer.write(b.charAt(b.length-1),this.encoding),b.substring(0,g)}return b},j.prototype.detectIncompleteChar=function(a){for(var b=a.length>=3?3:a.length;b>0;b--){var c=a[a.length-b];if(1==b&&c>>5==6){this.charLength=2;break}if(2>=b&&c>>4==14){this.charLength=3;break}if(3>=b&&c>>3==30){this.charLength=4;break}}return b},j.prototype.end=function(a){var b="";if(a&&a.length&&(b=this.write(a)),this.charReceived){var c=this.charReceived,d=this.charBuffer,e=this.encoding;b+=d.slice(0,c).toString(e)}return b}},{buffer:29}],65:[function(a,b){b.exports=a("./lib/_stream_passthrough.js")},{"./lib/_stream_passthrough.js":58}],66:[function(a,b,c){c=b.exports=a("./lib/_stream_readable.js"),c.Readable=c,c.Writable=a("./lib/_stream_writable.js"),c.Duplex=a("./lib/_stream_duplex.js"),c.Transform=a("./lib/_stream_transform.js"),c.PassThrough=a("./lib/_stream_passthrough.js")},{"./lib/_stream_duplex.js":57,"./lib/_stream_passthrough.js":58,"./lib/_stream_readable.js":59,"./lib/_stream_transform.js":60,"./lib/_stream_writable.js":61}],67:[function(a,b){b.exports=a("./lib/_stream_transform.js")},{"./lib/_stream_transform.js":60}],68:[function(a,b){b.exports=a("./lib/_stream_writable.js")},{"./lib/_stream_writable.js":61}],69:[function(a,b){function c(){d.call(this)}b.exports=c;var d=a("events").EventEmitter,e=a("inherits");e(c,d),c.Readable=a("readable-stream/readable.js"),c.Writable=a("readable-stream/writable.js"),c.Duplex=a("readable-stream/duplex.js"),c.Transform=a("readable-stream/transform.js"),c.PassThrough=a("readable-stream/passthrough.js"),c.Stream=c,c.prototype.pipe=function(a,b){function c(b){a.writable&&!1===a.write(b)&&j.pause&&j.pause()}function e(){j.readable&&j.resume&&j.resume()}function f(){k||(k=!0,a.end())}function g(){k||(k=!0,"function"==typeof a.destroy&&a.destroy())}function h(a){if(i(),0===d.listenerCount(this,"error"))throw a}function i(){j.removeListener("data",c),a.removeListener("drain",e),j.removeListener("end",f),j.removeListener("close",g),j.removeListener("error",h),a.removeListener("error",h),j.removeListener("end",i),j.removeListener("close",i),a.removeListener("close",i)}var j=this;j.on("data",c),a.on("drain",e),a._isStdio||b&&b.end===!1||(j.on("end",f),j.on("close",g));var k=!1;return j.on("error",h),a.on("error",h),j.on("end",i),j.on("close",i),a.on("close",i),a.emit("pipe",j),a}},{events:45,inherits:50,"readable-stream/duplex.js":56,"readable-stream/passthrough.js":65,"readable-stream/readable.js":66,"readable-stream/transform.js":67,"readable-stream/writable.js":68}],70:[function(a,b,c){function d(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}function e(a,b,c){if(a&&j(a)&&a instanceof d)return a;var e=new d;return e.parse(a,b,c),e}function f(a){return i(a)&&(a=e(a)),a instanceof d?a.format():d.prototype.format.call(a)}function g(a,b){return e(a,!1,!0).resolve(b)}function h(a,b){return a?e(a,!1,!0).resolveObject(b):b}function i(a){return"string"==typeof a}function j(a){return"object"==typeof a&&null!==a}function k(a){return null===a}function l(a){return null==a}var m=a("punycode");c.parse=e,c.resolve=g,c.resolveObject=h,c.format=f,c.Url=d;var n=/^([a-z0-9.+-]+:)/i,o=/:[0-9]*$/,p=["<",">",'"',"`"," ","\r","\n","	"],q=["{","}","|","\\","^","`"].concat(p),r=["'"].concat(q),s=["%","/","?",";","#"].concat(r),t=["/","?","#"],u=255,v=/^[a-z0-9A-Z_-]{0,63}$/,w=/^([a-z0-9A-Z_-]{0,63})(.*)$/,x={javascript:!0,"javascript:":!0},y={javascript:!0,"javascript:":!0},z={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},A=a("querystring");
d.prototype.parse=function(a,b,c){if(!i(a))throw new TypeError("Parameter 'url' must be a string, not "+typeof a);var d=a;d=d.trim();var e=n.exec(d);if(e){e=e[0];var f=e.toLowerCase();this.protocol=f,d=d.substr(e.length)}if(c||e||d.match(/^\/\/[^@\/]+@[^@\/]+/)){var g="//"===d.substr(0,2);!g||e&&y[e]||(d=d.substr(2),this.slashes=!0)}if(!y[e]&&(g||e&&!z[e])){for(var h=-1,j=0;j<t.length;j++){var k=d.indexOf(t[j]);-1!==k&&(-1===h||h>k)&&(h=k)}var l,o;o=-1===h?d.lastIndexOf("@"):d.lastIndexOf("@",h),-1!==o&&(l=d.slice(0,o),d=d.slice(o+1),this.auth=decodeURIComponent(l)),h=-1;for(var j=0;j<s.length;j++){var k=d.indexOf(s[j]);-1!==k&&(-1===h||h>k)&&(h=k)}-1===h&&(h=d.length),this.host=d.slice(0,h),d=d.slice(h),this.parseHost(),this.hostname=this.hostname||"";var p="["===this.hostname[0]&&"]"===this.hostname[this.hostname.length-1];if(!p)for(var q=this.hostname.split(/\./),j=0,B=q.length;B>j;j++){var C=q[j];if(C&&!C.match(v)){for(var D="",E=0,F=C.length;F>E;E++)D+=C.charCodeAt(E)>127?"x":C[E];if(!D.match(v)){var G=q.slice(0,j),H=q.slice(j+1),I=C.match(w);I&&(G.push(I[1]),H.unshift(I[2])),H.length&&(d="/"+H.join(".")+d),this.hostname=G.join(".");break}}}if(this.hostname=this.hostname.length>u?"":this.hostname.toLowerCase(),!p){for(var J=this.hostname.split("."),K=[],j=0;j<J.length;++j){var L=J[j];K.push(L.match(/[^A-Za-z0-9_-]/)?"xn--"+m.encode(L):L)}this.hostname=K.join(".")}var M=this.port?":"+this.port:"",N=this.hostname||"";this.host=N+M,this.href+=this.host,p&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),"/"!==d[0]&&(d="/"+d))}if(!x[f])for(var j=0,B=r.length;B>j;j++){var O=r[j],P=encodeURIComponent(O);P===O&&(P=escape(O)),d=d.split(O).join(P)}var Q=d.indexOf("#");-1!==Q&&(this.hash=d.substr(Q),d=d.slice(0,Q));var R=d.indexOf("?");if(-1!==R?(this.search=d.substr(R),this.query=d.substr(R+1),b&&(this.query=A.parse(this.query)),d=d.slice(0,R)):b&&(this.search="",this.query={}),d&&(this.pathname=d),z[f]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){var M=this.pathname||"",L=this.search||"";this.path=M+L}return this.href=this.format(),this},d.prototype.format=function(){var a=this.auth||"";a&&(a=encodeURIComponent(a),a=a.replace(/%3A/i,":"),a+="@");var b=this.protocol||"",c=this.pathname||"",d=this.hash||"",e=!1,f="";this.host?e=a+this.host:this.hostname&&(e=a+(-1===this.hostname.indexOf(":")?this.hostname:"["+this.hostname+"]"),this.port&&(e+=":"+this.port)),this.query&&j(this.query)&&Object.keys(this.query).length&&(f=A.stringify(this.query));var g=this.search||f&&"?"+f||"";return b&&":"!==b.substr(-1)&&(b+=":"),this.slashes||(!b||z[b])&&e!==!1?(e="//"+(e||""),c&&"/"!==c.charAt(0)&&(c="/"+c)):e||(e=""),d&&"#"!==d.charAt(0)&&(d="#"+d),g&&"?"!==g.charAt(0)&&(g="?"+g),c=c.replace(/[?#]/g,function(a){return encodeURIComponent(a)}),g=g.replace("#","%23"),b+e+c+g+d},d.prototype.resolve=function(a){return this.resolveObject(e(a,!1,!0)).format()},d.prototype.resolveObject=function(a){if(i(a)){var b=new d;b.parse(a,!1,!0),a=b}var c=new d;if(Object.keys(this).forEach(function(a){c[a]=this[a]},this),c.hash=a.hash,""===a.href)return c.href=c.format(),c;if(a.slashes&&!a.protocol)return Object.keys(a).forEach(function(b){"protocol"!==b&&(c[b]=a[b])}),z[c.protocol]&&c.hostname&&!c.pathname&&(c.path=c.pathname="/"),c.href=c.format(),c;if(a.protocol&&a.protocol!==c.protocol){if(!z[a.protocol])return Object.keys(a).forEach(function(b){c[b]=a[b]}),c.href=c.format(),c;if(c.protocol=a.protocol,a.host||y[a.protocol])c.pathname=a.pathname;else{for(var e=(a.pathname||"").split("/");e.length&&!(a.host=e.shift()););a.host||(a.host=""),a.hostname||(a.hostname=""),""!==e[0]&&e.unshift(""),e.length<2&&e.unshift(""),c.pathname=e.join("/")}if(c.search=a.search,c.query=a.query,c.host=a.host||"",c.auth=a.auth,c.hostname=a.hostname||a.host,c.port=a.port,c.pathname||c.search){var f=c.pathname||"",g=c.search||"";c.path=f+g}return c.slashes=c.slashes||a.slashes,c.href=c.format(),c}var h=c.pathname&&"/"===c.pathname.charAt(0),j=a.host||a.pathname&&"/"===a.pathname.charAt(0),m=j||h||c.host&&a.pathname,n=m,o=c.pathname&&c.pathname.split("/")||[],e=a.pathname&&a.pathname.split("/")||[],p=c.protocol&&!z[c.protocol];if(p&&(c.hostname="",c.port=null,c.host&&(""===o[0]?o[0]=c.host:o.unshift(c.host)),c.host="",a.protocol&&(a.hostname=null,a.port=null,a.host&&(""===e[0]?e[0]=a.host:e.unshift(a.host)),a.host=null),m=m&&(""===e[0]||""===o[0])),j)c.host=a.host||""===a.host?a.host:c.host,c.hostname=a.hostname||""===a.hostname?a.hostname:c.hostname,c.search=a.search,c.query=a.query,o=e;else if(e.length)o||(o=[]),o.pop(),o=o.concat(e),c.search=a.search,c.query=a.query;else if(!l(a.search)){if(p){c.hostname=c.host=o.shift();var q=c.host&&c.host.indexOf("@")>0?c.host.split("@"):!1;q&&(c.auth=q.shift(),c.host=c.hostname=q.shift())}return c.search=a.search,c.query=a.query,k(c.pathname)&&k(c.search)||(c.path=(c.pathname?c.pathname:"")+(c.search?c.search:"")),c.href=c.format(),c}if(!o.length)return c.pathname=null,c.path=c.search?"/"+c.search:null,c.href=c.format(),c;for(var r=o.slice(-1)[0],s=(c.host||a.host)&&("."===r||".."===r)||""===r,t=0,u=o.length;u>=0;u--)r=o[u],"."==r?o.splice(u,1):".."===r?(o.splice(u,1),t++):t&&(o.splice(u,1),t--);if(!m&&!n)for(;t--;t)o.unshift("..");!m||""===o[0]||o[0]&&"/"===o[0].charAt(0)||o.unshift(""),s&&"/"!==o.join("/").substr(-1)&&o.push("");var v=""===o[0]||o[0]&&"/"===o[0].charAt(0);if(p){c.hostname=c.host=v?"":o.length?o.shift():"";var q=c.host&&c.host.indexOf("@")>0?c.host.split("@"):!1;q&&(c.auth=q.shift(),c.host=c.hostname=q.shift())}return m=m||c.host&&o.length,m&&!v&&o.unshift(""),o.length?c.pathname=o.join("/"):(c.pathname=null,c.path=null),k(c.pathname)&&k(c.search)||(c.path=(c.pathname?c.pathname:"")+(c.search?c.search:"")),c.auth=a.auth||c.auth,c.slashes=c.slashes||a.slashes,c.href=c.format(),c},d.prototype.parseHost=function(){var a=this.host,b=o.exec(a);b&&(b=b[0],":"!==b&&(this.port=b.substr(1)),a=a.substr(0,a.length-b.length)),a&&(this.hostname=a)}},{punycode:52,querystring:55}],71:[function(a,b){b.exports=function(a){return a&&"object"==typeof a&&"function"==typeof a.copy&&"function"==typeof a.fill&&"function"==typeof a.readUInt8}},{}],72:[function(a,b,c){(function(b,d){function e(a,b){var d={seen:[],stylize:g};return arguments.length>=3&&(d.depth=arguments[2]),arguments.length>=4&&(d.colors=arguments[3]),p(b)?d.showHidden=b:b&&c._extend(d,b),v(d.showHidden)&&(d.showHidden=!1),v(d.depth)&&(d.depth=2),v(d.colors)&&(d.colors=!1),v(d.customInspect)&&(d.customInspect=!0),d.colors&&(d.stylize=f),i(d,a,d.depth)}function f(a,b){var c=e.styles[b];return c?"["+e.colors[c][0]+"m"+a+"["+e.colors[c][1]+"m":a}function g(a){return a}function h(a){var b={};return a.forEach(function(a){b[a]=!0}),b}function i(a,b,d){if(a.customInspect&&b&&A(b.inspect)&&b.inspect!==c.inspect&&(!b.constructor||b.constructor.prototype!==b)){var e=b.inspect(d,a);return t(e)||(e=i(a,e,d)),e}var f=j(a,b);if(f)return f;var g=Object.keys(b),p=h(g);if(a.showHidden&&(g=Object.getOwnPropertyNames(b)),z(b)&&(g.indexOf("message")>=0||g.indexOf("description")>=0))return k(b);if(0===g.length){if(A(b)){var q=b.name?": "+b.name:"";return a.stylize("[Function"+q+"]","special")}if(w(b))return a.stylize(RegExp.prototype.toString.call(b),"regexp");if(y(b))return a.stylize(Date.prototype.toString.call(b),"date");if(z(b))return k(b)}var r="",s=!1,u=["{","}"];if(o(b)&&(s=!0,u=["[","]"]),A(b)){var v=b.name?": "+b.name:"";r=" [Function"+v+"]"}if(w(b)&&(r=" "+RegExp.prototype.toString.call(b)),y(b)&&(r=" "+Date.prototype.toUTCString.call(b)),z(b)&&(r=" "+k(b)),0===g.length&&(!s||0==b.length))return u[0]+r+u[1];if(0>d)return w(b)?a.stylize(RegExp.prototype.toString.call(b),"regexp"):a.stylize("[Object]","special");a.seen.push(b);var x;return x=s?l(a,b,d,p,g):g.map(function(c){return m(a,b,d,p,c,s)}),a.seen.pop(),n(x,r,u)}function j(a,b){if(v(b))return a.stylize("undefined","undefined");if(t(b)){var c="'"+JSON.stringify(b).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return a.stylize(c,"string")}return s(b)?a.stylize(""+b,"number"):p(b)?a.stylize(""+b,"boolean"):q(b)?a.stylize("null","null"):void 0}function k(a){return"["+Error.prototype.toString.call(a)+"]"}function l(a,b,c,d,e){for(var f=[],g=0,h=b.length;h>g;++g)f.push(F(b,String(g))?m(a,b,c,d,String(g),!0):"");return e.forEach(function(e){e.match(/^\d+$/)||f.push(m(a,b,c,d,e,!0))}),f}function m(a,b,c,d,e,f){var g,h,j;if(j=Object.getOwnPropertyDescriptor(b,e)||{value:b[e]},j.get?h=j.set?a.stylize("[Getter/Setter]","special"):a.stylize("[Getter]","special"):j.set&&(h=a.stylize("[Setter]","special")),F(d,e)||(g="["+e+"]"),h||(a.seen.indexOf(j.value)<0?(h=q(c)?i(a,j.value,null):i(a,j.value,c-1),h.indexOf("\n")>-1&&(h=f?h.split("\n").map(function(a){return"  "+a}).join("\n").substr(2):"\n"+h.split("\n").map(function(a){return"   "+a}).join("\n"))):h=a.stylize("[Circular]","special")),v(g)){if(f&&e.match(/^\d+$/))return h;g=JSON.stringify(""+e),g.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(g=g.substr(1,g.length-2),g=a.stylize(g,"name")):(g=g.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),g=a.stylize(g,"string"))}return g+": "+h}function n(a,b,c){var d=0,e=a.reduce(function(a,b){return d++,b.indexOf("\n")>=0&&d++,a+b.replace(/\u001b\[\d\d?m/g,"").length+1},0);return e>60?c[0]+(""===b?"":b+"\n ")+" "+a.join(",\n  ")+" "+c[1]:c[0]+b+" "+a.join(", ")+" "+c[1]}function o(a){return Array.isArray(a)}function p(a){return"boolean"==typeof a}function q(a){return null===a}function r(a){return null==a}function s(a){return"number"==typeof a}function t(a){return"string"==typeof a}function u(a){return"symbol"==typeof a}function v(a){return void 0===a}function w(a){return x(a)&&"[object RegExp]"===C(a)}function x(a){return"object"==typeof a&&null!==a}function y(a){return x(a)&&"[object Date]"===C(a)}function z(a){return x(a)&&("[object Error]"===C(a)||a instanceof Error)}function A(a){return"function"==typeof a}function B(a){return null===a||"boolean"==typeof a||"number"==typeof a||"string"==typeof a||"symbol"==typeof a||"undefined"==typeof a}function C(a){return Object.prototype.toString.call(a)}function D(a){return 10>a?"0"+a.toString(10):a.toString(10)}function E(){var a=new Date,b=[D(a.getHours()),D(a.getMinutes()),D(a.getSeconds())].join(":");return[a.getDate(),J[a.getMonth()],b].join(" ")}function F(a,b){return Object.prototype.hasOwnProperty.call(a,b)}var G=/%[sdj%]/g;c.format=function(a){if(!t(a)){for(var b=[],c=0;c<arguments.length;c++)b.push(e(arguments[c]));return b.join(" ")}for(var c=1,d=arguments,f=d.length,g=String(a).replace(G,function(a){if("%%"===a)return"%";if(c>=f)return a;switch(a){case"%s":return String(d[c++]);case"%d":return Number(d[c++]);case"%j":try{return JSON.stringify(d[c++])}catch(b){return"[Circular]"}default:return a}}),h=d[c];f>c;h=d[++c])g+=q(h)||!x(h)?" "+h:" "+e(h);return g},c.deprecate=function(a,e){function f(){if(!g){if(b.throwDeprecation)throw new Error(e);b.traceDeprecation?console.trace(e):console.error(e),g=!0}return a.apply(this,arguments)}if(v(d.process))return function(){return c.deprecate(a,e).apply(this,arguments)};if(b.noDeprecation===!0)return a;var g=!1;return f};var H,I={};c.debuglog=function(a){if(v(H)&&(H=b.env.NODE_DEBUG||""),a=a.toUpperCase(),!I[a])if(new RegExp("\\b"+a+"\\b","i").test(H)){var d=b.pid;I[a]=function(){var b=c.format.apply(c,arguments);console.error("%s %d: %s",a,d,b)}}else I[a]=function(){};return I[a]},c.inspect=e,e.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},e.styles={special:"cyan",number:"yellow","boolean":"yellow",undefined:"grey","null":"bold",string:"green",date:"magenta",regexp:"red"},c.isArray=o,c.isBoolean=p,c.isNull=q,c.isNullOrUndefined=r,c.isNumber=s,c.isString=t,c.isSymbol=u,c.isUndefined=v,c.isRegExp=w,c.isObject=x,c.isDate=y,c.isError=z,c.isFunction=A,c.isPrimitive=B,c.isBuffer=a("./support/isBuffer");var J=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];c.log=function(){console.log("%s - %s",E(),c.format.apply(c,arguments))},c.inherits=a("inherits"),c._extend=function(a,b){if(!b||!x(b))return a;for(var c=Object.keys(b),d=c.length;d--;)a[c[d]]=b[c[d]];return a}}).call(this,a("sycGbZ"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./support/isBuffer":71,inherits:50,sycGbZ:51}]},{},[1]);